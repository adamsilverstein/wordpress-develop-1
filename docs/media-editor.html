<!DOCTYPE html>

<html>
<head>
  <title>media-editor.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page_wrapper">
            <div id="jump_page">
              
                
                <a class="source" href="accordion.html">
                  accordion.js
                </a>
              
                
                <a class="source" href="bookmarklet.html">
                  bookmarklet.js
                </a>
              
                
                <a class="source" href="bookmarklet.min.html">
                  bookmarklet.min.js
                </a>
              
                
                <a class="source" href="color-picker.html">
                  color-picker.js
                </a>
              
                
                <a class="source" href="comment.html">
                  comment.js
                </a>
              
                
                <a class="source" href="common.html">
                  common.js
                </a>
              
                
                <a class="source" href="custom-background.html">
                  custom-background.js
                </a>
              
                
                <a class="source" href="custom-header.html">
                  custom-header.js
                </a>
              
                
                <a class="source" href="customize-controls.html">
                  customize-controls.js
                </a>
              
                
                <a class="source" href="customize-nav-menus.html">
                  customize-nav-menus.js
                </a>
              
                
                <a class="source" href="customize-widgets.html">
                  customize-widgets.js
                </a>
              
                
                <a class="source" href="dashboard.html">
                  dashboard.js
                </a>
              
                
                <a class="source" href="edit-comments.html">
                  edit-comments.js
                </a>
              
                
                <a class="source" href="editor-expand.html">
                  editor-expand.js
                </a>
              
                
                <a class="source" href="editor.html">
                  editor.js
                </a>
              
                
                <a class="source" href="farbtastic.html">
                  farbtastic.js
                </a>
              
                
                <a class="source" href="gallery.html">
                  gallery.js
                </a>
              
                
                <a class="source" href="image-edit.html">
                  image-edit.js
                </a>
              
                
                <a class="source" href="inline-edit-post.html">
                  inline-edit-post.js
                </a>
              
                
                <a class="source" href="inline-edit-tax.html">
                  inline-edit-tax.js
                </a>
              
                
                <a class="source" href="iris.min.html">
                  iris.min.js
                </a>
              
                
                <a class="source" href="language-chooser.html">
                  language-chooser.js
                </a>
              
                
                <a class="source" href="link.html">
                  link.js
                </a>
              
                
                <a class="source" href="media-gallery.html">
                  media-gallery.js
                </a>
              
                
                <a class="source" href="media-upload.html">
                  media-upload.js
                </a>
              
                
                <a class="source" href="media.html">
                  media.js
                </a>
              
                
                <a class="source" href="nav-menu.html">
                  nav-menu.js
                </a>
              
                
                <a class="source" href="password-strength-meter.html">
                  password-strength-meter.js
                </a>
              
                
                <a class="source" href="plugin-install.html">
                  plugin-install.js
                </a>
              
                
                <a class="source" href="post.html">
                  post.js
                </a>
              
                
                <a class="source" href="postbox.html">
                  postbox.js
                </a>
              
                
                <a class="source" href="press-this.html">
                  press-this.js
                </a>
              
                
                <a class="source" href="revisions.html">
                  revisions.js
                </a>
              
                
                <a class="source" href="set-post-thumbnail.html">
                  set-post-thumbnail.js
                </a>
              
                
                <a class="source" href="svg-painter.html">
                  svg-painter.js
                </a>
              
                
                <a class="source" href="tags-box.html">
                  tags-box.js
                </a>
              
                
                <a class="source" href="tags-suggest.html">
                  tags-suggest.js
                </a>
              
                
                <a class="source" href="tags.html">
                  tags.js
                </a>
              
                
                <a class="source" href="theme.html">
                  theme.js
                </a>
              
                
                <a class="source" href="updates.html">
                  updates.js
                </a>
              
                
                <a class="source" href="user-profile.html">
                  user-profile.js
                </a>
              
                
                <a class="source" href="user-suggest.html">
                  user-suggest.js
                </a>
              
                
                <a class="source" href="widgets.html">
                  widgets.js
                </a>
              
                
                <a class="source" href="media-audio-widget.html">
                  media-audio-widget.js
                </a>
              
                
                <a class="source" href="media-image-widget.html">
                  media-image-widget.js
                </a>
              
                
                <a class="source" href="media-video-widget.html">
                  media-video-widget.js
                </a>
              
                
                <a class="source" href="media-widgets.html">
                  media-widgets.js
                </a>
              
                
                <a class="source" href="text-widgets.html">
                  text-widgets.js
                </a>
              
                
                <a class="source" href="word-count.html">
                  word-count.js
                </a>
              
                
                <a class="source" href="wp-fullscreen-stub.html">
                  wp-fullscreen-stub.js
                </a>
              
                
                <a class="source" href="xfn.html">
                  xfn.js
                </a>
              
                
                <a class="source" href="theme-customizer.html">
                  theme-customizer.js
                </a>
              
                
                <a class="source" href="theme-options.html">
                  theme-options.js
                </a>
              
                
                <a class="source" href="html5.html">
                  html5.js
                </a>
              
                
                <a class="source" href="showcase.html">
                  showcase.js
                </a>
              
                
                <a class="source" href="color-scheme-control.html">
                  color-scheme-control.js
                </a>
              
                
                <a class="source" href="customize-preview.html">
                  customize-preview.js
                </a>
              
                
                <a class="source" href="functions.html">
                  functions.js
                </a>
              
                
                <a class="source" href="html5.html">
                  html5.js
                </a>
              
                
                <a class="source" href="keyboard-image-navigation.html">
                  keyboard-image-navigation.js
                </a>
              
                
                <a class="source" href="skip-link-focus-fix.html">
                  skip-link-focus-fix.js
                </a>
              
                
                <a class="source" href="customizer.html">
                  customizer.js
                </a>
              
                
                <a class="source" href="featured-content-admin.html">
                  featured-content-admin.js
                </a>
              
                
                <a class="source" href="functions.html">
                  functions.js
                </a>
              
                
                <a class="source" href="html5.html">
                  html5.js
                </a>
              
                
                <a class="source" href="keyboard-image-navigation.html">
                  keyboard-image-navigation.js
                </a>
              
                
                <a class="source" href="slider.html">
                  slider.js
                </a>
              
                
                <a class="source" href="customize-controls.html">
                  customize-controls.js
                </a>
              
                
                <a class="source" href="customize-preview.html">
                  customize-preview.js
                </a>
              
                
                <a class="source" href="global.html">
                  global.js
                </a>
              
                
                <a class="source" href="html5.html">
                  html5.js
                </a>
              
                
                <a class="source" href="jquery.scrollTo.html">
                  jquery.scrollTo.js
                </a>
              
                
                <a class="source" href="navigation.html">
                  navigation.js
                </a>
              
                
                <a class="source" href="skip-link-focus-fix.html">
                  skip-link-focus-fix.js
                </a>
              
                
                <a class="source" href="functions.html">
                  functions.js
                </a>
              
                
                <a class="source" href="html5.html">
                  html5.js
                </a>
              
                
                <a class="source" href="theme-customizer.html">
                  theme-customizer.js
                </a>
              
                
                <a class="source" href="html5.html">
                  html5.js
                </a>
              
                
                <a class="source" href="navigation.html">
                  navigation.js
                </a>
              
                
                <a class="source" href="theme-customizer.html">
                  theme-customizer.js
                </a>
              
                
                <a class="source" href="admin-bar.html">
                  admin-bar.js
                </a>
              
                
                <a class="source" href="autosave.html">
                  autosave.js
                </a>
              
                
                <a class="source" href="backbone.html">
                  backbone.js
                </a>
              
                
                <a class="source" href="backbone.min.html">
                  backbone.min.js
                </a>
              
                
                <a class="source" href="colorpicker.html">
                  colorpicker.js
                </a>
              
                
                <a class="source" href="comment-reply.html">
                  comment-reply.js
                </a>
              
                
                <a class="source" href="cropper.html">
                  cropper.js
                </a>
              
                
                <a class="source" href="customize-base.html">
                  customize-base.js
                </a>
              
                
                <a class="source" href="customize-loader.html">
                  customize-loader.js
                </a>
              
                
                <a class="source" href="customize-models.html">
                  customize-models.js
                </a>
              
                
                <a class="source" href="customize-preview-nav-menus.html">
                  customize-preview-nav-menus.js
                </a>
              
                
                <a class="source" href="customize-preview-widgets.html">
                  customize-preview-widgets.js
                </a>
              
                
                <a class="source" href="customize-preview.html">
                  customize-preview.js
                </a>
              
                
                <a class="source" href="customize-selective-refresh.html">
                  customize-selective-refresh.js
                </a>
              
                
                <a class="source" href="customize-views.html">
                  customize-views.js
                </a>
              
                
                <a class="source" href="heartbeat.html">
                  heartbeat.js
                </a>
              
                
                <a class="source" href="hoverIntent.html">
                  hoverIntent.js
                </a>
              
                
                <a class="source" href="imagesloaded.min.html">
                  imagesloaded.min.js
                </a>
              
                
                <a class="source" href="jquery.imgareaselect.html">
                  jquery.imgareaselect.js
                </a>
              
                
                <a class="source" href="jquery.imgareaselect.min.html">
                  jquery.imgareaselect.min.js
                </a>
              
                
                <a class="source" href="jquery.Jcrop.min.html">
                  jquery.Jcrop.min.js
                </a>
              
                
                <a class="source" href="jquery-migrate.html">
                  jquery-migrate.js
                </a>
              
                
                <a class="source" href="jquery-migrate.min.html">
                  jquery-migrate.min.js
                </a>
              
                
                <a class="source" href="jquery.color.min.html">
                  jquery.color.min.js
                </a>
              
                
                <a class="source" href="jquery.form.html">
                  jquery.form.js
                </a>
              
                
                <a class="source" href="jquery.form.min.html">
                  jquery.form.min.js
                </a>
              
                
                <a class="source" href="jquery.hotkeys.html">
                  jquery.hotkeys.js
                </a>
              
                
                <a class="source" href="jquery.hotkeys.min.html">
                  jquery.hotkeys.min.js
                </a>
              
                
                <a class="source" href="jquery.html">
                  jquery.js
                </a>
              
                
                <a class="source" href="jquery.masonry.html">
                  jquery.masonry.js
                </a>
              
                
                <a class="source" href="jquery.masonry.min.html">
                  jquery.masonry.min.js
                </a>
              
                
                <a class="source" href="jquery.query.html">
                  jquery.query.js
                </a>
              
                
                <a class="source" href="jquery.schedule.html">
                  jquery.schedule.js
                </a>
              
                
                <a class="source" href="jquery.serialize-object.html">
                  jquery.serialize-object.js
                </a>
              
                
                <a class="source" href="jquery.table-hotkeys.html">
                  jquery.table-hotkeys.js
                </a>
              
                
                <a class="source" href="jquery.table-hotkeys.min.html">
                  jquery.table-hotkeys.min.js
                </a>
              
                
                <a class="source" href="jquery.ui.touch-punch.html">
                  jquery.ui.touch-punch.js
                </a>
              
                
                <a class="source" href="suggest.html">
                  suggest.js
                </a>
              
                
                <a class="source" href="suggest.min.html">
                  suggest.min.js
                </a>
              
                
                <a class="source" href="accordion.html">
                  accordion.js
                </a>
              
                
                <a class="source" href="autocomplete.html">
                  autocomplete.js
                </a>
              
                
                <a class="source" href="button.html">
                  button.js
                </a>
              
                
                <a class="source" href="core.html">
                  core.js
                </a>
              
                
                <a class="source" href="datepicker.html">
                  datepicker.js
                </a>
              
                
                <a class="source" href="dialog.html">
                  dialog.js
                </a>
              
                
                <a class="source" href="draggable.html">
                  draggable.js
                </a>
              
                
                <a class="source" href="droppable.html">
                  droppable.js
                </a>
              
                
                <a class="source" href="effect-blind.html">
                  effect-blind.js
                </a>
              
                
                <a class="source" href="effect-bounce.html">
                  effect-bounce.js
                </a>
              
                
                <a class="source" href="effect-clip.html">
                  effect-clip.js
                </a>
              
                
                <a class="source" href="effect-drop.html">
                  effect-drop.js
                </a>
              
                
                <a class="source" href="effect-explode.html">
                  effect-explode.js
                </a>
              
                
                <a class="source" href="effect-fade.html">
                  effect-fade.js
                </a>
              
                
                <a class="source" href="effect-fold.html">
                  effect-fold.js
                </a>
              
                
                <a class="source" href="effect-highlight.html">
                  effect-highlight.js
                </a>
              
                
                <a class="source" href="effect-puff.html">
                  effect-puff.js
                </a>
              
                
                <a class="source" href="effect-pulsate.html">
                  effect-pulsate.js
                </a>
              
                
                <a class="source" href="effect-scale.html">
                  effect-scale.js
                </a>
              
                
                <a class="source" href="effect-shake.html">
                  effect-shake.js
                </a>
              
                
                <a class="source" href="effect-size.html">
                  effect-size.js
                </a>
              
                
                <a class="source" href="effect-slide.html">
                  effect-slide.js
                </a>
              
                
                <a class="source" href="effect-transfer.html">
                  effect-transfer.js
                </a>
              
                
                <a class="source" href="effect.html">
                  effect.js
                </a>
              
                
                <a class="source" href="menu.html">
                  menu.js
                </a>
              
                
                <a class="source" href="mouse.html">
                  mouse.js
                </a>
              
                
                <a class="source" href="position.html">
                  position.js
                </a>
              
                
                <a class="source" href="progressbar.html">
                  progressbar.js
                </a>
              
                
                <a class="source" href="resizable.html">
                  resizable.js
                </a>
              
                
                <a class="source" href="selectable.html">
                  selectable.js
                </a>
              
                
                <a class="source" href="selectmenu.html">
                  selectmenu.js
                </a>
              
                
                <a class="source" href="slider.html">
                  slider.js
                </a>
              
                
                <a class="source" href="sortable.html">
                  sortable.js
                </a>
              
                
                <a class="source" href="spinner.html">
                  spinner.js
                </a>
              
                
                <a class="source" href="tabs.html">
                  tabs.js
                </a>
              
                
                <a class="source" href="tooltip.html">
                  tooltip.js
                </a>
              
                
                <a class="source" href="widget.html">
                  widget.js
                </a>
              
                
                <a class="source" href="json2.html">
                  json2.js
                </a>
              
                
                <a class="source" href="masonry.min.html">
                  masonry.min.js
                </a>
              
                
                <a class="source" href="mce-view.html">
                  mce-view.js
                </a>
              
                
                <a class="source" href="media-audiovideo.html">
                  media-audiovideo.js
                </a>
              
                
                <a class="source" href="media-editor.html">
                  media-editor.js
                </a>
              
                
                <a class="source" href="media-grid.html">
                  media-grid.js
                </a>
              
                
                <a class="source" href="media-models.html">
                  media-models.js
                </a>
              
                
                <a class="source" href="media-views.html">
                  media-views.js
                </a>
              
                
                <a class="source" href="audiovideo.manifest.html">
                  audiovideo.manifest.js
                </a>
              
                
                <a class="source" href="audio-details.html">
                  audio-details.js
                </a>
              
                
                <a class="source" href="collection-add.html">
                  collection-add.js
                </a>
              
                
                <a class="source" href="collection-edit.html">
                  collection-edit.js
                </a>
              
                
                <a class="source" href="cropper.html">
                  cropper.js
                </a>
              
                
                <a class="source" href="customize-image-cropper.html">
                  customize-image-cropper.js
                </a>
              
                
                <a class="source" href="edit-attachment-metadata.html">
                  edit-attachment-metadata.js
                </a>
              
                
                <a class="source" href="edit-image.html">
                  edit-image.js
                </a>
              
                
                <a class="source" href="embed.html">
                  embed.js
                </a>
              
                
                <a class="source" href="featured-image.html">
                  featured-image.js
                </a>
              
                
                <a class="source" href="gallery-add.html">
                  gallery-add.js
                </a>
              
                
                <a class="source" href="gallery-edit.html">
                  gallery-edit.js
                </a>
              
                
                <a class="source" href="image-details.html">
                  image-details.js
                </a>
              
                
                <a class="source" href="library.html">
                  library.js
                </a>
              
                
                <a class="source" href="media-library.html">
                  media-library.js
                </a>
              
                
                <a class="source" href="region.html">
                  region.js
                </a>
              
                
                <a class="source" href="replace-image.html">
                  replace-image.js
                </a>
              
                
                <a class="source" href="site-icon-cropper.html">
                  site-icon-cropper.js
                </a>
              
                
                <a class="source" href="state-machine.html">
                  state-machine.js
                </a>
              
                
                <a class="source" href="state.html">
                  state.js
                </a>
              
                
                <a class="source" href="video-details.html">
                  video-details.js
                </a>
              
                
                <a class="source" href="grid.manifest.html">
                  grid.manifest.js
                </a>
              
                
                <a class="source" href="models.manifest.html">
                  models.manifest.js
                </a>
              
                
                <a class="source" href="attachment.html">
                  attachment.js
                </a>
              
                
                <a class="source" href="attachments.html">
                  attachments.js
                </a>
              
                
                <a class="source" href="post-image.html">
                  post-image.js
                </a>
              
                
                <a class="source" href="post-media.html">
                  post-media.js
                </a>
              
                
                <a class="source" href="query.html">
                  query.js
                </a>
              
                
                <a class="source" href="selection.html">
                  selection.js
                </a>
              
                
                <a class="source" href="manage.html">
                  manage.js
                </a>
              
                
                <a class="source" href="selection-sync.html">
                  selection-sync.js
                </a>
              
                
                <a class="source" href="views.manifest.html">
                  views.manifest.js
                </a>
              
                
                <a class="source" href="attachment-compat.html">
                  attachment-compat.js
                </a>
              
                
                <a class="source" href="attachment-filters.html">
                  attachment-filters.js
                </a>
              
                
                <a class="source" href="all.html">
                  all.js
                </a>
              
                
                <a class="source" href="date.html">
                  date.js
                </a>
              
                
                <a class="source" href="uploaded.html">
                  uploaded.js
                </a>
              
                
                <a class="source" href="attachment.html">
                  attachment.js
                </a>
              
                
                <a class="source" href="details-two-column.html">
                  details-two-column.js
                </a>
              
                
                <a class="source" href="details.html">
                  details.js
                </a>
              
                
                <a class="source" href="edit-library.html">
                  edit-library.js
                </a>
              
                
                <a class="source" href="edit-selection.html">
                  edit-selection.js
                </a>
              
                
                <a class="source" href="library.html">
                  library.js
                </a>
              
                
                <a class="source" href="selection.html">
                  selection.js
                </a>
              
                
                <a class="source" href="attachments.html">
                  attachments.js
                </a>
              
                
                <a class="source" href="browser.html">
                  browser.js
                </a>
              
                
                <a class="source" href="selection.html">
                  selection.js
                </a>
              
                
                <a class="source" href="audio-details.html">
                  audio-details.js
                </a>
              
                
                <a class="source" href="button-group.html">
                  button-group.js
                </a>
              
                
                <a class="source" href="button.html">
                  button.js
                </a>
              
                
                <a class="source" href="delete-selected-permanently.html">
                  delete-selected-permanently.js
                </a>
              
                
                <a class="source" href="delete-selected.html">
                  delete-selected.js
                </a>
              
                
                <a class="source" href="select-mode-toggle.html">
                  select-mode-toggle.js
                </a>
              
                
                <a class="source" href="cropper.html">
                  cropper.js
                </a>
              
                
                <a class="source" href="edit-image-details.html">
                  edit-image-details.js
                </a>
              
                
                <a class="source" href="edit-image.html">
                  edit-image.js
                </a>
              
                
                <a class="source" href="embed.html">
                  embed.js
                </a>
              
                
                <a class="source" href="image.html">
                  image.js
                </a>
              
                
                <a class="source" href="link.html">
                  link.js
                </a>
              
                
                <a class="source" href="url.html">
                  url.js
                </a>
              
                
                <a class="source" href="focus-manager.html">
                  focus-manager.js
                </a>
              
                
                <a class="source" href="frame.html">
                  frame.js
                </a>
              
                
                <a class="source" href="audio-details.html">
                  audio-details.js
                </a>
              
                
                <a class="source" href="edit-attachments.html">
                  edit-attachments.js
                </a>
              
                
                <a class="source" href="image-details.html">
                  image-details.js
                </a>
              
                
                <a class="source" href="manage.html">
                  manage.js
                </a>
              
                
                <a class="source" href="media-details.html">
                  media-details.js
                </a>
              
                
                <a class="source" href="post.html">
                  post.js
                </a>
              
                
                <a class="source" href="select.html">
                  select.js
                </a>
              
                
                <a class="source" href="video-details.html">
                  video-details.js
                </a>
              
                
                <a class="source" href="iframe.html">
                  iframe.js
                </a>
              
                
                <a class="source" href="image-details.html">
                  image-details.js
                </a>
              
                
                <a class="source" href="label.html">
                  label.js
                </a>
              
                
                <a class="source" href="media-details.html">
                  media-details.js
                </a>
              
                
                <a class="source" href="media-frame.html">
                  media-frame.js
                </a>
              
                
                <a class="source" href="menu-item.html">
                  menu-item.js
                </a>
              
                
                <a class="source" href="menu.html">
                  menu.js
                </a>
              
                
                <a class="source" href="modal.html">
                  modal.js
                </a>
              
                
                <a class="source" href="priority-list.html">
                  priority-list.js
                </a>
              
                
                <a class="source" href="router-item.html">
                  router-item.js
                </a>
              
                
                <a class="source" href="router.html">
                  router.js
                </a>
              
                
                <a class="source" href="search.html">
                  search.js
                </a>
              
                
                <a class="source" href="selection.html">
                  selection.js
                </a>
              
                
                <a class="source" href="settings.html">
                  settings.js
                </a>
              
                
                <a class="source" href="attachment-display.html">
                  attachment-display.js
                </a>
              
                
                <a class="source" href="gallery.html">
                  gallery.js
                </a>
              
                
                <a class="source" href="playlist.html">
                  playlist.js
                </a>
              
                
                <a class="source" href="sidebar.html">
                  sidebar.js
                </a>
              
                
                <a class="source" href="site-icon-cropper.html">
                  site-icon-cropper.js
                </a>
              
                
                <a class="source" href="site-icon-preview.html">
                  site-icon-preview.js
                </a>
              
                
                <a class="source" href="spinner.html">
                  spinner.js
                </a>
              
                
                <a class="source" href="toolbar.html">
                  toolbar.js
                </a>
              
                
                <a class="source" href="embed.html">
                  embed.js
                </a>
              
                
                <a class="source" href="select.html">
                  select.js
                </a>
              
                
                <a class="source" href="editor.html">
                  editor.js
                </a>
              
                
                <a class="source" href="inline.html">
                  inline.js
                </a>
              
                
                <a class="source" href="status-error.html">
                  status-error.js
                </a>
              
                
                <a class="source" href="status.html">
                  status.js
                </a>
              
                
                <a class="source" href="window.html">
                  window.js
                </a>
              
                
                <a class="source" href="video-details.html">
                  video-details.js
                </a>
              
                
                <a class="source" href="view.html">
                  view.js
                </a>
              
                
                <a class="source" href="froogaloop.min.html">
                  froogaloop.min.js
                </a>
              
                
                <a class="source" href="mediaelement-and-player.min.html">
                  mediaelement-and-player.min.js
                </a>
              
                
                <a class="source" href="wp-mediaelement.html">
                  wp-mediaelement.js
                </a>
              
                
                <a class="source" href="wp-playlist.html">
                  wp-playlist.js
                </a>
              
                
                <a class="source" href="handlers.html">
                  handlers.js
                </a>
              
                
                <a class="source" href="plupload.full.min.html">
                  plupload.full.min.js
                </a>
              
                
                <a class="source" href="wp-plupload.html">
                  wp-plupload.js
                </a>
              
                
                <a class="source" href="quicktags.html">
                  quicktags.js
                </a>
              
                
                <a class="source" href="shortcode.html">
                  shortcode.js
                </a>
              
                
                <a class="source" href="swfobject.html">
                  swfobject.js
                </a>
              
                
                <a class="source" href="handlers.html">
                  handlers.js
                </a>
              
                
                <a class="source" href="handlers.min.html">
                  handlers.min.js
                </a>
              
                
                <a class="source" href="swfupload.cookies.html">
                  swfupload.cookies.js
                </a>
              
                
                <a class="source" href="swfupload.queue.html">
                  swfupload.queue.js
                </a>
              
                
                <a class="source" href="swfupload.speed.html">
                  swfupload.speed.js
                </a>
              
                
                <a class="source" href="swfupload.swfobject.html">
                  swfupload.swfobject.js
                </a>
              
                
                <a class="source" href="swfupload.html">
                  swfupload.js
                </a>
              
                
                <a class="source" href="thickbox.html">
                  thickbox.js
                </a>
              
                
                <a class="source" href="wp-langs-en.html">
                  wp-langs-en.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="theme.html">
                  theme.js
                </a>
              
                
                <a class="source" href="theme.min.html">
                  theme.min.js
                </a>
              
                
                <a class="source" href="theme.html">
                  theme.js
                </a>
              
                
                <a class="source" href="theme.min.html">
                  theme.min.js
                </a>
              
                
                <a class="source" href="tiny_mce_popup.html">
                  tiny_mce_popup.js
                </a>
              
                
                <a class="source" href="tinymce.html">
                  tinymce.js
                </a>
              
                
                <a class="source" href="tinymce.min.html">
                  tinymce.min.js
                </a>
              
                
                <a class="source" href="editable_selects.html">
                  editable_selects.js
                </a>
              
                
                <a class="source" href="form_utils.html">
                  form_utils.js
                </a>
              
                
                <a class="source" href="mctabs.html">
                  mctabs.js
                </a>
              
                
                <a class="source" href="validate.html">
                  validate.js
                </a>
              
                
                <a class="source" href="tw-sack.html">
                  tw-sack.js
                </a>
              
                
                <a class="source" href="twemoji.html">
                  twemoji.js
                </a>
              
                
                <a class="source" href="underscore.html">
                  underscore.js
                </a>
              
                
                <a class="source" href="underscore.min.html">
                  underscore.min.js
                </a>
              
                
                <a class="source" href="utils.html">
                  utils.js
                </a>
              
                
                <a class="source" href="wp-a11y.html">
                  wp-a11y.js
                </a>
              
                
                <a class="source" href="wp-ajax-response.html">
                  wp-ajax-response.js
                </a>
              
                
                <a class="source" href="wp-api.html">
                  wp-api.js
                </a>
              
                
                <a class="source" href="wp-auth-check.html">
                  wp-auth-check.js
                </a>
              
                
                <a class="source" href="wp-backbone.html">
                  wp-backbone.js
                </a>
              
                
                <a class="source" href="wp-custom-header.html">
                  wp-custom-header.js
                </a>
              
                
                <a class="source" href="wp-embed-template.html">
                  wp-embed-template.js
                </a>
              
                
                <a class="source" href="wp-embed.html">
                  wp-embed.js
                </a>
              
                
                <a class="source" href="wp-emoji-loader.html">
                  wp-emoji-loader.js
                </a>
              
                
                <a class="source" href="wp-emoji.html">
                  wp-emoji.js
                </a>
              
                
                <a class="source" href="wp-list-revisions.html">
                  wp-list-revisions.js
                </a>
              
                
                <a class="source" href="wp-lists.html">
                  wp-lists.js
                </a>
              
                
                <a class="source" href="wp-pointer.html">
                  wp-pointer.js
                </a>
              
                
                <a class="source" href="wp-util.html">
                  wp-util.js
                </a>
              
                
                <a class="source" href="wpdialog.html">
                  wpdialog.js
                </a>
              
                
                <a class="source" href="wplink.html">
                  wplink.js
                </a>
              
                
                <a class="source" href="zxcvbn-async.html">
                  zxcvbn-async.js
                </a>
              
                
                <a class="source" href="zxcvbn.min.html">
                  zxcvbn.min.js
                </a>
              
            </div>
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>media-editor.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-comment">/* global getUserSetting, tinymce, QTags */</span></pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <h2 id="wordpress-tinymce-and-media">WordPress, TinyMCE, and Media</h2>

            </div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$, _</span>)</span>{
	<span class="hljs-comment">/**
	 * Stores the editors' `wp.media.controller.Frame` instances.
	 *
	 * @static
	 */</span>
	<span class="hljs-keyword">var</span> workflows = {};

	<span class="hljs-comment">/**
	 * A helper mixin function to avoid truthy and falsey values being
	 *   passed as an input that expects booleans. If key is undefined in the map,
	 *   but has a default value, set it.
	 *
	 * @param {object} attrs Map of props from a shortcode or settings.
	 * @param {string} key The key within the passed map to check for a value.
	 * @returns {mixed|undefined} The original or coerced value of key within attrs
	 */</span>
	wp.media.coerce = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"> attrs, key </span>) </span>{
		<span class="hljs-keyword">if</span> ( _.isUndefined( attrs[ key ] ) &amp;&amp; ! _.isUndefined( <span class="hljs-keyword">this</span>.defaults[ key ] ) ) {
			attrs[ key ] = <span class="hljs-keyword">this</span>.defaults[ key ];
		} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( <span class="hljs-string">'true'</span> === attrs[ key ] ) {
			attrs[ key ] = <span class="hljs-literal">true</span>;
		} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( <span class="hljs-string">'false'</span> === attrs[ key ] ) {
			attrs[ key ] = <span class="hljs-literal">false</span>;
		}
		<span class="hljs-keyword">return</span> attrs[ key ];
	};

	<span class="hljs-comment">/**
	 * wp.media.string
	 * @namespace
	 */</span>
	wp.media.string = {
		<span class="hljs-comment">/**
		 * Joins the `props` and `attachment` objects,
		 * outputting the proper object format based on the
		 * attachment's type.
		 *
		 * @global wp.media.view.settings
		 * @global getUserSetting()
		 *
		 * @param {Object} [props={}] Attachment details (align, link, size, etc).
		 * @param {Object} attachment The attachment object, media version of Post.
		 * @returns {Object} Joined props
		 */</span>
		props: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> props, attachment </span>) </span>{
			<span class="hljs-keyword">var</span> link, linkUrl, size, sizes,
				defaultProps = wp.media.view.settings.defaultProps;

			props = props ? _.clone( props ) : {};

			<span class="hljs-keyword">if</span> ( attachment &amp;&amp; attachment.type ) {
				props.type = attachment.type;
			}

			<span class="hljs-keyword">if</span> ( <span class="hljs-string">'image'</span> === props.type ) {
				props = _.defaults( props || {}, {
					<span class="hljs-attr">align</span>:   defaultProps.align || getUserSetting( <span class="hljs-string">'align'</span>, <span class="hljs-string">'none'</span> ),
					<span class="hljs-attr">size</span>:    defaultProps.size  || getUserSetting( <span class="hljs-string">'imgsize'</span>, <span class="hljs-string">'medium'</span> ),
					<span class="hljs-attr">url</span>:     <span class="hljs-string">''</span>,
					<span class="hljs-attr">classes</span>: []
				});
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>All attachment-specific settings follow.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( ! attachment ) {
				<span class="hljs-keyword">return</span> props;
			}

			props.title = props.title || attachment.title;

			link = props.link || defaultProps.link || getUserSetting( <span class="hljs-string">'urlbutton'</span>, <span class="hljs-string">'file'</span> );
			<span class="hljs-keyword">if</span> ( <span class="hljs-string">'file'</span> === link || <span class="hljs-string">'embed'</span> === link ) {
				linkUrl = attachment.url;
			} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( <span class="hljs-string">'post'</span> === link ) {
				linkUrl = attachment.link;
			} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( <span class="hljs-string">'custom'</span> === link ) {
				linkUrl = props.linkUrl;
			}
			props.linkUrl = linkUrl || <span class="hljs-string">''</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>Format properties for images.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( <span class="hljs-string">'image'</span> === attachment.type ) {
				props.classes.push( <span class="hljs-string">'wp-image-'</span> + attachment.id );

				sizes = attachment.sizes;
				size = sizes &amp;&amp; sizes[ props.size ] ? sizes[ props.size ] : attachment;

				_.extend( props, _.pick( attachment, <span class="hljs-string">'align'</span>, <span class="hljs-string">'caption'</span>, <span class="hljs-string">'alt'</span> ), {
					<span class="hljs-attr">width</span>:     size.width,
					<span class="hljs-attr">height</span>:    size.height,
					<span class="hljs-attr">src</span>:       size.url,
					<span class="hljs-attr">captionId</span>: <span class="hljs-string">'attachment_'</span> + attachment.id
				});
			} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( <span class="hljs-string">'video'</span> === attachment.type || <span class="hljs-string">'audio'</span> === attachment.type ) {
				_.extend( props, _.pick( attachment, <span class="hljs-string">'title'</span>, <span class="hljs-string">'type'</span>, <span class="hljs-string">'icon'</span>, <span class="hljs-string">'mime'</span> ) );</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>Format properties for non-images.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			} <span class="hljs-keyword">else</span> {
				props.title = props.title || attachment.filename;
				props.rel = props.rel || <span class="hljs-string">'attachment wp-att-'</span> + attachment.id;
			}

			<span class="hljs-keyword">return</span> props;
		},
		<span class="hljs-comment">/**
		 * Create link markup that is suitable for passing to the editor
		 *
		 * @global wp.html.string
		 *
		 * @param {Object} props Attachment details (align, link, size, etc).
		 * @param {Object} attachment The attachment object, media version of Post.
		 * @returns {string} The link markup
		 */</span>
		link: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> props, attachment </span>) </span>{
			<span class="hljs-keyword">var</span> options;

			props = wp.media.string.props( props, attachment );

			options = {
				<span class="hljs-attr">tag</span>:     <span class="hljs-string">'a'</span>,
				<span class="hljs-attr">content</span>: props.title,
				<span class="hljs-attr">attrs</span>:   {
					<span class="hljs-attr">href</span>: props.linkUrl
				}
			};

			<span class="hljs-keyword">if</span> ( props.rel ) {
				options.attrs.rel = props.rel;
			}

			<span class="hljs-keyword">return</span> wp.html.string( options );
		},
		<span class="hljs-comment">/**
		 * Create an Audio shortcode string that is suitable for passing to the editor
		 *
		 * @param {Object} props Attachment details (align, link, size, etc).
		 * @param {Object} attachment The attachment object, media version of Post.
		 * @returns {string} The audio shortcode
		 */</span>
		audio: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> props, attachment </span>) </span>{
			<span class="hljs-keyword">return</span> wp.media.string._audioVideo( <span class="hljs-string">'audio'</span>, props, attachment );
		},
		<span class="hljs-comment">/**
		 * Create a Video shortcode string that is suitable for passing to the editor
		 *
		 * @param {Object} props Attachment details (align, link, size, etc).
		 * @param {Object} attachment The attachment object, media version of Post.
		 * @returns {string} The video shortcode
		 */</span>
		video: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> props, attachment </span>) </span>{
			<span class="hljs-keyword">return</span> wp.media.string._audioVideo( <span class="hljs-string">'video'</span>, props, attachment );
		},
		<span class="hljs-comment">/**
		 * Helper function to create a media shortcode string
		 *
		 * @access private
		 *
		 * @global wp.shortcode
		 * @global wp.media.view.settings
		 *
		 * @param {string} type The shortcode tag name: 'audio' or 'video'.
		 * @param {Object} props Attachment details (align, link, size, etc).
		 * @param {Object} attachment The attachment object, media version of Post.
		 * @returns {string} The media shortcode
		 */</span>
		_audioVideo: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> type, props, attachment </span>) </span>{
			<span class="hljs-keyword">var</span> shortcode, html, extension;

			props = wp.media.string.props( props, attachment );
			<span class="hljs-keyword">if</span> ( props.link !== <span class="hljs-string">'embed'</span> )
				<span class="hljs-keyword">return</span> wp.media.string.link( props );

			shortcode = {};

			<span class="hljs-keyword">if</span> ( <span class="hljs-string">'video'</span> === type ) {
				<span class="hljs-keyword">if</span> ( attachment.image &amp;&amp; <span class="hljs-number">-1</span> === attachment.image.src.indexOf( attachment.icon ) ) {
					shortcode.poster = attachment.image.src;
				}

				<span class="hljs-keyword">if</span> ( attachment.width ) {
					shortcode.width = attachment.width;
				}

				<span class="hljs-keyword">if</span> ( attachment.height ) {
					shortcode.height = attachment.height;
				}
			}

			extension = attachment.filename.split(<span class="hljs-string">'.'</span>).pop();

			<span class="hljs-keyword">if</span> ( _.contains( wp.media.view.settings.embedExts, extension ) ) {
				shortcode[extension] = attachment.url;
			} <span class="hljs-keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>Render unsupported audio and video files as links.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">return</span> wp.media.string.link( props );
			}

			html = wp.shortcode.string({
				<span class="hljs-attr">tag</span>:     type,
				<span class="hljs-attr">attrs</span>:   shortcode
			});

			<span class="hljs-keyword">return</span> html;
		},
		<span class="hljs-comment">/**
		 * Create image markup, optionally with a link and/or wrapped in a caption shortcode,
		 *  that is suitable for passing to the editor
		 *
		 * @global wp.html
		 * @global wp.shortcode
		 *
		 * @param {Object} props Attachment details (align, link, size, etc).
		 * @param {Object} attachment The attachment object, media version of Post.
		 * @returns {string}
		 */</span>
		image: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> props, attachment </span>) </span>{
			<span class="hljs-keyword">var</span> img = {},
				options, classes, shortcode, html;

			props.type = <span class="hljs-string">'image'</span>;
			props = wp.media.string.props( props, attachment );
			classes = props.classes || [];

			img.src = ! _.isUndefined( attachment ) ? attachment.url : props.url;
			_.extend( img, _.pick( props, <span class="hljs-string">'width'</span>, <span class="hljs-string">'height'</span>, <span class="hljs-string">'alt'</span> ) );</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>Only assign the align class to the image if were not printing
a caption, since the alignment is sent to the shortcode.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( props.align &amp;&amp; ! props.caption ) {
				classes.push( <span class="hljs-string">'align'</span> + props.align );
			}

			<span class="hljs-keyword">if</span> ( props.size ) {
				classes.push( <span class="hljs-string">'size-'</span> + props.size );
			}

			img[<span class="hljs-string">'class'</span>] = _.compact( classes ).join(<span class="hljs-string">' '</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>Generate <code>img</code> tag options.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			options = {
				<span class="hljs-attr">tag</span>:    <span class="hljs-string">'img'</span>,
				<span class="hljs-attr">attrs</span>:  img,
				<span class="hljs-attr">single</span>: <span class="hljs-literal">true</span>
			};</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>Generate the <code>a</code> element options, if they exist.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( props.linkUrl ) {
				options = {
					<span class="hljs-attr">tag</span>:   <span class="hljs-string">'a'</span>,
					<span class="hljs-attr">attrs</span>: {
						<span class="hljs-attr">href</span>: props.linkUrl
					},
					<span class="hljs-attr">content</span>: options
				};
			}

			html = wp.html.string( options );</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>Generate the caption shortcode.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( props.caption ) {
				shortcode = {};

				<span class="hljs-keyword">if</span> ( img.width ) {
					shortcode.width = img.width;
				}

				<span class="hljs-keyword">if</span> ( props.captionId ) {
					shortcode.id = props.captionId;
				}

				<span class="hljs-keyword">if</span> ( props.align ) {
					shortcode.align = <span class="hljs-string">'align'</span> + props.align;
				}

				html = wp.shortcode.string({
					<span class="hljs-attr">tag</span>:     <span class="hljs-string">'caption'</span>,
					<span class="hljs-attr">attrs</span>:   shortcode,
					<span class="hljs-attr">content</span>: html + <span class="hljs-string">' '</span> + props.caption
				});
			}

			<span class="hljs-keyword">return</span> html;
		}
	};

	wp.media.embed = {
		<span class="hljs-attr">coerce</span> : wp.media.coerce,

		<span class="hljs-attr">defaults</span> : {
			<span class="hljs-attr">url</span> : <span class="hljs-string">''</span>,
			<span class="hljs-attr">width</span>: <span class="hljs-string">''</span>,
			<span class="hljs-attr">height</span>: <span class="hljs-string">''</span>
		},

		<span class="hljs-attr">edit</span> : <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> data, isURL </span>) </span>{
			<span class="hljs-keyword">var</span> frame, props = {}, shortcode;

			<span class="hljs-keyword">if</span> ( isURL ) {
				props.url = data.replace(<span class="hljs-regexp">/&lt;[^&gt;]+&gt;/g</span>, <span class="hljs-string">''</span>);
			} <span class="hljs-keyword">else</span> {
				shortcode = wp.shortcode.next( <span class="hljs-string">'embed'</span>, data ).shortcode;

				props = _.defaults( shortcode.attrs.named, <span class="hljs-keyword">this</span>.defaults );
				<span class="hljs-keyword">if</span> ( shortcode.content ) {
					props.url = shortcode.content;
				}
			}

			frame = wp.media({
				<span class="hljs-attr">frame</span>: <span class="hljs-string">'post'</span>,
				<span class="hljs-attr">state</span>: <span class="hljs-string">'embed'</span>,
				<span class="hljs-attr">metadata</span>: props
			});

			<span class="hljs-keyword">return</span> frame;
		},

		<span class="hljs-attr">shortcode</span> : <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> model </span>) </span>{
			<span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>, content;

			_.each( <span class="hljs-keyword">this</span>.defaults, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> value, key </span>) </span>{
				model[ key ] = self.coerce( model, key );

				<span class="hljs-keyword">if</span> ( value === model[ key ] ) {
					<span class="hljs-keyword">delete</span> model[ key ];
				}
			});

			content = model.url;
			<span class="hljs-keyword">delete</span> model.url;

			<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> wp.shortcode({
				<span class="hljs-attr">tag</span>: <span class="hljs-string">'embed'</span>,
				<span class="hljs-attr">attrs</span>: model,
				<span class="hljs-attr">content</span>: content
			});
		}
	};

	wp.media.collection = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">attributes</span>) </span>{
		<span class="hljs-keyword">var</span> collections = {};

		<span class="hljs-keyword">return</span> _.extend( {
			<span class="hljs-attr">coerce</span> : wp.media.coerce,
			<span class="hljs-comment">/**
			 * Retrieve attachments based on the properties of the passed shortcode
			 *
			 * @global wp.media.query
			 *
			 * @param {wp.shortcode} shortcode An instance of wp.shortcode().
			 * @returns {wp.media.model.Attachments} A Backbone.Collection containing
			 *      the media items belonging to a collection.
			 *      The query[ this.tag ] property is a Backbone.Model
			 *          containing the 'props' for the collection.
			 */</span>
			attachments: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> shortcode </span>) </span>{
				<span class="hljs-keyword">var</span> shortcodeString = shortcode.string(),
					result = collections[ shortcodeString ],
					attrs, args, query, others, self = <span class="hljs-keyword">this</span>;

				<span class="hljs-keyword">delete</span> collections[ shortcodeString ];
				<span class="hljs-keyword">if</span> ( result ) {
					<span class="hljs-keyword">return</span> result;
				}</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>Fill the default shortcode attributes.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				attrs = _.defaults( shortcode.attrs.named, <span class="hljs-keyword">this</span>.defaults );
				args  = _.pick( attrs, <span class="hljs-string">'orderby'</span>, <span class="hljs-string">'order'</span> );

				args.type    = <span class="hljs-keyword">this</span>.type;
				args.perPage = <span class="hljs-number">-1</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p>Mark the <code>orderby</code> override attribute.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( <span class="hljs-literal">undefined</span> !== attrs.orderby ) {
					attrs._orderByField = attrs.orderby;
				}

				<span class="hljs-keyword">if</span> ( <span class="hljs-string">'rand'</span> === attrs.orderby ) {
					attrs._orderbyRandom = <span class="hljs-literal">true</span>;
				}</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p>Map the <code>orderby</code> attribute to the corresponding model property.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( ! attrs.orderby || <span class="hljs-regexp">/^menu_order(?: ID)?$/i</span>.test( attrs.orderby ) ) {
					args.orderby = <span class="hljs-string">'menuOrder'</span>;
				}</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <p>Map the <code>ids</code> param to the correct query args.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( attrs.ids ) {
					args.post__in = attrs.ids.split(<span class="hljs-string">','</span>);
					args.orderby  = <span class="hljs-string">'post__in'</span>;
				} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( attrs.include ) {
					args.post__in = attrs.include.split(<span class="hljs-string">','</span>);
				}

				<span class="hljs-keyword">if</span> ( attrs.exclude ) {
					args.post__not_in = attrs.exclude.split(<span class="hljs-string">','</span>);
				}

				<span class="hljs-keyword">if</span> ( ! args.post__in ) {
					args.uploadedTo = attrs.id;
				}</pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <p>Collect the attributes that were not included in <code>args</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				others = _.omit( attrs, <span class="hljs-string">'id'</span>, <span class="hljs-string">'ids'</span>, <span class="hljs-string">'include'</span>, <span class="hljs-string">'exclude'</span>, <span class="hljs-string">'orderby'</span>, <span class="hljs-string">'order'</span> );

				_.each( <span class="hljs-keyword">this</span>.defaults, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> value, key </span>) </span>{
					others[ key ] = self.coerce( others, key );
				});

				query = wp.media.query( args );
				query[ <span class="hljs-keyword">this</span>.tag ] = <span class="hljs-keyword">new</span> Backbone.Model( others );
				<span class="hljs-keyword">return</span> query;
			},
			<span class="hljs-comment">/**
			 * Triggered when clicking 'Insert {label}' or 'Update {label}'
			 *
			 * @global wp.shortcode
			 * @global wp.media.model.Attachments
			 *
			 * @param {wp.media.model.Attachments} attachments A Backbone.Collection containing
			 *      the media items belonging to a collection.
			 *      The query[ this.tag ] property is a Backbone.Model
			 *          containing the 'props' for the collection.
			 * @returns {wp.shortcode}
			 */</span>
			shortcode: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> attachments </span>) </span>{
				<span class="hljs-keyword">var</span> props = attachments.props.toJSON(),
					attrs = _.pick( props, <span class="hljs-string">'orderby'</span>, <span class="hljs-string">'order'</span> ),
					shortcode, clone;

				<span class="hljs-keyword">if</span> ( attachments.type ) {
					attrs.type = attachments.type;
					<span class="hljs-keyword">delete</span> attachments.type;
				}

				<span class="hljs-keyword">if</span> ( attachments[<span class="hljs-keyword">this</span>.tag] ) {
					_.extend( attrs, attachments[<span class="hljs-keyword">this</span>.tag].toJSON() );
				}</pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <p>Convert all gallery shortcodes to use the <code>ids</code> property.
Ignore <code>post__in</code> and <code>post__not_in</code>; the attachments in
the collection will already reflect those properties.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				attrs.ids = attachments.pluck(<span class="hljs-string">'id'</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <p>Copy the <code>uploadedTo</code> post ID.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( props.uploadedTo ) {
					attrs.id = props.uploadedTo;
				}</pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p>Check if the gallery is randomly ordered.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">delete</span> attrs.orderby;

				<span class="hljs-keyword">if</span> ( attrs._orderbyRandom ) {
					attrs.orderby = <span class="hljs-string">'rand'</span>;
				} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( attrs._orderByField &amp;&amp; attrs._orderByField != <span class="hljs-string">'rand'</span> ) {
					attrs.orderby = attrs._orderByField;
				}

				<span class="hljs-keyword">delete</span> attrs._orderbyRandom;
				<span class="hljs-keyword">delete</span> attrs._orderByField;</pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <p>If the <code>ids</code> attribute is set and <code>orderby</code> attribute
is the default value, clear it for cleaner output.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( attrs.ids &amp;&amp; <span class="hljs-string">'post__in'</span> === attrs.orderby ) {
					<span class="hljs-keyword">delete</span> attrs.orderby;
				}

				attrs = <span class="hljs-keyword">this</span>.setDefaults( attrs );

				shortcode = <span class="hljs-keyword">new</span> wp.shortcode({
					<span class="hljs-attr">tag</span>:    <span class="hljs-keyword">this</span>.tag,
					<span class="hljs-attr">attrs</span>:  attrs,
					<span class="hljs-attr">type</span>:   <span class="hljs-string">'single'</span>
				});</pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <p>Use a cloned version of the gallery.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				clone = <span class="hljs-keyword">new</span> wp.media.model.Attachments( attachments.models, {
					<span class="hljs-attr">props</span>: props
				});
				clone[ <span class="hljs-keyword">this</span>.tag ] = attachments[ <span class="hljs-keyword">this</span>.tag ];
				collections[ shortcode.string() ] = clone;

				<span class="hljs-keyword">return</span> shortcode;
			},
			<span class="hljs-comment">/**
			 * Triggered when double-clicking a collection shortcode placeholder
			 *   in the editor
			 *
			 * @global wp.shortcode
			 * @global wp.media.model.Selection
			 * @global wp.media.view.l10n
			 *
			 * @param {string} content Content that is searched for possible
			 *    shortcode markup matching the passed tag name,
			 *
			 * @this wp.media.{prop}
			 *
			 * @returns {wp.media.view.MediaFrame.Select} A media workflow.
			 */</span>
			edit: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> content </span>) </span>{
				<span class="hljs-keyword">var</span> shortcode = wp.shortcode.next( <span class="hljs-keyword">this</span>.tag, content ),
					defaultPostId = <span class="hljs-keyword">this</span>.defaults.id,
					attachments, selection, state;</pre></div></div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <p>Bail if we didnt match the shortcode or all of the content.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( ! shortcode || shortcode.content !== content ) {
					<span class="hljs-keyword">return</span>;
				}</pre></div></div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <p>Ignore the rest of the match object.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				shortcode = shortcode.shortcode;

				<span class="hljs-keyword">if</span> ( _.isUndefined( shortcode.get(<span class="hljs-string">'id'</span>) ) &amp;&amp; ! _.isUndefined( defaultPostId ) ) {
					shortcode.set( <span class="hljs-string">'id'</span>, defaultPostId );
				}

				attachments = <span class="hljs-keyword">this</span>.attachments( shortcode );

				selection = <span class="hljs-keyword">new</span> wp.media.model.Selection( attachments.models, {
					<span class="hljs-attr">props</span>:    attachments.props.toJSON(),
					<span class="hljs-attr">multiple</span>: <span class="hljs-literal">true</span>
				});

				selection[ <span class="hljs-keyword">this</span>.tag ] = attachments[ <span class="hljs-keyword">this</span>.tag ];</pre></div></div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <p>Fetch the querys attachments, and then break ties from the
query to allow for sorting.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				selection.more().done( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-25">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-25">&#182;</a>
              </div>
              <p>Break ties with the query.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					selection.props.set({ <span class="hljs-attr">query</span>: <span class="hljs-literal">false</span> });
					selection.unmirror();
					selection.props.unset(<span class="hljs-string">'orderby'</span>);
				});</pre></div></div>
            
        </li>
        
        
        <li id="section-26">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-26">&#182;</a>
              </div>
              <p>Destroy the previous gallery frame.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.frame ) {
					<span class="hljs-keyword">this</span>.frame.dispose();
				}

				<span class="hljs-keyword">if</span> ( shortcode.attrs.named.type &amp;&amp; <span class="hljs-string">'video'</span> === shortcode.attrs.named.type ) {
					state = <span class="hljs-string">'video-'</span> + <span class="hljs-keyword">this</span>.tag + <span class="hljs-string">'-edit'</span>;
				} <span class="hljs-keyword">else</span> {
					state = <span class="hljs-keyword">this</span>.tag + <span class="hljs-string">'-edit'</span>;
				}</pre></div></div>
            
        </li>
        
        
        <li id="section-27">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-27">&#182;</a>
              </div>
              <p>Store the current frame.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">this</span>.frame = wp.media({
					<span class="hljs-attr">frame</span>:     <span class="hljs-string">'post'</span>,
					<span class="hljs-attr">state</span>:     state,
					<span class="hljs-attr">title</span>:     <span class="hljs-keyword">this</span>.editTitle,
					<span class="hljs-attr">editing</span>:   <span class="hljs-literal">true</span>,
					<span class="hljs-attr">multiple</span>:  <span class="hljs-literal">true</span>,
					<span class="hljs-attr">selection</span>: selection
				}).open();

				<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.frame;
			},

			<span class="hljs-attr">setDefaults</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> attrs </span>) </span>{
				<span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-28">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-28">&#182;</a>
              </div>
              <p>Remove default attributes from the shortcode.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				_.each( <span class="hljs-keyword">this</span>.defaults, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> value, key </span>) </span>{
					attrs[ key ] = self.coerce( attrs, key );
					<span class="hljs-keyword">if</span> ( value === attrs[ key ] ) {
						<span class="hljs-keyword">delete</span> attrs[ key ];
					}
				});

				<span class="hljs-keyword">return</span> attrs;
			}
		}, attributes );
	};

	wp.media._galleryDefaults = {
		<span class="hljs-attr">itemtag</span>: <span class="hljs-string">'dl'</span>,
		<span class="hljs-attr">icontag</span>: <span class="hljs-string">'dt'</span>,
		<span class="hljs-attr">captiontag</span>: <span class="hljs-string">'dd'</span>,
		<span class="hljs-attr">columns</span>: <span class="hljs-string">'3'</span>,
		<span class="hljs-attr">link</span>: <span class="hljs-string">'post'</span>,
		<span class="hljs-attr">size</span>: <span class="hljs-string">'thumbnail'</span>,
		<span class="hljs-attr">order</span>: <span class="hljs-string">'ASC'</span>,
		<span class="hljs-attr">id</span>: wp.media.view.settings.post &amp;&amp; wp.media.view.settings.post.id,
		<span class="hljs-attr">orderby</span> : <span class="hljs-string">'menu_order ID'</span>
	};

	<span class="hljs-keyword">if</span> ( wp.media.view.settings.galleryDefaults ) {
		wp.media.galleryDefaults = _.extend( {}, wp.media._galleryDefaults, wp.media.view.settings.galleryDefaults );
	} <span class="hljs-keyword">else</span> {
		wp.media.galleryDefaults = wp.media._galleryDefaults;
	}

	wp.media.gallery = <span class="hljs-keyword">new</span> wp.media.collection({
		<span class="hljs-attr">tag</span>: <span class="hljs-string">'gallery'</span>,
		<span class="hljs-attr">type</span> : <span class="hljs-string">'image'</span>,
		<span class="hljs-attr">editTitle</span> : wp.media.view.l10n.editGalleryTitle,
		<span class="hljs-attr">defaults</span> : wp.media.galleryDefaults,

		<span class="hljs-attr">setDefaults</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> attrs </span>) </span>{
			<span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>, changed = ! _.isEqual( wp.media.galleryDefaults, wp.media._galleryDefaults );
			_.each( <span class="hljs-keyword">this</span>.defaults, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> value, key </span>) </span>{
				attrs[ key ] = self.coerce( attrs, key );
				<span class="hljs-keyword">if</span> ( value === attrs[ key ] &amp;&amp; ( ! changed || value === wp.media._galleryDefaults[ key ] ) ) {
					<span class="hljs-keyword">delete</span> attrs[ key ];
				}
			} );
			<span class="hljs-keyword">return</span> attrs;
		}
	});

	<span class="hljs-comment">/**
	 * wp.media.featuredImage
	 * @namespace
	 */</span>
	wp.media.featuredImage = {
		<span class="hljs-comment">/**
		 * Get the featured image post ID
		 *
		 * @global wp.media.view.settings
		 *
		 * @returns {wp.media.view.settings.post.featuredImageId|number}
		 */</span>
		get: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">return</span> wp.media.view.settings.post.featuredImageId;
		},
		<span class="hljs-comment">/**
		 * Set the featured image id, save the post thumbnail data and
		 * set the HTML in the post meta box to the new featured image.
		 *
		 * @global wp.media.view.settings
		 * @global wp.media.post
		 *
		 * @param {number} id The post ID of the featured image, or -1 to unset it.
		 */</span>
		set: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> id </span>) </span>{
			<span class="hljs-keyword">var</span> settings = wp.media.view.settings;

			settings.post.featuredImageId = id;

			wp.media.post( <span class="hljs-string">'get-post-thumbnail-html'</span>, {
				<span class="hljs-attr">post_id</span>:      settings.post.id,
				<span class="hljs-attr">thumbnail_id</span>: settings.post.featuredImageId,
				<span class="hljs-attr">_wpnonce</span>:     settings.post.nonce
			}).done( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> html </span>) </span>{
				<span class="hljs-keyword">if</span> ( html == <span class="hljs-string">'0'</span> ) {
					<span class="hljs-built_in">window</span>.alert( <span class="hljs-built_in">window</span>.setPostThumbnailL10n.error );
					<span class="hljs-keyword">return</span>;
				}
				$( <span class="hljs-string">'.inside'</span>, <span class="hljs-string">'#postimagediv'</span> ).html( html );
			});
		},
		<span class="hljs-comment">/**
		 * Remove the featured image id, save the post thumbnail data and
		 * set the HTML in the post meta box to no featured image.
		 */</span>
		remove: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
			wp.media.featuredImage.set( <span class="hljs-number">-1</span> );
		},
		<span class="hljs-comment">/**
		 * The Featured Image workflow
		 *
		 * @global wp.media.controller.FeaturedImage
		 * @global wp.media.view.l10n
		 *
		 * @this wp.media.featuredImage
		 *
		 * @returns {wp.media.view.MediaFrame.Select} A media workflow.
		 */</span>
		frame: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>._frame ) {
				wp.media.frame = <span class="hljs-keyword">this</span>._frame;
				<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._frame;
			}

			<span class="hljs-keyword">this</span>._frame = wp.media({
				<span class="hljs-attr">state</span>: <span class="hljs-string">'featured-image'</span>,
				<span class="hljs-attr">states</span>: [ <span class="hljs-keyword">new</span> wp.media.controller.FeaturedImage() , <span class="hljs-keyword">new</span> wp.media.controller.EditImage() ]
			});

			<span class="hljs-keyword">this</span>._frame.on( <span class="hljs-string">'toolbar:create:featured-image'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> toolbar </span>) </span>{
				<span class="hljs-comment">/**
				 * @this wp.media.view.MediaFrame.Select
				 */</span>
				<span class="hljs-keyword">this</span>.createSelectToolbar( toolbar, {
					<span class="hljs-attr">text</span>: wp.media.view.l10n.setFeaturedImage
				});
			}, <span class="hljs-keyword">this</span>._frame );

			<span class="hljs-keyword">this</span>._frame.on( <span class="hljs-string">'content:render:edit-image'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
				<span class="hljs-keyword">var</span> selection = <span class="hljs-keyword">this</span>.state(<span class="hljs-string">'featured-image'</span>).get(<span class="hljs-string">'selection'</span>),
					view = <span class="hljs-keyword">new</span> wp.media.view.EditImage( { <span class="hljs-attr">model</span>: selection.single(), <span class="hljs-attr">controller</span>: <span class="hljs-keyword">this</span> } ).render();

				<span class="hljs-keyword">this</span>.content.set( view );</pre></div></div>
            
        </li>
        
        
        <li id="section-29">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-29">&#182;</a>
              </div>
              <p>after bringing in the frame, load the actual editor via an ajax call</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				view.loadEditor();

			}, <span class="hljs-keyword">this</span>._frame );

			<span class="hljs-keyword">this</span>._frame.state(<span class="hljs-string">'featured-image'</span>).on( <span class="hljs-string">'select'</span>, <span class="hljs-keyword">this</span>.select );
			<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._frame;
		},
		<span class="hljs-comment">/**
		 * 'select' callback for Featured Image workflow, triggered when
		 *  the 'Set Featured Image' button is clicked in the media modal.
		 *
		 * @global wp.media.view.settings
		 *
		 * @this wp.media.controller.FeaturedImage
		 */</span>
		select: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">var</span> selection = <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'selection'</span>).single();

			<span class="hljs-keyword">if</span> ( ! wp.media.view.settings.post.featuredImageId ) {
				<span class="hljs-keyword">return</span>;
			}

			wp.media.featuredImage.set( selection ? selection.id : <span class="hljs-number">-1</span> );
		},
		<span class="hljs-comment">/**
		 * Open the content media manager to the 'featured image' tab when
		 * the post thumbnail is clicked.
		 *
		 * Update the featured image id when the 'remove' link is clicked.
		 *
		 * @global wp.media.view.settings
		 */</span>
		init: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
			$(<span class="hljs-string">'#postimagediv'</span>).on( <span class="hljs-string">'click'</span>, <span class="hljs-string">'#set-post-thumbnail'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> event </span>) </span>{
				event.preventDefault();</pre></div></div>
            
        </li>
        
        
        <li id="section-30">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-30">&#182;</a>
              </div>
              <p>Stop propagation to prevent thickbox from activating.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				event.stopPropagation();

				wp.media.featuredImage.frame().open();
			}).on( <span class="hljs-string">'click'</span>, <span class="hljs-string">'#remove-post-thumbnail'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
				wp.media.featuredImage.remove();
				<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
			});
		}
	};

	$( wp.media.featuredImage.init );

	<span class="hljs-comment">/**
	 * wp.media.editor
	 * @namespace
	 */</span>
	wp.media.editor = {
		<span class="hljs-comment">/**
		 * Send content to the editor
		 *
		 * @global tinymce
		 * @global QTags
		 * @global wpActiveEditor
		 * @global tb_remove() - Possibly overloaded by legacy plugins
		 *
		 * @param {string} html Content to send to the editor
		 */</span>
		insert: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> html </span>) </span>{
			<span class="hljs-keyword">var</span> editor, wpActiveEditor,
				hasTinymce = ! _.isUndefined( <span class="hljs-built_in">window</span>.tinymce ),
				hasQuicktags = ! _.isUndefined( <span class="hljs-built_in">window</span>.QTags );

			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.activeEditor ) {
				wpActiveEditor = <span class="hljs-built_in">window</span>.wpActiveEditor = <span class="hljs-keyword">this</span>.activeEditor;
			} <span class="hljs-keyword">else</span> {
				wpActiveEditor = <span class="hljs-built_in">window</span>.wpActiveEditor;
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-31">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-31">&#182;</a>
              </div>
              <p>Delegate to the global <code>send_to_editor</code> if it exists.
This attempts to play nice with any themes/plugins that have
overridden the insert functionality.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( <span class="hljs-built_in">window</span>.send_to_editor ) {
				<span class="hljs-keyword">return</span> <span class="hljs-built_in">window</span>.send_to_editor.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
			}

			<span class="hljs-keyword">if</span> ( ! wpActiveEditor ) {
				<span class="hljs-keyword">if</span> ( hasTinymce &amp;&amp; tinymce.activeEditor ) {
					editor = tinymce.activeEditor;
					wpActiveEditor = <span class="hljs-built_in">window</span>.wpActiveEditor = editor.id;
				} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( ! hasQuicktags ) {
					<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
				}
			} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( hasTinymce ) {
				editor = tinymce.get( wpActiveEditor );
			}

			<span class="hljs-keyword">if</span> ( editor &amp;&amp; ! editor.isHidden() ) {
				editor.execCommand( <span class="hljs-string">'mceInsertContent'</span>, <span class="hljs-literal">false</span>, html );
			} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( hasQuicktags ) {
				QTags.insertContent( html );
			} <span class="hljs-keyword">else</span> {
				<span class="hljs-built_in">document</span>.getElementById( wpActiveEditor ).value += html;
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-32">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-32">&#182;</a>
              </div>
              <p>If the old thickbox remove function exists, call it in case
a theme/plugin overloaded it.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( <span class="hljs-built_in">window</span>.tb_remove ) {
				<span class="hljs-keyword">try</span> { <span class="hljs-built_in">window</span>.tb_remove(); } <span class="hljs-keyword">catch</span>( e ) {}
			}
		},

		<span class="hljs-comment">/**
		 * Setup 'workflow' and add to the 'workflows' cache. 'open' can
		 *  subsequently be called upon it.
		 *
		 * @global wp.media.view.l10n
		 *
		 * @param {string} id A slug used to identify the workflow.
		 * @param {Object} [options={}]
		 *
		 * @this wp.media.editor
		 *
		 * @returns {wp.media.view.MediaFrame.Select} A media workflow.
		 */</span>
		add: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> id, options </span>) </span>{
			<span class="hljs-keyword">var</span> workflow = <span class="hljs-keyword">this</span>.get( id );</pre></div></div>
            
        </li>
        
        
        <li id="section-33">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-33">&#182;</a>
              </div>
              <p>only add once: if exists return existing</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( workflow ) {
				<span class="hljs-keyword">return</span> workflow;
			}

			workflow = workflows[ id ] = wp.media( _.defaults( options || {}, {
				<span class="hljs-attr">frame</span>:    <span class="hljs-string">'post'</span>,
				<span class="hljs-attr">state</span>:    <span class="hljs-string">'insert'</span>,
				<span class="hljs-attr">title</span>:    wp.media.view.l10n.addMedia,
				<span class="hljs-attr">multiple</span>: <span class="hljs-literal">true</span>
			} ) );

			workflow.on( <span class="hljs-string">'insert'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> selection </span>) </span>{
				<span class="hljs-keyword">var</span> state = workflow.state();

				selection = selection || state.get(<span class="hljs-string">'selection'</span>);

				<span class="hljs-keyword">if</span> ( ! selection )
					<span class="hljs-keyword">return</span>;

				$.when.apply( $, selection.map( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> attachment </span>) </span>{
					<span class="hljs-keyword">var</span> display = state.display( attachment ).toJSON();
					<span class="hljs-comment">/**
					 * @this wp.media.editor
					 */</span>
					<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.send.attachment( display, attachment.toJSON() );
				}, <span class="hljs-keyword">this</span> ) ).done( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
					wp.media.editor.insert( _.toArray( <span class="hljs-built_in">arguments</span> ).join(<span class="hljs-string">'\n\n'</span>) );
				});
			}, <span class="hljs-keyword">this</span> );

			workflow.state(<span class="hljs-string">'gallery-edit'</span>).on( <span class="hljs-string">'update'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> selection </span>) </span>{
				<span class="hljs-comment">/**
				 * @this wp.media.editor
				 */</span>
				<span class="hljs-keyword">this</span>.insert( wp.media.gallery.shortcode( selection ).string() );
			}, <span class="hljs-keyword">this</span> );

			workflow.state(<span class="hljs-string">'playlist-edit'</span>).on( <span class="hljs-string">'update'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> selection </span>) </span>{
				<span class="hljs-comment">/**
				 * @this wp.media.editor
				 */</span>
				<span class="hljs-keyword">this</span>.insert( wp.media.playlist.shortcode( selection ).string() );
			}, <span class="hljs-keyword">this</span> );

			workflow.state(<span class="hljs-string">'video-playlist-edit'</span>).on( <span class="hljs-string">'update'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> selection </span>) </span>{
				<span class="hljs-comment">/**
				 * @this wp.media.editor
				 */</span>
				<span class="hljs-keyword">this</span>.insert( wp.media.playlist.shortcode( selection ).string() );
			}, <span class="hljs-keyword">this</span> );

			workflow.state(<span class="hljs-string">'embed'</span>).on( <span class="hljs-string">'select'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
				<span class="hljs-comment">/**
				 * @this wp.media.editor
				 */</span>
				<span class="hljs-keyword">var</span> state = workflow.state(),
					type = state.get(<span class="hljs-string">'type'</span>),
					embed = state.props.toJSON();

				embed.url = embed.url || <span class="hljs-string">''</span>;

				<span class="hljs-keyword">if</span> ( <span class="hljs-string">'link'</span> === type ) {
					_.defaults( embed, {
						<span class="hljs-attr">linkText</span>: embed.url,
						<span class="hljs-attr">linkUrl</span>: embed.url
					});

					<span class="hljs-keyword">this</span>.send.link( embed ).done( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> resp </span>) </span>{
						wp.media.editor.insert( resp );
					});

				} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( <span class="hljs-string">'image'</span> === type ) {
					_.defaults( embed, {
						<span class="hljs-attr">title</span>:   embed.url,
						<span class="hljs-attr">linkUrl</span>: <span class="hljs-string">''</span>,
						<span class="hljs-attr">align</span>:   <span class="hljs-string">'none'</span>,
						<span class="hljs-attr">link</span>:    <span class="hljs-string">'none'</span>
					});

					<span class="hljs-keyword">if</span> ( <span class="hljs-string">'none'</span> === embed.link ) {
						embed.linkUrl = <span class="hljs-string">''</span>;
					} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( <span class="hljs-string">'file'</span> === embed.link ) {
						embed.linkUrl = embed.url;
					}

					<span class="hljs-keyword">this</span>.insert( wp.media.string.image( embed ) );
				}
			}, <span class="hljs-keyword">this</span> );

			workflow.state(<span class="hljs-string">'featured-image'</span>).on( <span class="hljs-string">'select'</span>, wp.media.featuredImage.select );
			workflow.setState( workflow.options.state );
			<span class="hljs-keyword">return</span> workflow;
		},
		<span class="hljs-comment">/**
		 * Determines the proper current workflow id
		 *
		 * @global wpActiveEditor
		 * @global tinymce
		 *
		 * @param {string} [id=''] A slug used to identify the workflow.
		 *
		 * @returns {wpActiveEditor|string|tinymce.activeEditor.id}
		 */</span>
		id: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> id </span>) </span>{
			<span class="hljs-keyword">if</span> ( id ) {
				<span class="hljs-keyword">return</span> id;
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-34">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-34">&#182;</a>
              </div>
              <p>If an empty <code>id</code> is provided, default to <code>wpActiveEditor</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			id = <span class="hljs-built_in">window</span>.wpActiveEditor;</pre></div></div>
            
        </li>
        
        
        <li id="section-35">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-35">&#182;</a>
              </div>
              <p>If that doesnt work, fall back to <code>tinymce.activeEditor.id</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( ! id &amp;&amp; ! _.isUndefined( <span class="hljs-built_in">window</span>.tinymce ) &amp;&amp; tinymce.activeEditor ) {
				id = tinymce.activeEditor.id;
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-36">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-36">&#182;</a>
              </div>
              <p>Last but not least, fall back to the empty string.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			id = id || <span class="hljs-string">''</span>;
			<span class="hljs-keyword">return</span> id;
		},
		<span class="hljs-comment">/**
		 * Return the workflow specified by id
		 *
		 * @param {string} id A slug used to identify the workflow.
		 *
		 * @this wp.media.editor
		 *
		 * @returns {wp.media.view.MediaFrame} A media workflow.
		 */</span>
		get: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> id </span>) </span>{
			id = <span class="hljs-keyword">this</span>.id( id );
			<span class="hljs-keyword">return</span> workflows[ id ];
		},
		<span class="hljs-comment">/**
		 * Remove the workflow represented by id from the workflow cache
		 *
		 * @param {string} id A slug used to identify the workflow.
		 *
		 * @this wp.media.editor
		 */</span>
		remove: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> id </span>) </span>{
			id = <span class="hljs-keyword">this</span>.id( id );
			<span class="hljs-keyword">delete</span> workflows[ id ];
		},
		<span class="hljs-comment">/**
		 * @namespace
		 */</span>
		send: {
			<span class="hljs-comment">/**
			 * Called when sending an attachment to the editor
			 *   from the medial modal.
			 *
			 * @global wp.media.view.settings
			 * @global wp.media.post
			 *
			 * @param {Object} props Attachment details (align, link, size, etc).
			 * @param {Object} attachment The attachment object, media version of Post.
			 * @returns {Promise}
			 */</span>
			attachment: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> props, attachment </span>) </span>{
				<span class="hljs-keyword">var</span> caption = attachment.caption,
					options, html;</pre></div></div>
            
        </li>
        
        
        <li id="section-37">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-37">&#182;</a>
              </div>
              <p>If captions are disabled, clear the caption.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( ! wp.media.view.settings.captions ) {
					<span class="hljs-keyword">delete</span> attachment.caption;
				}

				props = wp.media.string.props( props, attachment );

				options = {
					<span class="hljs-attr">id</span>:           attachment.id,
					<span class="hljs-attr">post_content</span>: attachment.description,
					<span class="hljs-attr">post_excerpt</span>: caption
				};

				<span class="hljs-keyword">if</span> ( props.linkUrl ) {
					options.url = props.linkUrl;
				}

				<span class="hljs-keyword">if</span> ( <span class="hljs-string">'image'</span> === attachment.type ) {
					html = wp.media.string.image( props );

					_.each({
						<span class="hljs-attr">align</span>: <span class="hljs-string">'align'</span>,
						<span class="hljs-attr">size</span>:  <span class="hljs-string">'image-size'</span>,
						<span class="hljs-attr">alt</span>:   <span class="hljs-string">'image_alt'</span>
					}, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> option, prop </span>) </span>{
						<span class="hljs-keyword">if</span> ( props[ prop ] )
							options[ option ] = props[ prop ];
					});
				} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( <span class="hljs-string">'video'</span> === attachment.type ) {
					html = wp.media.string.video( props, attachment );
				} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( <span class="hljs-string">'audio'</span> === attachment.type ) {
					html = wp.media.string.audio( props, attachment );
				} <span class="hljs-keyword">else</span> {
					html = wp.media.string.link( props );
					options.post_title = props.title;
				}

				<span class="hljs-keyword">return</span> wp.media.post( <span class="hljs-string">'send-attachment-to-editor'</span>, {
					<span class="hljs-attr">nonce</span>:      wp.media.view.settings.nonce.sendToEditor,
					<span class="hljs-attr">attachment</span>: options,
					<span class="hljs-attr">html</span>:       html,
					<span class="hljs-attr">post_id</span>:    wp.media.view.settings.post.id
				});
			},
			<span class="hljs-comment">/**
			 * Called when 'Insert From URL' source is not an image. Example: YouTube url.
			 *
			 * @global wp.media.view.settings
			 *
			 * @param {Object} embed
			 * @returns {Promise}
			 */</span>
			link: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> embed </span>) </span>{
				<span class="hljs-keyword">return</span> wp.media.post( <span class="hljs-string">'send-link-to-editor'</span>, {
					<span class="hljs-attr">nonce</span>:     wp.media.view.settings.nonce.sendToEditor,
					<span class="hljs-attr">src</span>:       embed.linkUrl,
					<span class="hljs-attr">link_text</span>: embed.linkText,
					<span class="hljs-attr">html</span>:      wp.media.string.link( embed ),
					<span class="hljs-attr">post_id</span>:   wp.media.view.settings.post.id
				});
			}
		},
		<span class="hljs-comment">/**
		 * Open a workflow
		 *
		 * @param {string} [id=undefined] Optional. A slug used to identify the workflow.
		 * @param {Object} [options={}]
		 *
		 * @this wp.media.editor
		 *
		 * @returns {wp.media.view.MediaFrame}
		 */</span>
		open: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> id, options </span>) </span>{
			<span class="hljs-keyword">var</span> workflow;

			options = options || {};

			id = <span class="hljs-keyword">this</span>.id( id );
			<span class="hljs-keyword">this</span>.activeEditor = id;

			workflow = <span class="hljs-keyword">this</span>.get( id );</pre></div></div>
            
        </li>
        
        
        <li id="section-38">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-38">&#182;</a>
              </div>
              <p>Redo workflow if state has changed</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( ! workflow || ( workflow.options &amp;&amp; options.state !== workflow.options.state ) ) {
				workflow = <span class="hljs-keyword">this</span>.add( id, options );
			}

			wp.media.frame = workflow;

			<span class="hljs-keyword">return</span> workflow.open();
		},

		<span class="hljs-comment">/**
		 * Bind click event for .insert-media using event delegation
		 *
		 * @global wp.media.view.l10n
		 */</span>
		init: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
			$(<span class="hljs-built_in">document</span>.body)
				.on( <span class="hljs-string">'click.add-media-button'</span>, <span class="hljs-string">'.insert-media'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> event </span>) </span>{
					<span class="hljs-keyword">var</span> elem = $( event.currentTarget ),
						editor = elem.data(<span class="hljs-string">'editor'</span>),
						options = {
							<span class="hljs-attr">frame</span>:    <span class="hljs-string">'post'</span>,
							<span class="hljs-attr">state</span>:    <span class="hljs-string">'insert'</span>,
							<span class="hljs-attr">title</span>:    wp.media.view.l10n.addMedia,
							<span class="hljs-attr">multiple</span>: <span class="hljs-literal">true</span>
						};

					event.preventDefault();

					<span class="hljs-keyword">if</span> ( elem.hasClass( <span class="hljs-string">'gallery'</span> ) ) {
						options.state = <span class="hljs-string">'gallery'</span>;
						options.title = wp.media.view.l10n.createGalleryTitle;
					}

					wp.media.editor.open( editor, options );
				});</pre></div></div>
            
        </li>
        
        
        <li id="section-39">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-39">&#182;</a>
              </div>
              <p>Initialize and render the Editor drag-and-drop uploader.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">new</span> wp.media.view.EditorUploader().render();
		}
	};

	_.bindAll( wp.media.editor, <span class="hljs-string">'open'</span> );
	$( wp.media.editor.init );
}(jQuery, _));</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
