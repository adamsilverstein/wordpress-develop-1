<!DOCTYPE html>

<html>
<head>
  <title>media-widgets.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page_wrapper">
            <div id="jump_page">
              
                
                <a class="source" href="accordion.html">
                  accordion.js
                </a>
              
                
                <a class="source" href="bookmarklet.html">
                  bookmarklet.js
                </a>
              
                
                <a class="source" href="bookmarklet.min.html">
                  bookmarklet.min.js
                </a>
              
                
                <a class="source" href="color-picker.html">
                  color-picker.js
                </a>
              
                
                <a class="source" href="comment.html">
                  comment.js
                </a>
              
                
                <a class="source" href="common.html">
                  common.js
                </a>
              
                
                <a class="source" href="custom-background.html">
                  custom-background.js
                </a>
              
                
                <a class="source" href="custom-header.html">
                  custom-header.js
                </a>
              
                
                <a class="source" href="customize-controls.html">
                  customize-controls.js
                </a>
              
                
                <a class="source" href="customize-nav-menus.html">
                  customize-nav-menus.js
                </a>
              
                
                <a class="source" href="customize-widgets.html">
                  customize-widgets.js
                </a>
              
                
                <a class="source" href="dashboard.html">
                  dashboard.js
                </a>
              
                
                <a class="source" href="edit-comments.html">
                  edit-comments.js
                </a>
              
                
                <a class="source" href="editor-expand.html">
                  editor-expand.js
                </a>
              
                
                <a class="source" href="editor.html">
                  editor.js
                </a>
              
                
                <a class="source" href="farbtastic.html">
                  farbtastic.js
                </a>
              
                
                <a class="source" href="gallery.html">
                  gallery.js
                </a>
              
                
                <a class="source" href="image-edit.html">
                  image-edit.js
                </a>
              
                
                <a class="source" href="inline-edit-post.html">
                  inline-edit-post.js
                </a>
              
                
                <a class="source" href="inline-edit-tax.html">
                  inline-edit-tax.js
                </a>
              
                
                <a class="source" href="iris.min.html">
                  iris.min.js
                </a>
              
                
                <a class="source" href="language-chooser.html">
                  language-chooser.js
                </a>
              
                
                <a class="source" href="link.html">
                  link.js
                </a>
              
                
                <a class="source" href="media-gallery.html">
                  media-gallery.js
                </a>
              
                
                <a class="source" href="media-upload.html">
                  media-upload.js
                </a>
              
                
                <a class="source" href="media.html">
                  media.js
                </a>
              
                
                <a class="source" href="nav-menu.html">
                  nav-menu.js
                </a>
              
                
                <a class="source" href="password-strength-meter.html">
                  password-strength-meter.js
                </a>
              
                
                <a class="source" href="plugin-install.html">
                  plugin-install.js
                </a>
              
                
                <a class="source" href="post.html">
                  post.js
                </a>
              
                
                <a class="source" href="postbox.html">
                  postbox.js
                </a>
              
                
                <a class="source" href="press-this.html">
                  press-this.js
                </a>
              
                
                <a class="source" href="revisions.html">
                  revisions.js
                </a>
              
                
                <a class="source" href="set-post-thumbnail.html">
                  set-post-thumbnail.js
                </a>
              
                
                <a class="source" href="svg-painter.html">
                  svg-painter.js
                </a>
              
                
                <a class="source" href="tags-box.html">
                  tags-box.js
                </a>
              
                
                <a class="source" href="tags-suggest.html">
                  tags-suggest.js
                </a>
              
                
                <a class="source" href="tags.html">
                  tags.js
                </a>
              
                
                <a class="source" href="theme.html">
                  theme.js
                </a>
              
                
                <a class="source" href="updates.html">
                  updates.js
                </a>
              
                
                <a class="source" href="user-profile.html">
                  user-profile.js
                </a>
              
                
                <a class="source" href="user-suggest.html">
                  user-suggest.js
                </a>
              
                
                <a class="source" href="widgets.html">
                  widgets.js
                </a>
              
                
                <a class="source" href="media-audio-widget.html">
                  media-audio-widget.js
                </a>
              
                
                <a class="source" href="media-image-widget.html">
                  media-image-widget.js
                </a>
              
                
                <a class="source" href="media-video-widget.html">
                  media-video-widget.js
                </a>
              
                
                <a class="source" href="media-widgets.html">
                  media-widgets.js
                </a>
              
                
                <a class="source" href="text-widgets.html">
                  text-widgets.js
                </a>
              
                
                <a class="source" href="word-count.html">
                  word-count.js
                </a>
              
                
                <a class="source" href="wp-fullscreen-stub.html">
                  wp-fullscreen-stub.js
                </a>
              
                
                <a class="source" href="xfn.html">
                  xfn.js
                </a>
              
                
                <a class="source" href="theme-customizer.html">
                  theme-customizer.js
                </a>
              
                
                <a class="source" href="theme-options.html">
                  theme-options.js
                </a>
              
                
                <a class="source" href="html5.html">
                  html5.js
                </a>
              
                
                <a class="source" href="showcase.html">
                  showcase.js
                </a>
              
                
                <a class="source" href="color-scheme-control.html">
                  color-scheme-control.js
                </a>
              
                
                <a class="source" href="customize-preview.html">
                  customize-preview.js
                </a>
              
                
                <a class="source" href="functions.html">
                  functions.js
                </a>
              
                
                <a class="source" href="html5.html">
                  html5.js
                </a>
              
                
                <a class="source" href="keyboard-image-navigation.html">
                  keyboard-image-navigation.js
                </a>
              
                
                <a class="source" href="skip-link-focus-fix.html">
                  skip-link-focus-fix.js
                </a>
              
                
                <a class="source" href="customizer.html">
                  customizer.js
                </a>
              
                
                <a class="source" href="featured-content-admin.html">
                  featured-content-admin.js
                </a>
              
                
                <a class="source" href="functions.html">
                  functions.js
                </a>
              
                
                <a class="source" href="html5.html">
                  html5.js
                </a>
              
                
                <a class="source" href="keyboard-image-navigation.html">
                  keyboard-image-navigation.js
                </a>
              
                
                <a class="source" href="slider.html">
                  slider.js
                </a>
              
                
                <a class="source" href="customize-controls.html">
                  customize-controls.js
                </a>
              
                
                <a class="source" href="customize-preview.html">
                  customize-preview.js
                </a>
              
                
                <a class="source" href="global.html">
                  global.js
                </a>
              
                
                <a class="source" href="html5.html">
                  html5.js
                </a>
              
                
                <a class="source" href="jquery.scrollTo.html">
                  jquery.scrollTo.js
                </a>
              
                
                <a class="source" href="navigation.html">
                  navigation.js
                </a>
              
                
                <a class="source" href="skip-link-focus-fix.html">
                  skip-link-focus-fix.js
                </a>
              
                
                <a class="source" href="functions.html">
                  functions.js
                </a>
              
                
                <a class="source" href="html5.html">
                  html5.js
                </a>
              
                
                <a class="source" href="theme-customizer.html">
                  theme-customizer.js
                </a>
              
                
                <a class="source" href="html5.html">
                  html5.js
                </a>
              
                
                <a class="source" href="navigation.html">
                  navigation.js
                </a>
              
                
                <a class="source" href="theme-customizer.html">
                  theme-customizer.js
                </a>
              
                
                <a class="source" href="admin-bar.html">
                  admin-bar.js
                </a>
              
                
                <a class="source" href="autosave.html">
                  autosave.js
                </a>
              
                
                <a class="source" href="backbone.html">
                  backbone.js
                </a>
              
                
                <a class="source" href="backbone.min.html">
                  backbone.min.js
                </a>
              
                
                <a class="source" href="colorpicker.html">
                  colorpicker.js
                </a>
              
                
                <a class="source" href="comment-reply.html">
                  comment-reply.js
                </a>
              
                
                <a class="source" href="cropper.html">
                  cropper.js
                </a>
              
                
                <a class="source" href="customize-base.html">
                  customize-base.js
                </a>
              
                
                <a class="source" href="customize-loader.html">
                  customize-loader.js
                </a>
              
                
                <a class="source" href="customize-models.html">
                  customize-models.js
                </a>
              
                
                <a class="source" href="customize-preview-nav-menus.html">
                  customize-preview-nav-menus.js
                </a>
              
                
                <a class="source" href="customize-preview-widgets.html">
                  customize-preview-widgets.js
                </a>
              
                
                <a class="source" href="customize-preview.html">
                  customize-preview.js
                </a>
              
                
                <a class="source" href="customize-selective-refresh.html">
                  customize-selective-refresh.js
                </a>
              
                
                <a class="source" href="customize-views.html">
                  customize-views.js
                </a>
              
                
                <a class="source" href="heartbeat.html">
                  heartbeat.js
                </a>
              
                
                <a class="source" href="hoverIntent.html">
                  hoverIntent.js
                </a>
              
                
                <a class="source" href="imagesloaded.min.html">
                  imagesloaded.min.js
                </a>
              
                
                <a class="source" href="jquery.imgareaselect.html">
                  jquery.imgareaselect.js
                </a>
              
                
                <a class="source" href="jquery.imgareaselect.min.html">
                  jquery.imgareaselect.min.js
                </a>
              
                
                <a class="source" href="jquery.Jcrop.min.html">
                  jquery.Jcrop.min.js
                </a>
              
                
                <a class="source" href="jquery-migrate.html">
                  jquery-migrate.js
                </a>
              
                
                <a class="source" href="jquery-migrate.min.html">
                  jquery-migrate.min.js
                </a>
              
                
                <a class="source" href="jquery.color.min.html">
                  jquery.color.min.js
                </a>
              
                
                <a class="source" href="jquery.form.html">
                  jquery.form.js
                </a>
              
                
                <a class="source" href="jquery.form.min.html">
                  jquery.form.min.js
                </a>
              
                
                <a class="source" href="jquery.hotkeys.html">
                  jquery.hotkeys.js
                </a>
              
                
                <a class="source" href="jquery.hotkeys.min.html">
                  jquery.hotkeys.min.js
                </a>
              
                
                <a class="source" href="jquery.html">
                  jquery.js
                </a>
              
                
                <a class="source" href="jquery.masonry.html">
                  jquery.masonry.js
                </a>
              
                
                <a class="source" href="jquery.masonry.min.html">
                  jquery.masonry.min.js
                </a>
              
                
                <a class="source" href="jquery.query.html">
                  jquery.query.js
                </a>
              
                
                <a class="source" href="jquery.schedule.html">
                  jquery.schedule.js
                </a>
              
                
                <a class="source" href="jquery.serialize-object.html">
                  jquery.serialize-object.js
                </a>
              
                
                <a class="source" href="jquery.table-hotkeys.html">
                  jquery.table-hotkeys.js
                </a>
              
                
                <a class="source" href="jquery.table-hotkeys.min.html">
                  jquery.table-hotkeys.min.js
                </a>
              
                
                <a class="source" href="jquery.ui.touch-punch.html">
                  jquery.ui.touch-punch.js
                </a>
              
                
                <a class="source" href="suggest.html">
                  suggest.js
                </a>
              
                
                <a class="source" href="suggest.min.html">
                  suggest.min.js
                </a>
              
                
                <a class="source" href="accordion.html">
                  accordion.js
                </a>
              
                
                <a class="source" href="autocomplete.html">
                  autocomplete.js
                </a>
              
                
                <a class="source" href="button.html">
                  button.js
                </a>
              
                
                <a class="source" href="core.html">
                  core.js
                </a>
              
                
                <a class="source" href="datepicker.html">
                  datepicker.js
                </a>
              
                
                <a class="source" href="dialog.html">
                  dialog.js
                </a>
              
                
                <a class="source" href="draggable.html">
                  draggable.js
                </a>
              
                
                <a class="source" href="droppable.html">
                  droppable.js
                </a>
              
                
                <a class="source" href="effect-blind.html">
                  effect-blind.js
                </a>
              
                
                <a class="source" href="effect-bounce.html">
                  effect-bounce.js
                </a>
              
                
                <a class="source" href="effect-clip.html">
                  effect-clip.js
                </a>
              
                
                <a class="source" href="effect-drop.html">
                  effect-drop.js
                </a>
              
                
                <a class="source" href="effect-explode.html">
                  effect-explode.js
                </a>
              
                
                <a class="source" href="effect-fade.html">
                  effect-fade.js
                </a>
              
                
                <a class="source" href="effect-fold.html">
                  effect-fold.js
                </a>
              
                
                <a class="source" href="effect-highlight.html">
                  effect-highlight.js
                </a>
              
                
                <a class="source" href="effect-puff.html">
                  effect-puff.js
                </a>
              
                
                <a class="source" href="effect-pulsate.html">
                  effect-pulsate.js
                </a>
              
                
                <a class="source" href="effect-scale.html">
                  effect-scale.js
                </a>
              
                
                <a class="source" href="effect-shake.html">
                  effect-shake.js
                </a>
              
                
                <a class="source" href="effect-size.html">
                  effect-size.js
                </a>
              
                
                <a class="source" href="effect-slide.html">
                  effect-slide.js
                </a>
              
                
                <a class="source" href="effect-transfer.html">
                  effect-transfer.js
                </a>
              
                
                <a class="source" href="effect.html">
                  effect.js
                </a>
              
                
                <a class="source" href="menu.html">
                  menu.js
                </a>
              
                
                <a class="source" href="mouse.html">
                  mouse.js
                </a>
              
                
                <a class="source" href="position.html">
                  position.js
                </a>
              
                
                <a class="source" href="progressbar.html">
                  progressbar.js
                </a>
              
                
                <a class="source" href="resizable.html">
                  resizable.js
                </a>
              
                
                <a class="source" href="selectable.html">
                  selectable.js
                </a>
              
                
                <a class="source" href="selectmenu.html">
                  selectmenu.js
                </a>
              
                
                <a class="source" href="slider.html">
                  slider.js
                </a>
              
                
                <a class="source" href="sortable.html">
                  sortable.js
                </a>
              
                
                <a class="source" href="spinner.html">
                  spinner.js
                </a>
              
                
                <a class="source" href="tabs.html">
                  tabs.js
                </a>
              
                
                <a class="source" href="tooltip.html">
                  tooltip.js
                </a>
              
                
                <a class="source" href="widget.html">
                  widget.js
                </a>
              
                
                <a class="source" href="json2.html">
                  json2.js
                </a>
              
                
                <a class="source" href="masonry.min.html">
                  masonry.min.js
                </a>
              
                
                <a class="source" href="mce-view.html">
                  mce-view.js
                </a>
              
                
                <a class="source" href="media-audiovideo.html">
                  media-audiovideo.js
                </a>
              
                
                <a class="source" href="media-editor.html">
                  media-editor.js
                </a>
              
                
                <a class="source" href="media-grid.html">
                  media-grid.js
                </a>
              
                
                <a class="source" href="media-models.html">
                  media-models.js
                </a>
              
                
                <a class="source" href="media-views.html">
                  media-views.js
                </a>
              
                
                <a class="source" href="audiovideo.manifest.html">
                  audiovideo.manifest.js
                </a>
              
                
                <a class="source" href="audio-details.html">
                  audio-details.js
                </a>
              
                
                <a class="source" href="collection-add.html">
                  collection-add.js
                </a>
              
                
                <a class="source" href="collection-edit.html">
                  collection-edit.js
                </a>
              
                
                <a class="source" href="cropper.html">
                  cropper.js
                </a>
              
                
                <a class="source" href="customize-image-cropper.html">
                  customize-image-cropper.js
                </a>
              
                
                <a class="source" href="edit-attachment-metadata.html">
                  edit-attachment-metadata.js
                </a>
              
                
                <a class="source" href="edit-image.html">
                  edit-image.js
                </a>
              
                
                <a class="source" href="embed.html">
                  embed.js
                </a>
              
                
                <a class="source" href="featured-image.html">
                  featured-image.js
                </a>
              
                
                <a class="source" href="gallery-add.html">
                  gallery-add.js
                </a>
              
                
                <a class="source" href="gallery-edit.html">
                  gallery-edit.js
                </a>
              
                
                <a class="source" href="image-details.html">
                  image-details.js
                </a>
              
                
                <a class="source" href="library.html">
                  library.js
                </a>
              
                
                <a class="source" href="media-library.html">
                  media-library.js
                </a>
              
                
                <a class="source" href="region.html">
                  region.js
                </a>
              
                
                <a class="source" href="replace-image.html">
                  replace-image.js
                </a>
              
                
                <a class="source" href="site-icon-cropper.html">
                  site-icon-cropper.js
                </a>
              
                
                <a class="source" href="state-machine.html">
                  state-machine.js
                </a>
              
                
                <a class="source" href="state.html">
                  state.js
                </a>
              
                
                <a class="source" href="video-details.html">
                  video-details.js
                </a>
              
                
                <a class="source" href="grid.manifest.html">
                  grid.manifest.js
                </a>
              
                
                <a class="source" href="models.manifest.html">
                  models.manifest.js
                </a>
              
                
                <a class="source" href="attachment.html">
                  attachment.js
                </a>
              
                
                <a class="source" href="attachments.html">
                  attachments.js
                </a>
              
                
                <a class="source" href="post-image.html">
                  post-image.js
                </a>
              
                
                <a class="source" href="post-media.html">
                  post-media.js
                </a>
              
                
                <a class="source" href="query.html">
                  query.js
                </a>
              
                
                <a class="source" href="selection.html">
                  selection.js
                </a>
              
                
                <a class="source" href="manage.html">
                  manage.js
                </a>
              
                
                <a class="source" href="selection-sync.html">
                  selection-sync.js
                </a>
              
                
                <a class="source" href="views.manifest.html">
                  views.manifest.js
                </a>
              
                
                <a class="source" href="attachment-compat.html">
                  attachment-compat.js
                </a>
              
                
                <a class="source" href="attachment-filters.html">
                  attachment-filters.js
                </a>
              
                
                <a class="source" href="all.html">
                  all.js
                </a>
              
                
                <a class="source" href="date.html">
                  date.js
                </a>
              
                
                <a class="source" href="uploaded.html">
                  uploaded.js
                </a>
              
                
                <a class="source" href="attachment.html">
                  attachment.js
                </a>
              
                
                <a class="source" href="details-two-column.html">
                  details-two-column.js
                </a>
              
                
                <a class="source" href="details.html">
                  details.js
                </a>
              
                
                <a class="source" href="edit-library.html">
                  edit-library.js
                </a>
              
                
                <a class="source" href="edit-selection.html">
                  edit-selection.js
                </a>
              
                
                <a class="source" href="library.html">
                  library.js
                </a>
              
                
                <a class="source" href="selection.html">
                  selection.js
                </a>
              
                
                <a class="source" href="attachments.html">
                  attachments.js
                </a>
              
                
                <a class="source" href="browser.html">
                  browser.js
                </a>
              
                
                <a class="source" href="selection.html">
                  selection.js
                </a>
              
                
                <a class="source" href="audio-details.html">
                  audio-details.js
                </a>
              
                
                <a class="source" href="button-group.html">
                  button-group.js
                </a>
              
                
                <a class="source" href="button.html">
                  button.js
                </a>
              
                
                <a class="source" href="delete-selected-permanently.html">
                  delete-selected-permanently.js
                </a>
              
                
                <a class="source" href="delete-selected.html">
                  delete-selected.js
                </a>
              
                
                <a class="source" href="select-mode-toggle.html">
                  select-mode-toggle.js
                </a>
              
                
                <a class="source" href="cropper.html">
                  cropper.js
                </a>
              
                
                <a class="source" href="edit-image-details.html">
                  edit-image-details.js
                </a>
              
                
                <a class="source" href="edit-image.html">
                  edit-image.js
                </a>
              
                
                <a class="source" href="embed.html">
                  embed.js
                </a>
              
                
                <a class="source" href="image.html">
                  image.js
                </a>
              
                
                <a class="source" href="link.html">
                  link.js
                </a>
              
                
                <a class="source" href="url.html">
                  url.js
                </a>
              
                
                <a class="source" href="focus-manager.html">
                  focus-manager.js
                </a>
              
                
                <a class="source" href="frame.html">
                  frame.js
                </a>
              
                
                <a class="source" href="audio-details.html">
                  audio-details.js
                </a>
              
                
                <a class="source" href="edit-attachments.html">
                  edit-attachments.js
                </a>
              
                
                <a class="source" href="image-details.html">
                  image-details.js
                </a>
              
                
                <a class="source" href="manage.html">
                  manage.js
                </a>
              
                
                <a class="source" href="media-details.html">
                  media-details.js
                </a>
              
                
                <a class="source" href="post.html">
                  post.js
                </a>
              
                
                <a class="source" href="select.html">
                  select.js
                </a>
              
                
                <a class="source" href="video-details.html">
                  video-details.js
                </a>
              
                
                <a class="source" href="iframe.html">
                  iframe.js
                </a>
              
                
                <a class="source" href="image-details.html">
                  image-details.js
                </a>
              
                
                <a class="source" href="label.html">
                  label.js
                </a>
              
                
                <a class="source" href="media-details.html">
                  media-details.js
                </a>
              
                
                <a class="source" href="media-frame.html">
                  media-frame.js
                </a>
              
                
                <a class="source" href="menu-item.html">
                  menu-item.js
                </a>
              
                
                <a class="source" href="menu.html">
                  menu.js
                </a>
              
                
                <a class="source" href="modal.html">
                  modal.js
                </a>
              
                
                <a class="source" href="priority-list.html">
                  priority-list.js
                </a>
              
                
                <a class="source" href="router-item.html">
                  router-item.js
                </a>
              
                
                <a class="source" href="router.html">
                  router.js
                </a>
              
                
                <a class="source" href="search.html">
                  search.js
                </a>
              
                
                <a class="source" href="selection.html">
                  selection.js
                </a>
              
                
                <a class="source" href="settings.html">
                  settings.js
                </a>
              
                
                <a class="source" href="attachment-display.html">
                  attachment-display.js
                </a>
              
                
                <a class="source" href="gallery.html">
                  gallery.js
                </a>
              
                
                <a class="source" href="playlist.html">
                  playlist.js
                </a>
              
                
                <a class="source" href="sidebar.html">
                  sidebar.js
                </a>
              
                
                <a class="source" href="site-icon-cropper.html">
                  site-icon-cropper.js
                </a>
              
                
                <a class="source" href="site-icon-preview.html">
                  site-icon-preview.js
                </a>
              
                
                <a class="source" href="spinner.html">
                  spinner.js
                </a>
              
                
                <a class="source" href="toolbar.html">
                  toolbar.js
                </a>
              
                
                <a class="source" href="embed.html">
                  embed.js
                </a>
              
                
                <a class="source" href="select.html">
                  select.js
                </a>
              
                
                <a class="source" href="editor.html">
                  editor.js
                </a>
              
                
                <a class="source" href="inline.html">
                  inline.js
                </a>
              
                
                <a class="source" href="status-error.html">
                  status-error.js
                </a>
              
                
                <a class="source" href="status.html">
                  status.js
                </a>
              
                
                <a class="source" href="window.html">
                  window.js
                </a>
              
                
                <a class="source" href="video-details.html">
                  video-details.js
                </a>
              
                
                <a class="source" href="view.html">
                  view.js
                </a>
              
                
                <a class="source" href="froogaloop.min.html">
                  froogaloop.min.js
                </a>
              
                
                <a class="source" href="mediaelement-and-player.min.html">
                  mediaelement-and-player.min.js
                </a>
              
                
                <a class="source" href="wp-mediaelement.html">
                  wp-mediaelement.js
                </a>
              
                
                <a class="source" href="wp-playlist.html">
                  wp-playlist.js
                </a>
              
                
                <a class="source" href="handlers.html">
                  handlers.js
                </a>
              
                
                <a class="source" href="plupload.full.min.html">
                  plupload.full.min.js
                </a>
              
                
                <a class="source" href="wp-plupload.html">
                  wp-plupload.js
                </a>
              
                
                <a class="source" href="quicktags.html">
                  quicktags.js
                </a>
              
                
                <a class="source" href="shortcode.html">
                  shortcode.js
                </a>
              
                
                <a class="source" href="swfobject.html">
                  swfobject.js
                </a>
              
                
                <a class="source" href="handlers.html">
                  handlers.js
                </a>
              
                
                <a class="source" href="handlers.min.html">
                  handlers.min.js
                </a>
              
                
                <a class="source" href="swfupload.cookies.html">
                  swfupload.cookies.js
                </a>
              
                
                <a class="source" href="swfupload.queue.html">
                  swfupload.queue.js
                </a>
              
                
                <a class="source" href="swfupload.speed.html">
                  swfupload.speed.js
                </a>
              
                
                <a class="source" href="swfupload.swfobject.html">
                  swfupload.swfobject.js
                </a>
              
                
                <a class="source" href="swfupload.html">
                  swfupload.js
                </a>
              
                
                <a class="source" href="thickbox.html">
                  thickbox.js
                </a>
              
                
                <a class="source" href="wp-langs-en.html">
                  wp-langs-en.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="theme.html">
                  theme.js
                </a>
              
                
                <a class="source" href="theme.min.html">
                  theme.min.js
                </a>
              
                
                <a class="source" href="theme.html">
                  theme.js
                </a>
              
                
                <a class="source" href="theme.min.html">
                  theme.min.js
                </a>
              
                
                <a class="source" href="tiny_mce_popup.html">
                  tiny_mce_popup.js
                </a>
              
                
                <a class="source" href="tinymce.html">
                  tinymce.js
                </a>
              
                
                <a class="source" href="tinymce.min.html">
                  tinymce.min.js
                </a>
              
                
                <a class="source" href="editable_selects.html">
                  editable_selects.js
                </a>
              
                
                <a class="source" href="form_utils.html">
                  form_utils.js
                </a>
              
                
                <a class="source" href="mctabs.html">
                  mctabs.js
                </a>
              
                
                <a class="source" href="validate.html">
                  validate.js
                </a>
              
                
                <a class="source" href="tw-sack.html">
                  tw-sack.js
                </a>
              
                
                <a class="source" href="twemoji.html">
                  twemoji.js
                </a>
              
                
                <a class="source" href="underscore.html">
                  underscore.js
                </a>
              
                
                <a class="source" href="underscore.min.html">
                  underscore.min.js
                </a>
              
                
                <a class="source" href="utils.html">
                  utils.js
                </a>
              
                
                <a class="source" href="wp-a11y.html">
                  wp-a11y.js
                </a>
              
                
                <a class="source" href="wp-ajax-response.html">
                  wp-ajax-response.js
                </a>
              
                
                <a class="source" href="wp-api.html">
                  wp-api.js
                </a>
              
                
                <a class="source" href="wp-auth-check.html">
                  wp-auth-check.js
                </a>
              
                
                <a class="source" href="wp-backbone.html">
                  wp-backbone.js
                </a>
              
                
                <a class="source" href="wp-custom-header.html">
                  wp-custom-header.js
                </a>
              
                
                <a class="source" href="wp-embed-template.html">
                  wp-embed-template.js
                </a>
              
                
                <a class="source" href="wp-embed.html">
                  wp-embed.js
                </a>
              
                
                <a class="source" href="wp-emoji-loader.html">
                  wp-emoji-loader.js
                </a>
              
                
                <a class="source" href="wp-emoji.html">
                  wp-emoji.js
                </a>
              
                
                <a class="source" href="wp-list-revisions.html">
                  wp-list-revisions.js
                </a>
              
                
                <a class="source" href="wp-lists.html">
                  wp-lists.js
                </a>
              
                
                <a class="source" href="wp-pointer.html">
                  wp-pointer.js
                </a>
              
                
                <a class="source" href="wp-util.html">
                  wp-util.js
                </a>
              
                
                <a class="source" href="wpdialog.html">
                  wpdialog.js
                </a>
              
                
                <a class="source" href="wplink.html">
                  wplink.js
                </a>
              
                
                <a class="source" href="zxcvbn-async.html">
                  zxcvbn-async.js
                </a>
              
                
                <a class="source" href="zxcvbn.min.html">
                  zxcvbn.min.js
                </a>
              
            </div>
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>media-widgets.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-comment">/* eslint consistent-this: [ "error", "control" ] */</span>
wp.mediaWidgets = ( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> $ </span>) </span>{
<span class="hljs-meta">	'use strict'</span>;

	<span class="hljs-keyword">var</span> component = {};

	<span class="hljs-comment">/**
	 * Widget control (view) constructors, mapping widget id_base to subclass of MediaWidgetControl.
	 *
	 * Media widgets register themselves by assigning subclasses of MediaWidgetControl onto this object by widget ID base.
	 *
	 * @type {Object.&lt;string, wp.mediaWidgets.MediaWidgetModel&gt;}
	 */</span>
	component.controlConstructors = {};

	<span class="hljs-comment">/**
	 * Widget model constructors, mapping widget id_base to subclass of MediaWidgetModel.
	 *
	 * Media widgets register themselves by assigning subclasses of MediaWidgetControl onto this object by widget ID base.
	 *
	 * @type {Object.&lt;string, wp.mediaWidgets.MediaWidgetModel&gt;}
	 */</span>
	component.modelConstructors = {};

	<span class="hljs-comment">/**
	 * Library which persists the customized display settings across selections.
	 *
	 * @class PersistentDisplaySettingsLibrary
	 * @constructor
	 */</span>
	component.PersistentDisplaySettingsLibrary = wp.media.controller.Library.extend({

		<span class="hljs-comment">/**
		 * Initialize.
		 *
		 * @param {Object} options - Options.
		 * @returns {void}
		 */</span>
		initialize: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">initialize</span>(<span class="hljs-params"> options </span>) </span>{
			_.bindAll( <span class="hljs-keyword">this</span>, <span class="hljs-string">'handleDisplaySettingChange'</span> );
			wp.media.controller.Library.prototype.initialize.call( <span class="hljs-keyword">this</span>, options );
		},

		<span class="hljs-comment">/**
		 * Sync changes to the current display settings back into the current customized.
		 *
		 * @param {Backbone.Model} displaySettings - Modified display settings.
		 * @returns {void}
		 */</span>
		handleDisplaySettingChange: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handleDisplaySettingChange</span>(<span class="hljs-params"> displaySettings </span>) </span>{
			<span class="hljs-keyword">this</span>.get( <span class="hljs-string">'selectedDisplaySettings'</span> ).set( displaySettings.attributes );
		},

		<span class="hljs-comment">/**
		 * Get the display settings model.
		 *
		 * Model returned is updated with the current customized display settings,
		 * and an event listener is added so that changes made to the settings
		 * will sync back into the model storing the session's customized display
		 * settings.
		 *
		 * @param {Backbone.Model} model - Display settings model.
		 * @returns {Backbone.Model} Display settings model.
		 */</span>
		display: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getDisplaySettingsModel</span>(<span class="hljs-params"> model </span>) </span>{
			<span class="hljs-keyword">var</span> display, selectedDisplaySettings = <span class="hljs-keyword">this</span>.get( <span class="hljs-string">'selectedDisplaySettings'</span> );
			display = wp.media.controller.Library.prototype.display.call( <span class="hljs-keyword">this</span>, model );

			display.off( <span class="hljs-string">'change'</span>, <span class="hljs-keyword">this</span>.handleDisplaySettingChange ); <span class="hljs-comment">// Prevent duplicated event handlers.</span>
			display.set( selectedDisplaySettings.attributes );
			<span class="hljs-keyword">if</span> ( <span class="hljs-string">'custom'</span> === selectedDisplaySettings.get( <span class="hljs-string">'link_type'</span> ) ) {
				display.linkUrl = selectedDisplaySettings.get( <span class="hljs-string">'link_url'</span> );
			}
			display.on( <span class="hljs-string">'change'</span>, <span class="hljs-keyword">this</span>.handleDisplaySettingChange );
			<span class="hljs-keyword">return</span> display;
		}
	});

	<span class="hljs-comment">/**
	 * Extended view for managing the embed UI.
	 *
	 * @class MediaEmbedView
	 * @constructor
	 */</span>
	component.MediaEmbedView = wp.media.view.Embed.extend({

		<span class="hljs-comment">/**
		 * Refresh embed view.
		 *
		 * Forked override of {wp.media.view.Embed#refresh()} to suppress irrelevant "link text" field.
		 *
		 * @returns {void}
		 */</span>
		refresh: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">refresh</span>(<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">var</span> Constructor;

			<span class="hljs-keyword">if</span> ( <span class="hljs-string">'image'</span> === <span class="hljs-keyword">this</span>.controller.options.mimeType ) {
				Constructor = wp.media.view.EmbedImage;
			} <span class="hljs-keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>This should be eliminated once #40450 lands of when this is merged into core.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				Constructor = wp.media.view.EmbedLink.extend({

					<span class="hljs-comment">/**
					 * Set the disabled state on the Add to Widget button.
					 *
					 * @param {boolean} disabled - Disabled.
					 * @returns {void}
					 */</span>
					setAddToWidgetButtonDisabled: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setAddToWidgetButtonDisabled</span>(<span class="hljs-params"> disabled </span>) </span>{
						<span class="hljs-keyword">this</span>.views.parent.views.parent.views.get( <span class="hljs-string">'.media-frame-toolbar'</span> )[<span class="hljs-number">0</span>].$el.find( <span class="hljs-string">'.media-button-select'</span> ).prop( <span class="hljs-string">'disabled'</span>, disabled );
					},

					<span class="hljs-comment">/**
					 * Set or clear an error notice.
					 *
					 * @param {string} notice - Notice.
					 * @returns {void}
					 */</span>
					setErrorNotice: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setErrorNotice</span>(<span class="hljs-params"> notice </span>) </span>{
						<span class="hljs-keyword">var</span> embedLinkView = <span class="hljs-keyword">this</span>, noticeContainer; <span class="hljs-comment">// eslint-disable-line consistent-this</span>

						noticeContainer = embedLinkView.views.parent.$el.find( <span class="hljs-string">'&gt; .notice:first-child'</span> );
						<span class="hljs-keyword">if</span> ( ! notice ) {
							<span class="hljs-keyword">if</span> ( noticeContainer.length ) {
								noticeContainer.slideUp( <span class="hljs-string">'fast'</span> );
							}
						} <span class="hljs-keyword">else</span> {
							<span class="hljs-keyword">if</span> ( ! noticeContainer.length ) {
								noticeContainer = $( <span class="hljs-string">'&lt;div class="media-widget-embed-notice notice notice-error notice-alt"&gt;&lt;/div&gt;'</span> );
								noticeContainer.hide();
								embedLinkView.views.parent.$el.prepend( noticeContainer );
							}
							noticeContainer.empty();
							noticeContainer.append( $( <span class="hljs-string">'&lt;p&gt;'</span>, {
								<span class="hljs-attr">html</span>: notice
							} ) );
							noticeContainer.slideDown( <span class="hljs-string">'fast'</span> );
						}
					},

					<span class="hljs-comment">/**
					 * Fetch media.
					 *
					 * @returns {void}
					 */</span>
					fetch: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
						<span class="hljs-keyword">var</span> embedLinkView = <span class="hljs-keyword">this</span>, fetchSuccess, matches, fileExt, urlParser; <span class="hljs-comment">// eslint-disable-line consistent-this</span>

						<span class="hljs-keyword">if</span> ( embedLinkView.dfd &amp;&amp; <span class="hljs-string">'pending'</span> === embedLinkView.dfd.state() ) {
							embedLinkView.dfd.abort();
						}</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>Abort if the URL field was emptied out.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>						<span class="hljs-keyword">if</span> ( ! embedLinkView.model.get( <span class="hljs-string">'url'</span> ) ) {
							embedLinkView.setErrorNotice( <span class="hljs-string">''</span> );
							<span class="hljs-keyword">return</span>;
						}

						fetchSuccess = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> response </span>) </span>{
							embedLinkView.renderoEmbed({
								<span class="hljs-attr">data</span>: {
									<span class="hljs-attr">body</span>: response
								}
							});

							$( <span class="hljs-string">'#embed-url-field'</span> ).removeClass( <span class="hljs-string">'invalid'</span> );
							embedLinkView.setErrorNotice( <span class="hljs-string">''</span> );
							embedLinkView.setAddToWidgetButtonDisabled( <span class="hljs-literal">false</span> );
						};

						urlParser = <span class="hljs-built_in">document</span>.createElement( <span class="hljs-string">'a'</span> );
						urlParser.href = embedLinkView.model.get( <span class="hljs-string">'url'</span> );
						matches = urlParser.pathname.toLowerCase().match( <span class="hljs-regexp">/\.(\w+)$/</span> );
						<span class="hljs-keyword">if</span> ( matches ) {
							fileExt = matches[<span class="hljs-number">1</span>];
							<span class="hljs-keyword">if</span> ( ! wp.media.view.settings.embedMimes[ fileExt ] ) {
								embedLinkView.renderFail();
							} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( <span class="hljs-number">0</span> !== wp.media.view.settings.embedMimes[ fileExt ].indexOf( embedLinkView.controller.options.mimeType ) ) {
								embedLinkView.renderFail();
							} <span class="hljs-keyword">else</span> {
								fetchSuccess( <span class="hljs-string">'&lt;!--success--&gt;'</span> );
							}
							<span class="hljs-keyword">return</span>;
						}

						embedLinkView.dfd = $.ajax({
							<span class="hljs-attr">url</span>: wp.media.view.settings.oEmbedProxyUrl,
							<span class="hljs-attr">data</span>: {
								<span class="hljs-attr">url</span>: embedLinkView.model.get( <span class="hljs-string">'url'</span> ),
								<span class="hljs-attr">maxwidth</span>: embedLinkView.model.get( <span class="hljs-string">'width'</span> ),
								<span class="hljs-attr">maxheight</span>: embedLinkView.model.get( <span class="hljs-string">'height'</span> ),
								<span class="hljs-attr">_wpnonce</span>: wp.media.view.settings.nonce.wpRestApi,
								<span class="hljs-attr">discover</span>: <span class="hljs-literal">false</span>
							},
							<span class="hljs-attr">type</span>: <span class="hljs-string">'GET'</span>,
							<span class="hljs-attr">dataType</span>: <span class="hljs-string">'json'</span>,
							<span class="hljs-attr">context</span>: embedLinkView
						});

						embedLinkView.dfd.done( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> response </span>) </span>{
							<span class="hljs-keyword">if</span> ( embedLinkView.controller.options.mimeType !== response.type ) {
								embedLinkView.renderFail();
								<span class="hljs-keyword">return</span>;
							}
							fetchSuccess( response.html );
						});
						embedLinkView.dfd.fail( _.bind( embedLinkView.renderFail, embedLinkView ) );
					},

					<span class="hljs-comment">/**
					 * Handle render failure.
					 *
					 * Overrides the {EmbedLink#renderFail()} method to prevent showing the "Link Text" field.
					 * The element is getting display:none in the stylesheet, but the underlying method uses
					 * uses {jQuery.fn.show()} which adds an inline style. This avoids the need for !important.
					 *
					 * @returns {void}
					 */</span>
					renderFail: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">renderFail</span>(<span class="hljs-params">  </span>) </span>{
						<span class="hljs-keyword">var</span> embedLinkView = <span class="hljs-keyword">this</span>; <span class="hljs-comment">// eslint-disable-line consistent-this</span>
						$( <span class="hljs-string">'#embed-url-field'</span> ).addClass( <span class="hljs-string">'invalid'</span> );
						embedLinkView.setErrorNotice( embedLinkView.controller.options.invalidEmbedTypeError || <span class="hljs-string">'ERROR'</span> );
						embedLinkView.setAddToWidgetButtonDisabled( <span class="hljs-literal">true</span> );
					}
				});
			}

			<span class="hljs-keyword">this</span>.settings( <span class="hljs-keyword">new</span> Constructor({
				<span class="hljs-attr">controller</span>: <span class="hljs-keyword">this</span>.controller,
				<span class="hljs-attr">model</span>:      <span class="hljs-keyword">this</span>.model.props,
				<span class="hljs-attr">priority</span>:   <span class="hljs-number">40</span>
			}) );
		}
	});

	<span class="hljs-comment">/**
	 * Custom media frame for selecting uploaded media or providing media by URL.
	 *
	 * @class MediaFrameSelect
	 * @constructor
	 */</span>
	component.MediaFrameSelect = wp.media.view.MediaFrame.Post.extend({

		<span class="hljs-comment">/**
		 * Create the default states.
		 *
		 * @returns {void}
		 */</span>
		createStates: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createStates</span>(<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">var</span> mime = <span class="hljs-keyword">this</span>.options.mimeType, specificMimes = [];
			_.each( wp.media.view.settings.embedMimes, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> embedMime </span>) </span>{
				<span class="hljs-keyword">if</span> ( <span class="hljs-number">0</span> === embedMime.indexOf( mime ) ) {
					specificMimes.push( embedMime );
				}
			});
			<span class="hljs-keyword">if</span> ( specificMimes.length &gt; <span class="hljs-number">0</span> ) {
				mime = specificMimes.join( <span class="hljs-string">','</span> );
			}

			<span class="hljs-keyword">this</span>.states.add( [</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>Main states.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">new</span> component.PersistentDisplaySettingsLibrary({
					<span class="hljs-attr">id</span>:         <span class="hljs-string">'insert'</span>,
					<span class="hljs-attr">title</span>:      <span class="hljs-keyword">this</span>.options.title,
					<span class="hljs-attr">selection</span>:  <span class="hljs-keyword">this</span>.options.selection,
					<span class="hljs-attr">priority</span>:   <span class="hljs-number">20</span>,
					<span class="hljs-attr">toolbar</span>:    <span class="hljs-string">'main-insert'</span>,
					<span class="hljs-attr">filterable</span>: <span class="hljs-string">'dates'</span>,
					<span class="hljs-attr">library</span>:    wp.media.query({
						<span class="hljs-attr">type</span>: mime
					}),
					<span class="hljs-attr">multiple</span>:   <span class="hljs-literal">false</span>,
					<span class="hljs-attr">editable</span>:   <span class="hljs-literal">true</span>,

					<span class="hljs-attr">selectedDisplaySettings</span>: <span class="hljs-keyword">this</span>.options.selectedDisplaySettings,
					<span class="hljs-attr">displaySettings</span>: _.isUndefined( <span class="hljs-keyword">this</span>.options.showDisplaySettings ) ? <span class="hljs-literal">true</span> : <span class="hljs-keyword">this</span>.options.showDisplaySettings,
					<span class="hljs-attr">displayUserSettings</span>: <span class="hljs-literal">false</span> <span class="hljs-comment">// We use the display settings from the current/default widget instance props.</span>
				}),

				<span class="hljs-keyword">new</span> wp.media.controller.EditImage({ <span class="hljs-attr">model</span>: <span class="hljs-keyword">this</span>.options.editImage }),</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>Embed states.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">new</span> wp.media.controller.Embed({
					<span class="hljs-attr">metadata</span>: <span class="hljs-keyword">this</span>.options.metadata,
					<span class="hljs-attr">type</span>: <span class="hljs-string">'image'</span> === <span class="hljs-keyword">this</span>.options.mimeType ? <span class="hljs-string">'image'</span> : <span class="hljs-string">'link'</span>,
					<span class="hljs-attr">invalidEmbedTypeError</span>: <span class="hljs-keyword">this</span>.options.invalidEmbedTypeError
				})
			] );
		},

		<span class="hljs-comment">/**
		 * Main insert toolbar.
		 *
		 * Forked override of {wp.media.view.MediaFrame.Post#mainInsertToolbar()} to override text.
		 *
		 * @param {wp.Backbone.View} view - Toolbar view.
		 * @this {wp.media.controller.Library}
		 * @returns {void}
		 */</span>
		mainInsertToolbar: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">mainInsertToolbar</span>(<span class="hljs-params"> view </span>) </span>{
			<span class="hljs-keyword">var</span> controller = <span class="hljs-keyword">this</span>; <span class="hljs-comment">// eslint-disable-line consistent-this</span>
			view.set( <span class="hljs-string">'insert'</span>, {
				<span class="hljs-attr">style</span>:    <span class="hljs-string">'primary'</span>,
				<span class="hljs-attr">priority</span>: <span class="hljs-number">80</span>,
				<span class="hljs-attr">text</span>:     controller.options.text, <span class="hljs-comment">// The whole reason for the fork.</span>
				requires: { <span class="hljs-attr">selection</span>: <span class="hljs-literal">true</span> },

				<span class="hljs-comment">/**
				 * Handle click.
				 *
				 * @fires wp.media.controller.State#insert()
				 * @returns {void}
				 */</span>
				click: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onClick</span>(<span class="hljs-params"></span>) </span>{
					<span class="hljs-keyword">var</span> state = controller.state(),
						selection = state.get( <span class="hljs-string">'selection'</span> );

					controller.close();
					state.trigger( <span class="hljs-string">'insert'</span>, selection ).reset();
				}
			});
		},

		<span class="hljs-comment">/**
		 * Main embed toolbar.
		 *
		 * Forked override of {wp.media.view.MediaFrame.Post#mainEmbedToolbar()} to override text.
		 *
		 * @param {wp.Backbone.View} toolbar - Toolbar view.
		 * @this {wp.media.controller.Library}
		 * @returns {void}
		 */</span>
		mainEmbedToolbar: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">mainEmbedToolbar</span>(<span class="hljs-params"> toolbar </span>) </span>{
			toolbar.view = <span class="hljs-keyword">new</span> wp.media.view.Toolbar.Embed({
				<span class="hljs-attr">controller</span>: <span class="hljs-keyword">this</span>,
				<span class="hljs-attr">text</span>: <span class="hljs-keyword">this</span>.options.text,
				<span class="hljs-attr">event</span>: <span class="hljs-string">'insert'</span>
			});
		},

		<span class="hljs-comment">/**
		 * Embed content.
		 *
		 * Forked override of {wp.media.view.MediaFrame.Post#embedContent()} to suppress irrelevant "link text" field.
		 *
		 * @returns {void}
		 */</span>
		embedContent: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">embedContent</span>(<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">var</span> view = <span class="hljs-keyword">new</span> component.MediaEmbedView({
				<span class="hljs-attr">controller</span>: <span class="hljs-keyword">this</span>,
				<span class="hljs-attr">model</span>:      <span class="hljs-keyword">this</span>.state()
			}).render();

			<span class="hljs-keyword">this</span>.content.set( view );

			<span class="hljs-keyword">if</span> ( ! wp.media.isTouchDevice ) {
				view.url.focus();
			}
		}
	});

	<span class="hljs-comment">/**
	 * Media widget control.
	 *
	 * @class MediaWidgetControl
	 * @constructor
	 * @abstract
	 */</span>
	component.MediaWidgetControl = Backbone.View.extend({

		<span class="hljs-comment">/**
		 * Translation strings.
		 *
		 * The mapping of translation strings is handled by media widget subclasses,
		 * exported from PHP to JS such as is done in WP_Widget_Media_Image::enqueue_admin_scripts().
		 *
		 * @type {Object}
		 */</span>
		l10n: {
			<span class="hljs-attr">add_to_widget</span>: <span class="hljs-string">'{{add_to_widget}}'</span>,
			<span class="hljs-attr">add_media</span>: <span class="hljs-string">'{{add_media}}'</span>
		},

		<span class="hljs-comment">/**
		 * Widget ID base.
		 *
		 * This may be defined by the subclass. It may be exported from PHP to JS
		 * such as is done in WP_Widget_Media_Image::enqueue_admin_scripts(). If not,
		 * it will attempt to be discovered by looking to see if this control
		 * instance extends each member of component.controlConstructors, and if
		 * it does extend one, will use the key as the id_base.
		 *
		 * @type {string}
		 */</span>
		id_base: <span class="hljs-string">''</span>,

		<span class="hljs-comment">/**
		 * Mime type.
		 *
		 * This must be defined by the subclass. It may be exported from PHP to JS
		 * such as is done in WP_Widget_Media_Image::enqueue_admin_scripts().
		 *
		 * @type {string}
		 */</span>
		mime_type: <span class="hljs-string">''</span>,

		<span class="hljs-comment">/**
		 * View events.
		 *
		 * @type {Object}
		 */</span>
		events: {
			<span class="hljs-string">'click .notice-missing-attachment a'</span>: <span class="hljs-string">'handleMediaLibraryLinkClick'</span>,
			<span class="hljs-string">'click .select-media'</span>: <span class="hljs-string">'selectMedia'</span>,
			<span class="hljs-string">'click .edit-media'</span>: <span class="hljs-string">'editMedia'</span>
		},

		<span class="hljs-comment">/**
		 * Show display settings.
		 *
		 * @type {boolean}
		 */</span>
		showDisplaySettings: <span class="hljs-literal">true</span>,

		<span class="hljs-comment">/**
		 * Initialize.
		 *
		 * @param {Object}         options - Options.
		 * @param {Backbone.Model} options.model - Model.
		 * @param {jQuery}         options.el - Control container element.
		 * @returns {void}
		 */</span>
		initialize: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">initialize</span>(<span class="hljs-params"> options </span>) </span>{
			<span class="hljs-keyword">var</span> control = <span class="hljs-keyword">this</span>;

			Backbone.View.prototype.initialize.call( control, options );

			<span class="hljs-keyword">if</span> ( ! control.el ) {
				<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>( <span class="hljs-string">'Missing options.el'</span> );
			}
			<span class="hljs-keyword">if</span> ( ! ( control.model <span class="hljs-keyword">instanceof</span> component.MediaWidgetModel ) ) {
				<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>( <span class="hljs-string">'Missing options.model'</span> );
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>Allow methods to be passed in with control context preserved.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			_.bindAll( control, <span class="hljs-string">'syncModelToInputs'</span>, <span class="hljs-string">'render'</span>, <span class="hljs-string">'updateSelectedAttachment'</span>, <span class="hljs-string">'renderPreview'</span> );

			<span class="hljs-keyword">if</span> ( ! control.id_base ) {
				_.find( component.controlConstructors, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> Constructor, idBase </span>) </span>{
					<span class="hljs-keyword">if</span> ( control <span class="hljs-keyword">instanceof</span> Constructor ) {
						control.id_base = idBase;
						<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
					}
					<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
				});
				<span class="hljs-keyword">if</span> ( ! control.id_base ) {
					<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>( <span class="hljs-string">'Missing id_base.'</span> );
				}
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>Track attributes needed to renderPreview in its own model.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			control.previewTemplateProps = <span class="hljs-keyword">new</span> Backbone.Model( control.mapModelToPreviewTemplateProps() );</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>Re-render the preview when the attachment changes.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			control.selectedAttachment = <span class="hljs-keyword">new</span> wp.media.model.Attachment();
			control.renderPreview = _.debounce( control.renderPreview );
			control.listenTo( control.previewTemplateProps, <span class="hljs-string">'change'</span>, control.renderPreview );</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>Make sure a copy of the selected attachment is always fetched.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			control.model.on( <span class="hljs-string">'change:attachment_id'</span>, control.updateSelectedAttachment );
			control.model.on( <span class="hljs-string">'change:url'</span>, control.updateSelectedAttachment );
			control.updateSelectedAttachment();

			<span class="hljs-comment">/*
			 * Sync the widget instance model attributes onto the hidden inputs that widgets currently use to store the state.
			 * In the future, when widgets are JS-driven, the underlying widget instance data should be exposed as a model
			 * from the start, without having to sync with hidden fields. See &lt;https://core.trac.wordpress.org/ticket/33507&gt;.
			 */</span>
			control.listenTo( control.model, <span class="hljs-string">'change'</span>, control.syncModelToInputs );
			control.listenTo( control.model, <span class="hljs-string">'change'</span>, control.syncModelToPreviewProps );
			control.listenTo( control.model, <span class="hljs-string">'change'</span>, control.render );</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>Update the title.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			control.$el.on( <span class="hljs-string">'input change'</span>, <span class="hljs-string">'.title'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">updateTitle</span>(<span class="hljs-params"></span>) </span>{
				control.model.set({
					<span class="hljs-attr">title</span>: $.trim( $( <span class="hljs-keyword">this</span> ).val() )
				});
			});

			<span class="hljs-comment">/*
			 * Copy current display settings from the widget model to serve as basis
			 * of customized display settings for the current media frame session.
			 * Changes to display settings will be synced into this model, and
			 * when a new selection is made, the settings from this will be synced
			 * into that AttachmentDisplay's model to persist the setting changes.
			 */</span>
			control.displaySettings = <span class="hljs-keyword">new</span> Backbone.Model( _.pick(
				control.mapModelToMediaFrameProps(
					_.extend( control.model.defaults(), control.model.toJSON() )
				),
				_.keys( wp.media.view.settings.defaultProps )
			) );
		},

		<span class="hljs-comment">/**
		 * Update the selected attachment if necessary.
		 *
		 * @returns {void}
		 */</span>
		updateSelectedAttachment: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">updateSelectedAttachment</span>(<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">var</span> control = <span class="hljs-keyword">this</span>, attachment;

			<span class="hljs-keyword">if</span> ( <span class="hljs-number">0</span> === control.model.get( <span class="hljs-string">'attachment_id'</span> ) ) {
				control.selectedAttachment.clear();
				control.model.set( <span class="hljs-string">'error'</span>, <span class="hljs-literal">false</span> );
			} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( control.model.get( <span class="hljs-string">'attachment_id'</span> ) !== control.selectedAttachment.get( <span class="hljs-string">'id'</span> ) ) {
				attachment = <span class="hljs-keyword">new</span> wp.media.model.Attachment({
					<span class="hljs-attr">id</span>: control.model.get( <span class="hljs-string">'attachment_id'</span> )
				});
				attachment.fetch()
					.done( <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">done</span>(<span class="hljs-params"></span>) </span>{
						control.model.set( <span class="hljs-string">'error'</span>, <span class="hljs-literal">false</span> );
						control.selectedAttachment.set( attachment.toJSON() );
					})
					.fail( <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fail</span>(<span class="hljs-params"></span>) </span>{
						control.model.set( <span class="hljs-string">'error'</span>, <span class="hljs-string">'missing_attachment'</span> );
					});
			}
		},

		<span class="hljs-comment">/**
		 * Sync the model attributes to the hidden inputs, and update previewTemplateProps.
		 *
		 * @returns {void}
		 */</span>
		syncModelToPreviewProps: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">syncModelToPreviewProps</span>(<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">var</span> control = <span class="hljs-keyword">this</span>;
			control.previewTemplateProps.set( control.mapModelToPreviewTemplateProps() );
		},

		<span class="hljs-comment">/**
		 * Sync the model attributes to the hidden inputs, and update previewTemplateProps.
		 *
		 * @returns {void}
		 */</span>
		syncModelToInputs: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">syncModelToInputs</span>(<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">var</span> control = <span class="hljs-keyword">this</span>;
			control.$el.next( <span class="hljs-string">'.widget-content'</span> ).find( <span class="hljs-string">'.media-widget-instance-property'</span> ).each( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
				<span class="hljs-keyword">var</span> input = $( <span class="hljs-keyword">this</span> ), value;
				value = control.model.get( input.data( <span class="hljs-string">'property'</span> ) );
				<span class="hljs-keyword">if</span> ( _.isUndefined( value ) ) {
					<span class="hljs-keyword">return</span>;
				}
				value = <span class="hljs-built_in">String</span>( value );
				<span class="hljs-keyword">if</span> ( input.val() === value ) {
					<span class="hljs-keyword">return</span>;
				}
				input.val( value );
				input.trigger( <span class="hljs-string">'change'</span> );
			});
		},

		<span class="hljs-comment">/**
		 * Get template.
		 *
		 * @returns {Function} Template.
		 */</span>
		template: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">template</span>(<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">var</span> control = <span class="hljs-keyword">this</span>;
			<span class="hljs-keyword">if</span> ( ! $( <span class="hljs-string">'#tmpl-widget-media-'</span> + control.id_base + <span class="hljs-string">'-control'</span> ).length ) {
				<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>( <span class="hljs-string">'Missing widget control template for '</span> + control.id_base );
			}
			<span class="hljs-keyword">return</span> wp.template( <span class="hljs-string">'widget-media-'</span> + control.id_base + <span class="hljs-string">'-control'</span> );
		},

		<span class="hljs-comment">/**
		 * Render template.
		 *
		 * @returns {void}
		 */</span>
		render: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">render</span>(<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">var</span> control = <span class="hljs-keyword">this</span>, titleInput;

			<span class="hljs-keyword">if</span> ( ! control.templateRendered ) {
				control.$el.html( control.template()( control.model.toJSON() ) );
				control.renderPreview(); <span class="hljs-comment">// Hereafter it will re-render when control.selectedAttachment changes.</span>
				control.templateRendered = <span class="hljs-literal">true</span>;
			}

			titleInput = control.$el.find( <span class="hljs-string">'.title'</span> );
			<span class="hljs-keyword">if</span> ( ! titleInput.is( <span class="hljs-built_in">document</span>.activeElement ) ) {
				titleInput.val( control.model.get( <span class="hljs-string">'title'</span> ) );
			}

			control.$el.toggleClass( <span class="hljs-string">'selected'</span>, control.isSelected() );
		},

		<span class="hljs-comment">/**
		 * Render media preview.
		 *
		 * @abstract
		 * @returns {void}
		 */</span>
		renderPreview: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">renderPreview</span>(<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>( <span class="hljs-string">'renderPreview must be implemented'</span> );
		},

		<span class="hljs-comment">/**
		 * Whether a media item is selected.
		 *
		 * @returns {boolean} Whether selected and no error.
		 */</span>
		isSelected: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isSelected</span>(<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">var</span> control = <span class="hljs-keyword">this</span>;

			<span class="hljs-keyword">if</span> ( control.model.get( <span class="hljs-string">'error'</span> ) ) {
				<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
			}

			<span class="hljs-keyword">return</span> <span class="hljs-built_in">Boolean</span>( control.model.get( <span class="hljs-string">'attachment_id'</span> ) || control.model.get( <span class="hljs-string">'url'</span> ) );
		},

		<span class="hljs-comment">/**
		 * Handle click on link to Media Library to open modal, such as the link that appears when in the missing attachment error notice.
		 *
		 * @param {jQuery.Event} event - Event.
		 * @returns {void}
		 */</span>
		handleMediaLibraryLinkClick: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handleMediaLibraryLinkClick</span>(<span class="hljs-params"> event </span>) </span>{
			<span class="hljs-keyword">var</span> control = <span class="hljs-keyword">this</span>;
			event.preventDefault();
			control.selectMedia();
		},

		<span class="hljs-comment">/**
		 * Open the media select frame to chose an item.
		 *
		 * @returns {void}
		 */</span>
		selectMedia: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">selectMedia</span>(<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">var</span> control = <span class="hljs-keyword">this</span>, selection, mediaFrame, defaultSync, mediaFrameProps;

			<span class="hljs-keyword">if</span> ( control.isSelected() &amp;&amp; <span class="hljs-number">0</span> !== control.model.get( <span class="hljs-string">'attachment_id'</span> ) ) {
				selection = <span class="hljs-keyword">new</span> wp.media.model.Selection( [ control.selectedAttachment ] );
			} <span class="hljs-keyword">else</span> {
				selection = <span class="hljs-literal">null</span>;
			}

			mediaFrameProps = control.mapModelToMediaFrameProps( control.model.toJSON() );
			<span class="hljs-keyword">if</span> ( mediaFrameProps.size ) {
				control.displaySettings.set( <span class="hljs-string">'size'</span>, mediaFrameProps.size );
			}

			mediaFrame = <span class="hljs-keyword">new</span> component.MediaFrameSelect({
				<span class="hljs-attr">title</span>: control.l10n.add_media,
				<span class="hljs-attr">frame</span>: <span class="hljs-string">'post'</span>,
				<span class="hljs-attr">text</span>: control.l10n.add_to_widget,
				<span class="hljs-attr">selection</span>: selection,
				<span class="hljs-attr">mimeType</span>: control.mime_type,
				<span class="hljs-attr">selectedDisplaySettings</span>: control.displaySettings,
				<span class="hljs-attr">showDisplaySettings</span>: control.showDisplaySettings,
				<span class="hljs-attr">metadata</span>: mediaFrameProps,
				<span class="hljs-attr">state</span>: control.isSelected() &amp;&amp; <span class="hljs-number">0</span> === control.model.get( <span class="hljs-string">'attachment_id'</span> ) ? <span class="hljs-string">'embed'</span> : <span class="hljs-string">'insert'</span>,
				<span class="hljs-attr">invalidEmbedTypeError</span>: control.l10n.unsupported_file_type
			});
			wp.media.frame = mediaFrame; <span class="hljs-comment">// See wp.media().</span></pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>Handle selection of a media item.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			mediaFrame.on( <span class="hljs-string">'insert'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onInsert</span>(<span class="hljs-params"></span>) </span>{
				<span class="hljs-keyword">var</span> attachment = {}, state = mediaFrame.state();</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>Update cached attachment object to avoid having to re-fetch. This also triggers re-rendering of preview.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( <span class="hljs-string">'embed'</span> === state.get( <span class="hljs-string">'id'</span> ) ) {
					_.extend( attachment, { <span class="hljs-attr">id</span>: <span class="hljs-number">0</span> }, state.props.toJSON() );
				} <span class="hljs-keyword">else</span> {
					_.extend( attachment, state.get( <span class="hljs-string">'selection'</span> ).first().toJSON() );
				}

				control.selectedAttachment.set( attachment );
				control.model.set( <span class="hljs-string">'error'</span>, <span class="hljs-literal">false</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p>Update widget instance.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				control.model.set( control.getModelPropsFromMediaFrame( mediaFrame ) );
			});</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p>Disable syncing of attachment changes back to server. See <a href="https://core.trac.wordpress.org/ticket/40403">https://core.trac.wordpress.org/ticket/40403</a>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			defaultSync = wp.media.model.Attachment.prototype.sync;
			wp.media.model.Attachment.prototype.sync = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">rejectedSync</span>(<span class="hljs-params"></span>) </span>{
				<span class="hljs-keyword">return</span> $.Deferred().rejectWith( <span class="hljs-keyword">this</span> ).promise();
			};
			mediaFrame.on( <span class="hljs-string">'close'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onClose</span>(<span class="hljs-params"></span>) </span>{
				wp.media.model.Attachment.prototype.sync = defaultSync;
			});

			mediaFrame.$el.addClass( <span class="hljs-string">'media-widget'</span> );
			mediaFrame.open();</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <p>Clear the selected attachment when it is deleted in the media select frame.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( selection ) {
				selection.on( <span class="hljs-string">'destroy'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onDestroy</span>(<span class="hljs-params"> attachment </span>) </span>{
					<span class="hljs-keyword">if</span> ( control.model.get( <span class="hljs-string">'attachment_id'</span> ) === attachment.get( <span class="hljs-string">'id'</span> ) ) {
						control.model.set({
							<span class="hljs-attr">attachment_id</span>: <span class="hljs-number">0</span>,
							<span class="hljs-attr">url</span>: <span class="hljs-string">''</span>
						});
					}
				});
			}

			<span class="hljs-comment">/*
			 * Make sure focus is set inside of modal so that hitting Esc will close
			 * the modal and not inadvertently cause the widget to collapse in the customizer.
			 */</span>
			mediaFrame.$el.find( <span class="hljs-string">'.media-frame-menu .media-menu-item.active'</span> ).focus();
		},

		<span class="hljs-comment">/**
		 * Get the instance props from the media selection frame.
		 *
		 * @param {wp.media.view.MediaFrame.Select} mediaFrame - Select frame.
		 * @returns {Object} Props.
		 */</span>
		getModelPropsFromMediaFrame: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getModelPropsFromMediaFrame</span>(<span class="hljs-params"> mediaFrame </span>) </span>{
			<span class="hljs-keyword">var</span> control = <span class="hljs-keyword">this</span>, state, mediaFrameProps, modelProps;

			state = mediaFrame.state();
			<span class="hljs-keyword">if</span> ( <span class="hljs-string">'insert'</span> === state.get( <span class="hljs-string">'id'</span> ) ) {
				mediaFrameProps = state.get( <span class="hljs-string">'selection'</span> ).first().toJSON();
				mediaFrameProps.postUrl = mediaFrameProps.link;

				<span class="hljs-keyword">if</span> ( control.showDisplaySettings ) {
					_.extend(
						mediaFrameProps,
						mediaFrame.content.get( <span class="hljs-string">'.attachments-browser'</span> ).sidebar.get( <span class="hljs-string">'display'</span> ).model.toJSON()
					);
				}
				<span class="hljs-keyword">if</span> ( mediaFrameProps.sizes &amp;&amp; mediaFrameProps.size &amp;&amp; mediaFrameProps.sizes[ mediaFrameProps.size ] ) {
					mediaFrameProps.url = mediaFrameProps.sizes[ mediaFrameProps.size ].url;
				}
			} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( <span class="hljs-string">'embed'</span> === state.get( <span class="hljs-string">'id'</span> ) ) {
				mediaFrameProps = _.extend(
					state.props.toJSON(),
					{ <span class="hljs-attr">attachment_id</span>: <span class="hljs-number">0</span> }, <span class="hljs-comment">// Because some media frames use `attachment_id` not `id`.</span>
					control.model.getEmbedResetProps()
				);
			}  <span class="hljs-keyword">else</span> {
				<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>( <span class="hljs-string">'Unexpected state: '</span> + state.get( <span class="hljs-string">'id'</span> ) );
			}

			<span class="hljs-keyword">if</span> ( mediaFrameProps.id ) {
				mediaFrameProps.attachment_id = mediaFrameProps.id;
			}

			modelProps = control.mapMediaToModelProps( mediaFrameProps );</pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <p>Clear the extension prop so sources will be reset for video and audio media.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			_.each( wp.media.view.settings.embedExts, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> ext </span>) </span>{
				<span class="hljs-keyword">if</span> ( ext <span class="hljs-keyword">in</span> control.model.schema &amp;&amp; modelProps.url !== modelProps[ ext ] ) {
					modelProps[ ext ] = <span class="hljs-string">''</span>;
				}
			} );

			<span class="hljs-keyword">return</span> modelProps;
		},

		<span class="hljs-comment">/**
		 * Map media frame props to model props.
		 *
		 * @param {Object} mediaFrameProps - Media frame props.
		 * @returns {Object} Model props.
		 */</span>
		mapMediaToModelProps: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">mapMediaToModelProps</span>(<span class="hljs-params"> mediaFrameProps </span>) </span>{
			<span class="hljs-keyword">var</span> control = <span class="hljs-keyword">this</span>, mediaFramePropToModelPropMap = {}, modelProps = {}, extension;
			_.each( control.model.schema, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> fieldSchema, modelProp </span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <p>Ignore widget title attribute.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( <span class="hljs-string">'title'</span> === modelProp ) {
					<span class="hljs-keyword">return</span>;
				}
				mediaFramePropToModelPropMap[ fieldSchema.media_prop || modelProp ] = modelProp;
			});

			_.each( mediaFrameProps, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> value, mediaProp </span>) </span>{
				<span class="hljs-keyword">var</span> propName = mediaFramePropToModelPropMap[ mediaProp ] || mediaProp;
				<span class="hljs-keyword">if</span> ( control.model.schema[ propName ] ) {
					modelProps[ propName ] = value;
				}
			});

			<span class="hljs-keyword">if</span> ( <span class="hljs-string">'custom'</span> === mediaFrameProps.size ) {
				modelProps.width = mediaFrameProps.customWidth;
				modelProps.height = mediaFrameProps.customHeight;
			}

			<span class="hljs-keyword">if</span> ( <span class="hljs-string">'post'</span> === mediaFrameProps.link ) {
				modelProps.link_url = mediaFrameProps.postUrl;
			} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( <span class="hljs-string">'file'</span> === mediaFrameProps.link ) {
				modelProps.link_url = mediaFrameProps.url;
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <p>Because some media frames use <code>id</code> instead of <code>attachment_id</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( ! mediaFrameProps.attachment_id &amp;&amp; mediaFrameProps.id ) {
				modelProps.attachment_id = mediaFrameProps.id;
			}

			<span class="hljs-keyword">if</span> ( mediaFrameProps.url ) {
				extension = mediaFrameProps.url.replace( <span class="hljs-regexp">/#.*$/</span>, <span class="hljs-string">''</span> ).replace( <span class="hljs-regexp">/\?.*$/</span>, <span class="hljs-string">''</span> ).split( <span class="hljs-string">'.'</span> ).pop().toLowerCase();
				<span class="hljs-keyword">if</span> ( extension <span class="hljs-keyword">in</span> control.model.schema ) {
					modelProps[ extension ] = mediaFrameProps.url;
				}
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p>Always omit the titles derived from mediaFrameProps.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">return</span> _.omit( modelProps, <span class="hljs-string">'title'</span> );
		},

		<span class="hljs-comment">/**
		 * Map model props to media frame props.
		 *
		 * @param {Object} modelProps - Model props.
		 * @returns {Object} Media frame props.
		 */</span>
		mapModelToMediaFrameProps: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">mapModelToMediaFrameProps</span>(<span class="hljs-params"> modelProps </span>) </span>{
			<span class="hljs-keyword">var</span> control = <span class="hljs-keyword">this</span>, mediaFrameProps = {};

			_.each( modelProps, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> value, modelProp </span>) </span>{
				<span class="hljs-keyword">var</span> fieldSchema = control.model.schema[ modelProp ] || {};
				mediaFrameProps[ fieldSchema.media_prop || modelProp ] = value;
			});</pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <p>Some media frames use attachment_id.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			mediaFrameProps.attachment_id = mediaFrameProps.id;

			<span class="hljs-keyword">if</span> ( <span class="hljs-string">'custom'</span> === mediaFrameProps.size ) {
				mediaFrameProps.customWidth = control.model.get( <span class="hljs-string">'width'</span> );
				mediaFrameProps.customHeight = control.model.get( <span class="hljs-string">'height'</span> );
			}

			<span class="hljs-keyword">return</span> mediaFrameProps;
		},

		<span class="hljs-comment">/**
		 * Map model props to previewTemplateProps.
		 *
		 * @returns {Object} Preview Template Props.
		 */</span>
		mapModelToPreviewTemplateProps: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">mapModelToPreviewTemplateProps</span>(<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">var</span> control = <span class="hljs-keyword">this</span>, previewTemplateProps = {};
			_.each( control.model.schema, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> value, prop </span>) </span>{
				<span class="hljs-keyword">if</span> ( ! value.hasOwnProperty( <span class="hljs-string">'should_preview_update'</span> ) || value.should_preview_update ) {
					previewTemplateProps[ prop ] = control.model.get( prop );
				}
			});</pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <p>Templates need to be aware of the error.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			previewTemplateProps.error = control.model.get( <span class="hljs-string">'error'</span> );
			<span class="hljs-keyword">return</span> previewTemplateProps;
		},

		<span class="hljs-comment">/**
		 * Open the media frame to modify the selected item.
		 *
		 * @abstract
		 * @returns {void}
		 */</span>
		editMedia: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">editMedia</span>(<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>( <span class="hljs-string">'editMedia not implemented'</span> );
		}
	});

	<span class="hljs-comment">/**
	 * Media widget model.
	 *
	 * @class MediaWidgetModel
	 * @constructor
	 */</span>
	component.MediaWidgetModel = Backbone.Model.extend({

		<span class="hljs-comment">/**
		 * Id attribute.
		 *
		 * @type {string}
		 */</span>
		idAttribute: <span class="hljs-string">'widget_id'</span>,

		<span class="hljs-comment">/**
		 * Instance schema.
		 *
		 * This adheres to JSON Schema and subclasses should have their schema
		 * exported from PHP to JS such as is done in WP_Widget_Media_Image::enqueue_admin_scripts().
		 *
		 * @type {Object.&lt;string, Object&gt;}
		 */</span>
		schema: {
			<span class="hljs-attr">title</span>: {
				<span class="hljs-attr">type</span>: <span class="hljs-string">'string'</span>,
				<span class="hljs-string">'default'</span>: <span class="hljs-string">''</span>
			},
			<span class="hljs-attr">attachment_id</span>: {
				<span class="hljs-attr">type</span>: <span class="hljs-string">'integer'</span>,
				<span class="hljs-string">'default'</span>: <span class="hljs-number">0</span>
			},
			<span class="hljs-attr">url</span>: {
				<span class="hljs-attr">type</span>: <span class="hljs-string">'string'</span>,
				<span class="hljs-string">'default'</span>: <span class="hljs-string">''</span>
			}
		},

		<span class="hljs-comment">/**
		 * Get default attribute values.
		 *
		 * @returns {Object} Mapping of property names to their default values.
		 */</span>
		defaults: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">var</span> defaults = {};
			_.each( <span class="hljs-keyword">this</span>.schema, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> fieldSchema, field </span>) </span>{
				defaults[ field ] = fieldSchema[<span class="hljs-string">'default'</span>];
			});
			<span class="hljs-keyword">return</span> defaults;
		},

		<span class="hljs-comment">/**
		 * Set attribute value(s).
		 *
		 * This is a wrapped version of Backbone.Model#set() which allows us to
		 * cast the attribute values from the hidden inputs' string values into
		 * the appropriate data types (integers or booleans).
		 *
		 * @param {string|Object} key - Attribute name or attribute pairs.
		 * @param {mixed|Object}  [val] - Attribute value or options object.
		 * @param {Object}        [options] - Options when attribute name and value are passed separately.
		 * @returns {wp.mediaWidgets.MediaWidgetModel} This model.
		 */</span>
		set: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">set</span>(<span class="hljs-params"> key, val, options </span>) </span>{
			<span class="hljs-keyword">var</span> model = <span class="hljs-keyword">this</span>, attrs, opts, castedAttrs; <span class="hljs-comment">// eslint-disable-line consistent-this</span>
			<span class="hljs-keyword">if</span> ( <span class="hljs-literal">null</span> === key ) {
				<span class="hljs-keyword">return</span> model;
			}
			<span class="hljs-keyword">if</span> ( <span class="hljs-string">'object'</span> === <span class="hljs-keyword">typeof</span> key ) {
				attrs = key;
				opts = val;
			} <span class="hljs-keyword">else</span> {
				attrs = {};
				attrs[ key ] = val;
				opts = options;
			}

			castedAttrs = {};
			_.each( attrs, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> value, name </span>) </span>{
				<span class="hljs-keyword">var</span> type;
				<span class="hljs-keyword">if</span> ( ! model.schema[ name ] ) {
					castedAttrs[ name ] = value;
					<span class="hljs-keyword">return</span>;
				}
				type = model.schema[ name ].type;
				<span class="hljs-keyword">if</span> ( <span class="hljs-string">'integer'</span> === type ) {
					castedAttrs[ name ] = <span class="hljs-built_in">parseInt</span>( value, <span class="hljs-number">10</span> );
				} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( <span class="hljs-string">'boolean'</span> === type ) {
					castedAttrs[ name ] = ! ( ! value || <span class="hljs-string">'0'</span> === value || <span class="hljs-string">'false'</span> === value );
				} <span class="hljs-keyword">else</span> {
					castedAttrs[ name ] = value;
				}
			});

			<span class="hljs-keyword">return</span> Backbone.Model.prototype.set.call( <span class="hljs-keyword">this</span>, castedAttrs, opts );
		},

		<span class="hljs-comment">/**
		 * Get props which are merged on top of the model when an embed is chosen (as opposed to an attachment).
		 *
		 * @returns {Object} Reset/override props.
		 */</span>
		getEmbedResetProps: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getEmbedResetProps</span>(<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">return</span> {
				<span class="hljs-attr">id</span>: <span class="hljs-number">0</span>
			};
		}
	});

	<span class="hljs-comment">/**
	 * Collection of all widget model instances.
	 *
	 * @type {Backbone.Collection}
	 */</span>
	component.modelCollection = <span class="hljs-keyword">new</span> ( Backbone.Collection.extend({
		<span class="hljs-attr">model</span>: component.MediaWidgetModel
	}) )();

	<span class="hljs-comment">/**
	 * Mapping of widget ID to instances of MediaWidgetControl subclasses.
	 *
	 * @type {Object.&lt;string, wp.mediaWidgets.MediaWidgetControl&gt;}
	 */</span>
	component.widgetControls = {};

	<span class="hljs-comment">/**
	 * Handle widget being added or initialized for the first time at the widget-added event.
	 *
	 * @param {jQuery.Event} event - Event.
	 * @param {jQuery}       widgetContainer - Widget container element.
	 * @returns {void}
	 */</span>
	component.handleWidgetAdded = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handleWidgetAdded</span>(<span class="hljs-params"> event, widgetContainer </span>) </span>{
		<span class="hljs-keyword">var</span> widgetContent, controlContainer, widgetForm, idBase, ControlConstructor, ModelConstructor, modelAttributes, widgetControl, widgetModel, widgetId, widgetInside, animatedCheckDelay = <span class="hljs-number">50</span>, renderWhenAnimationDone;
		widgetForm = widgetContainer.find( <span class="hljs-string">'&gt; .widget-inside &gt; .form, &gt; .widget-inside &gt; form'</span> ); <span class="hljs-comment">// Note: '.form' appears in the customizer, whereas 'form' on the widgets admin screen.</span>
		widgetContent = widgetForm.find( <span class="hljs-string">'&gt; .widget-content'</span> );
		idBase = widgetForm.find( <span class="hljs-string">'&gt; .id_base'</span> ).val();
		widgetId = widgetForm.find( <span class="hljs-string">'&gt; .widget-id'</span> ).val();</pre></div></div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <p>Prevent initializing already-added widgets.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( component.widgetControls[ widgetId ] ) {
			<span class="hljs-keyword">return</span>;
		}

		ControlConstructor = component.controlConstructors[ idBase ];
		<span class="hljs-keyword">if</span> ( ! ControlConstructor ) {
			<span class="hljs-keyword">return</span>;
		}

		ModelConstructor = component.modelConstructors[ idBase ] || component.MediaWidgetModel;

		<span class="hljs-comment">/*
		 * Create a container element for the widget control (Backbone.View).
		 * This is inserted into the DOM immediately before the the .widget-content
		 * element because the contents of this element are essentially "managed"
		 * by PHP, where each widget update cause the entire element to be emptied
		 * and replaced with the rendered output of WP_Widget::form() which is
		 * sent back in Ajax request made to save/update the widget instance.
		 * To prevent a "flash of replaced DOM elements and re-initialized JS
		 * components", the JS template is rendered outside of the normal form
		 * container.
		 */</span>
		controlContainer = $( <span class="hljs-string">'&lt;div class="media-widget-control"&gt;&lt;/div&gt;'</span> );
		widgetContent.before( controlContainer );

		<span class="hljs-comment">/*
		 * Sync the widget instance model attributes onto the hidden inputs that widgets currently use to store the state.
		 * In the future, when widgets are JS-driven, the underlying widget instance data should be exposed as a model
		 * from the start, without having to sync with hidden fields. See &lt;https://core.trac.wordpress.org/ticket/33507&gt;.
		 */</span>
		modelAttributes = {};
		widgetContent.find( <span class="hljs-string">'.media-widget-instance-property'</span> ).each( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">var</span> input = $( <span class="hljs-keyword">this</span> );
			modelAttributes[ input.data( <span class="hljs-string">'property'</span> ) ] = input.val();
		});
		modelAttributes.widget_id = widgetId;

		widgetModel = <span class="hljs-keyword">new</span> ModelConstructor( modelAttributes );

		widgetControl = <span class="hljs-keyword">new</span> ControlConstructor({
			<span class="hljs-attr">el</span>: controlContainer,
			<span class="hljs-attr">model</span>: widgetModel
		});

		<span class="hljs-comment">/*
		 * Render the widget once the widget parent's container finishes animating,
		 * as the widget-added event fires with a slideDown of the container.
		 * This ensures that the container's dimensions are fixed so that ME.js
		 * can initialize with the proper dimensions.
		 */</span>
		widgetInside = widgetContainer.parent();
		renderWhenAnimationDone = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">if</span> ( widgetInside.is( <span class="hljs-string">':animated'</span> ) ) {
				setTimeout( renderWhenAnimationDone, animatedCheckDelay );
			} <span class="hljs-keyword">else</span> {
				widgetControl.render();
			}
		};
		renderWhenAnimationDone();

		<span class="hljs-comment">/*
		 * Note that the model and control currently won't ever get garbage-collected
		 * when a widget gets removed/deleted because there is no widget-removed event.
		 */</span>
		component.modelCollection.add( [ widgetModel ] );
		component.widgetControls[ widgetModel.get( <span class="hljs-string">'widget_id'</span> ) ] = widgetControl;
	};

	<span class="hljs-comment">/**
	 * Sync widget instance data sanitized from server back onto widget model.
	 *
	 * This gets called via the 'widget-updated' event when saving a widget from
	 * the widgets admin screen and also via the 'widget-synced' event when making
	 * a change to a widget in the customizer.
	 *
	 * @param {jQuery.Event} event - Event.
	 * @param {jQuery}       widgetContainer - Widget container element.
	 * @returns {void}
	 */</span>
	component.handleWidgetUpdated = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handleWidgetUpdated</span>(<span class="hljs-params"> event, widgetContainer </span>) </span>{
		<span class="hljs-keyword">var</span> widgetForm, widgetContent, widgetId, widgetControl, attributes = {};
		widgetForm = widgetContainer.find( <span class="hljs-string">'&gt; .widget-inside &gt; .form, &gt; .widget-inside &gt; form'</span> );
		widgetId = widgetForm.find( <span class="hljs-string">'&gt; .widget-id'</span> ).val();

		widgetControl = component.widgetControls[ widgetId ];
		<span class="hljs-keyword">if</span> ( ! widgetControl ) {
			<span class="hljs-keyword">return</span>;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <p>Make sure the server-sanitized values get synced back into the model.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		widgetContent = widgetForm.find( <span class="hljs-string">'&gt; .widget-content'</span> );
		widgetContent.find( <span class="hljs-string">'.media-widget-instance-property'</span> ).each( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">var</span> property = $( <span class="hljs-keyword">this</span> ).data( <span class="hljs-string">'property'</span> );
			attributes[ property ] = $( <span class="hljs-keyword">this</span> ).val();
		});</pre></div></div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <p>Suspend syncing model back to inputs when syncing from inputs to model, preventing infinite loop.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		widgetControl.stopListening( widgetControl.model, <span class="hljs-string">'change'</span>, widgetControl.syncModelToInputs );
		widgetControl.model.set( attributes );
		widgetControl.listenTo( widgetControl.model, <span class="hljs-string">'change'</span>, widgetControl.syncModelToInputs );
	};

	<span class="hljs-comment">/**
	 * Initialize functionality.
	 *
	 * This function exists to prevent the JS file from having to boot itself.
	 * When WordPress enqueues this script, it should have an inline script
	 * attached which calls wp.mediaWidgets.init().
	 *
	 * @returns {void}
	 */</span>
	component.init = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">init</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> $<span class="hljs-built_in">document</span> = $( <span class="hljs-built_in">document</span> );
		$<span class="hljs-built_in">document</span>.on( <span class="hljs-string">'widget-added'</span>, component.handleWidgetAdded );
		$<span class="hljs-built_in">document</span>.on( <span class="hljs-string">'widget-synced widget-updated'</span>, component.handleWidgetUpdated );

		<span class="hljs-comment">/*
		 * Manually trigger widget-added events for media widgets on the admin
		 * screen once they are expanded. The widget-added event is not triggered
		 * for each pre-existing widget on the widgets admin screen like it is
		 * on the customizer. Likewise, the customizer only triggers widget-added
		 * when the widget is expanded to just-in-time construct the widget form
		 * when it is actually going to be displayed. So the following implements
		 * the same for the widgets admin screen, to invoke the widget-added
		 * handler when a pre-existing media widget is expanded.
		 */</span>
		$( <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">initializeExistingWidgetContainers</span>(<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">var</span> widgetContainers;
			<span class="hljs-keyword">if</span> ( <span class="hljs-string">'widgets'</span> !== <span class="hljs-built_in">window</span>.pagenow ) {
				<span class="hljs-keyword">return</span>;
			}
			widgetContainers = $( <span class="hljs-string">'.widgets-holder-wrap:not(#available-widgets)'</span> ).find( <span class="hljs-string">'div.widget'</span> );
			widgetContainers.one( <span class="hljs-string">'click.toggle-widget-expanded'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toggleWidgetExpanded</span>(<span class="hljs-params"></span>) </span>{
				<span class="hljs-keyword">var</span> widgetContainer = $( <span class="hljs-keyword">this</span> );
				component.handleWidgetAdded( <span class="hljs-keyword">new</span> jQuery.Event( <span class="hljs-string">'widget-added'</span> ), widgetContainer );
			});
		});
	};

	<span class="hljs-keyword">return</span> component;
})( jQuery );</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
