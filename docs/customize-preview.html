<!DOCTYPE html>

<html>
<head>
  <title>customize-preview.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page_wrapper">
            <div id="jump_page">
              
                
                <a class="source" href="accordion.html">
                  accordion.js
                </a>
              
                
                <a class="source" href="bookmarklet.html">
                  bookmarklet.js
                </a>
              
                
                <a class="source" href="bookmarklet.min.html">
                  bookmarklet.min.js
                </a>
              
                
                <a class="source" href="color-picker.html">
                  color-picker.js
                </a>
              
                
                <a class="source" href="comment.html">
                  comment.js
                </a>
              
                
                <a class="source" href="common.html">
                  common.js
                </a>
              
                
                <a class="source" href="custom-background.html">
                  custom-background.js
                </a>
              
                
                <a class="source" href="custom-header.html">
                  custom-header.js
                </a>
              
                
                <a class="source" href="customize-controls.html">
                  customize-controls.js
                </a>
              
                
                <a class="source" href="customize-nav-menus.html">
                  customize-nav-menus.js
                </a>
              
                
                <a class="source" href="customize-widgets.html">
                  customize-widgets.js
                </a>
              
                
                <a class="source" href="dashboard.html">
                  dashboard.js
                </a>
              
                
                <a class="source" href="edit-comments.html">
                  edit-comments.js
                </a>
              
                
                <a class="source" href="editor-expand.html">
                  editor-expand.js
                </a>
              
                
                <a class="source" href="editor.html">
                  editor.js
                </a>
              
                
                <a class="source" href="farbtastic.html">
                  farbtastic.js
                </a>
              
                
                <a class="source" href="gallery.html">
                  gallery.js
                </a>
              
                
                <a class="source" href="image-edit.html">
                  image-edit.js
                </a>
              
                
                <a class="source" href="inline-edit-post.html">
                  inline-edit-post.js
                </a>
              
                
                <a class="source" href="inline-edit-tax.html">
                  inline-edit-tax.js
                </a>
              
                
                <a class="source" href="iris.min.html">
                  iris.min.js
                </a>
              
                
                <a class="source" href="language-chooser.html">
                  language-chooser.js
                </a>
              
                
                <a class="source" href="link.html">
                  link.js
                </a>
              
                
                <a class="source" href="media-gallery.html">
                  media-gallery.js
                </a>
              
                
                <a class="source" href="media-upload.html">
                  media-upload.js
                </a>
              
                
                <a class="source" href="media.html">
                  media.js
                </a>
              
                
                <a class="source" href="nav-menu.html">
                  nav-menu.js
                </a>
              
                
                <a class="source" href="password-strength-meter.html">
                  password-strength-meter.js
                </a>
              
                
                <a class="source" href="plugin-install.html">
                  plugin-install.js
                </a>
              
                
                <a class="source" href="post.html">
                  post.js
                </a>
              
                
                <a class="source" href="postbox.html">
                  postbox.js
                </a>
              
                
                <a class="source" href="press-this.html">
                  press-this.js
                </a>
              
                
                <a class="source" href="revisions.html">
                  revisions.js
                </a>
              
                
                <a class="source" href="set-post-thumbnail.html">
                  set-post-thumbnail.js
                </a>
              
                
                <a class="source" href="svg-painter.html">
                  svg-painter.js
                </a>
              
                
                <a class="source" href="tags-box.html">
                  tags-box.js
                </a>
              
                
                <a class="source" href="tags-suggest.html">
                  tags-suggest.js
                </a>
              
                
                <a class="source" href="tags.html">
                  tags.js
                </a>
              
                
                <a class="source" href="theme.html">
                  theme.js
                </a>
              
                
                <a class="source" href="updates.html">
                  updates.js
                </a>
              
                
                <a class="source" href="user-profile.html">
                  user-profile.js
                </a>
              
                
                <a class="source" href="user-suggest.html">
                  user-suggest.js
                </a>
              
                
                <a class="source" href="widgets.html">
                  widgets.js
                </a>
              
                
                <a class="source" href="media-audio-widget.html">
                  media-audio-widget.js
                </a>
              
                
                <a class="source" href="media-image-widget.html">
                  media-image-widget.js
                </a>
              
                
                <a class="source" href="media-video-widget.html">
                  media-video-widget.js
                </a>
              
                
                <a class="source" href="media-widgets.html">
                  media-widgets.js
                </a>
              
                
                <a class="source" href="text-widgets.html">
                  text-widgets.js
                </a>
              
                
                <a class="source" href="word-count.html">
                  word-count.js
                </a>
              
                
                <a class="source" href="wp-fullscreen-stub.html">
                  wp-fullscreen-stub.js
                </a>
              
                
                <a class="source" href="xfn.html">
                  xfn.js
                </a>
              
                
                <a class="source" href="theme-customizer.html">
                  theme-customizer.js
                </a>
              
                
                <a class="source" href="theme-options.html">
                  theme-options.js
                </a>
              
                
                <a class="source" href="html5.html">
                  html5.js
                </a>
              
                
                <a class="source" href="showcase.html">
                  showcase.js
                </a>
              
                
                <a class="source" href="color-scheme-control.html">
                  color-scheme-control.js
                </a>
              
                
                <a class="source" href="customize-preview.html">
                  customize-preview.js
                </a>
              
                
                <a class="source" href="functions.html">
                  functions.js
                </a>
              
                
                <a class="source" href="html5.html">
                  html5.js
                </a>
              
                
                <a class="source" href="keyboard-image-navigation.html">
                  keyboard-image-navigation.js
                </a>
              
                
                <a class="source" href="skip-link-focus-fix.html">
                  skip-link-focus-fix.js
                </a>
              
                
                <a class="source" href="customizer.html">
                  customizer.js
                </a>
              
                
                <a class="source" href="featured-content-admin.html">
                  featured-content-admin.js
                </a>
              
                
                <a class="source" href="functions.html">
                  functions.js
                </a>
              
                
                <a class="source" href="html5.html">
                  html5.js
                </a>
              
                
                <a class="source" href="keyboard-image-navigation.html">
                  keyboard-image-navigation.js
                </a>
              
                
                <a class="source" href="slider.html">
                  slider.js
                </a>
              
                
                <a class="source" href="customize-controls.html">
                  customize-controls.js
                </a>
              
                
                <a class="source" href="customize-preview.html">
                  customize-preview.js
                </a>
              
                
                <a class="source" href="global.html">
                  global.js
                </a>
              
                
                <a class="source" href="html5.html">
                  html5.js
                </a>
              
                
                <a class="source" href="jquery.scrollTo.html">
                  jquery.scrollTo.js
                </a>
              
                
                <a class="source" href="navigation.html">
                  navigation.js
                </a>
              
                
                <a class="source" href="skip-link-focus-fix.html">
                  skip-link-focus-fix.js
                </a>
              
                
                <a class="source" href="functions.html">
                  functions.js
                </a>
              
                
                <a class="source" href="html5.html">
                  html5.js
                </a>
              
                
                <a class="source" href="theme-customizer.html">
                  theme-customizer.js
                </a>
              
                
                <a class="source" href="html5.html">
                  html5.js
                </a>
              
                
                <a class="source" href="navigation.html">
                  navigation.js
                </a>
              
                
                <a class="source" href="theme-customizer.html">
                  theme-customizer.js
                </a>
              
                
                <a class="source" href="admin-bar.html">
                  admin-bar.js
                </a>
              
                
                <a class="source" href="autosave.html">
                  autosave.js
                </a>
              
                
                <a class="source" href="backbone.html">
                  backbone.js
                </a>
              
                
                <a class="source" href="backbone.min.html">
                  backbone.min.js
                </a>
              
                
                <a class="source" href="colorpicker.html">
                  colorpicker.js
                </a>
              
                
                <a class="source" href="comment-reply.html">
                  comment-reply.js
                </a>
              
                
                <a class="source" href="cropper.html">
                  cropper.js
                </a>
              
                
                <a class="source" href="customize-base.html">
                  customize-base.js
                </a>
              
                
                <a class="source" href="customize-loader.html">
                  customize-loader.js
                </a>
              
                
                <a class="source" href="customize-models.html">
                  customize-models.js
                </a>
              
                
                <a class="source" href="customize-preview-nav-menus.html">
                  customize-preview-nav-menus.js
                </a>
              
                
                <a class="source" href="customize-preview-widgets.html">
                  customize-preview-widgets.js
                </a>
              
                
                <a class="source" href="customize-preview.html">
                  customize-preview.js
                </a>
              
                
                <a class="source" href="customize-selective-refresh.html">
                  customize-selective-refresh.js
                </a>
              
                
                <a class="source" href="customize-views.html">
                  customize-views.js
                </a>
              
                
                <a class="source" href="heartbeat.html">
                  heartbeat.js
                </a>
              
                
                <a class="source" href="hoverIntent.html">
                  hoverIntent.js
                </a>
              
                
                <a class="source" href="imagesloaded.min.html">
                  imagesloaded.min.js
                </a>
              
                
                <a class="source" href="jquery.imgareaselect.html">
                  jquery.imgareaselect.js
                </a>
              
                
                <a class="source" href="jquery.imgareaselect.min.html">
                  jquery.imgareaselect.min.js
                </a>
              
                
                <a class="source" href="jquery.Jcrop.min.html">
                  jquery.Jcrop.min.js
                </a>
              
                
                <a class="source" href="jquery-migrate.html">
                  jquery-migrate.js
                </a>
              
                
                <a class="source" href="jquery-migrate.min.html">
                  jquery-migrate.min.js
                </a>
              
                
                <a class="source" href="jquery.color.min.html">
                  jquery.color.min.js
                </a>
              
                
                <a class="source" href="jquery.form.html">
                  jquery.form.js
                </a>
              
                
                <a class="source" href="jquery.form.min.html">
                  jquery.form.min.js
                </a>
              
                
                <a class="source" href="jquery.hotkeys.html">
                  jquery.hotkeys.js
                </a>
              
                
                <a class="source" href="jquery.hotkeys.min.html">
                  jquery.hotkeys.min.js
                </a>
              
                
                <a class="source" href="jquery.html">
                  jquery.js
                </a>
              
                
                <a class="source" href="jquery.masonry.html">
                  jquery.masonry.js
                </a>
              
                
                <a class="source" href="jquery.masonry.min.html">
                  jquery.masonry.min.js
                </a>
              
                
                <a class="source" href="jquery.query.html">
                  jquery.query.js
                </a>
              
                
                <a class="source" href="jquery.schedule.html">
                  jquery.schedule.js
                </a>
              
                
                <a class="source" href="jquery.serialize-object.html">
                  jquery.serialize-object.js
                </a>
              
                
                <a class="source" href="jquery.table-hotkeys.html">
                  jquery.table-hotkeys.js
                </a>
              
                
                <a class="source" href="jquery.table-hotkeys.min.html">
                  jquery.table-hotkeys.min.js
                </a>
              
                
                <a class="source" href="jquery.ui.touch-punch.html">
                  jquery.ui.touch-punch.js
                </a>
              
                
                <a class="source" href="suggest.html">
                  suggest.js
                </a>
              
                
                <a class="source" href="suggest.min.html">
                  suggest.min.js
                </a>
              
                
                <a class="source" href="accordion.html">
                  accordion.js
                </a>
              
                
                <a class="source" href="autocomplete.html">
                  autocomplete.js
                </a>
              
                
                <a class="source" href="button.html">
                  button.js
                </a>
              
                
                <a class="source" href="core.html">
                  core.js
                </a>
              
                
                <a class="source" href="datepicker.html">
                  datepicker.js
                </a>
              
                
                <a class="source" href="dialog.html">
                  dialog.js
                </a>
              
                
                <a class="source" href="draggable.html">
                  draggable.js
                </a>
              
                
                <a class="source" href="droppable.html">
                  droppable.js
                </a>
              
                
                <a class="source" href="effect-blind.html">
                  effect-blind.js
                </a>
              
                
                <a class="source" href="effect-bounce.html">
                  effect-bounce.js
                </a>
              
                
                <a class="source" href="effect-clip.html">
                  effect-clip.js
                </a>
              
                
                <a class="source" href="effect-drop.html">
                  effect-drop.js
                </a>
              
                
                <a class="source" href="effect-explode.html">
                  effect-explode.js
                </a>
              
                
                <a class="source" href="effect-fade.html">
                  effect-fade.js
                </a>
              
                
                <a class="source" href="effect-fold.html">
                  effect-fold.js
                </a>
              
                
                <a class="source" href="effect-highlight.html">
                  effect-highlight.js
                </a>
              
                
                <a class="source" href="effect-puff.html">
                  effect-puff.js
                </a>
              
                
                <a class="source" href="effect-pulsate.html">
                  effect-pulsate.js
                </a>
              
                
                <a class="source" href="effect-scale.html">
                  effect-scale.js
                </a>
              
                
                <a class="source" href="effect-shake.html">
                  effect-shake.js
                </a>
              
                
                <a class="source" href="effect-size.html">
                  effect-size.js
                </a>
              
                
                <a class="source" href="effect-slide.html">
                  effect-slide.js
                </a>
              
                
                <a class="source" href="effect-transfer.html">
                  effect-transfer.js
                </a>
              
                
                <a class="source" href="effect.html">
                  effect.js
                </a>
              
                
                <a class="source" href="menu.html">
                  menu.js
                </a>
              
                
                <a class="source" href="mouse.html">
                  mouse.js
                </a>
              
                
                <a class="source" href="position.html">
                  position.js
                </a>
              
                
                <a class="source" href="progressbar.html">
                  progressbar.js
                </a>
              
                
                <a class="source" href="resizable.html">
                  resizable.js
                </a>
              
                
                <a class="source" href="selectable.html">
                  selectable.js
                </a>
              
                
                <a class="source" href="selectmenu.html">
                  selectmenu.js
                </a>
              
                
                <a class="source" href="slider.html">
                  slider.js
                </a>
              
                
                <a class="source" href="sortable.html">
                  sortable.js
                </a>
              
                
                <a class="source" href="spinner.html">
                  spinner.js
                </a>
              
                
                <a class="source" href="tabs.html">
                  tabs.js
                </a>
              
                
                <a class="source" href="tooltip.html">
                  tooltip.js
                </a>
              
                
                <a class="source" href="widget.html">
                  widget.js
                </a>
              
                
                <a class="source" href="json2.html">
                  json2.js
                </a>
              
                
                <a class="source" href="masonry.min.html">
                  masonry.min.js
                </a>
              
                
                <a class="source" href="mce-view.html">
                  mce-view.js
                </a>
              
                
                <a class="source" href="media-audiovideo.html">
                  media-audiovideo.js
                </a>
              
                
                <a class="source" href="media-editor.html">
                  media-editor.js
                </a>
              
                
                <a class="source" href="media-grid.html">
                  media-grid.js
                </a>
              
                
                <a class="source" href="media-models.html">
                  media-models.js
                </a>
              
                
                <a class="source" href="media-views.html">
                  media-views.js
                </a>
              
                
                <a class="source" href="audiovideo.manifest.html">
                  audiovideo.manifest.js
                </a>
              
                
                <a class="source" href="audio-details.html">
                  audio-details.js
                </a>
              
                
                <a class="source" href="collection-add.html">
                  collection-add.js
                </a>
              
                
                <a class="source" href="collection-edit.html">
                  collection-edit.js
                </a>
              
                
                <a class="source" href="cropper.html">
                  cropper.js
                </a>
              
                
                <a class="source" href="customize-image-cropper.html">
                  customize-image-cropper.js
                </a>
              
                
                <a class="source" href="edit-attachment-metadata.html">
                  edit-attachment-metadata.js
                </a>
              
                
                <a class="source" href="edit-image.html">
                  edit-image.js
                </a>
              
                
                <a class="source" href="embed.html">
                  embed.js
                </a>
              
                
                <a class="source" href="featured-image.html">
                  featured-image.js
                </a>
              
                
                <a class="source" href="gallery-add.html">
                  gallery-add.js
                </a>
              
                
                <a class="source" href="gallery-edit.html">
                  gallery-edit.js
                </a>
              
                
                <a class="source" href="image-details.html">
                  image-details.js
                </a>
              
                
                <a class="source" href="library.html">
                  library.js
                </a>
              
                
                <a class="source" href="media-library.html">
                  media-library.js
                </a>
              
                
                <a class="source" href="region.html">
                  region.js
                </a>
              
                
                <a class="source" href="replace-image.html">
                  replace-image.js
                </a>
              
                
                <a class="source" href="site-icon-cropper.html">
                  site-icon-cropper.js
                </a>
              
                
                <a class="source" href="state-machine.html">
                  state-machine.js
                </a>
              
                
                <a class="source" href="state.html">
                  state.js
                </a>
              
                
                <a class="source" href="video-details.html">
                  video-details.js
                </a>
              
                
                <a class="source" href="grid.manifest.html">
                  grid.manifest.js
                </a>
              
                
                <a class="source" href="models.manifest.html">
                  models.manifest.js
                </a>
              
                
                <a class="source" href="attachment.html">
                  attachment.js
                </a>
              
                
                <a class="source" href="attachments.html">
                  attachments.js
                </a>
              
                
                <a class="source" href="post-image.html">
                  post-image.js
                </a>
              
                
                <a class="source" href="post-media.html">
                  post-media.js
                </a>
              
                
                <a class="source" href="query.html">
                  query.js
                </a>
              
                
                <a class="source" href="selection.html">
                  selection.js
                </a>
              
                
                <a class="source" href="manage.html">
                  manage.js
                </a>
              
                
                <a class="source" href="selection-sync.html">
                  selection-sync.js
                </a>
              
                
                <a class="source" href="views.manifest.html">
                  views.manifest.js
                </a>
              
                
                <a class="source" href="attachment-compat.html">
                  attachment-compat.js
                </a>
              
                
                <a class="source" href="attachment-filters.html">
                  attachment-filters.js
                </a>
              
                
                <a class="source" href="all.html">
                  all.js
                </a>
              
                
                <a class="source" href="date.html">
                  date.js
                </a>
              
                
                <a class="source" href="uploaded.html">
                  uploaded.js
                </a>
              
                
                <a class="source" href="attachment.html">
                  attachment.js
                </a>
              
                
                <a class="source" href="details-two-column.html">
                  details-two-column.js
                </a>
              
                
                <a class="source" href="details.html">
                  details.js
                </a>
              
                
                <a class="source" href="edit-library.html">
                  edit-library.js
                </a>
              
                
                <a class="source" href="edit-selection.html">
                  edit-selection.js
                </a>
              
                
                <a class="source" href="library.html">
                  library.js
                </a>
              
                
                <a class="source" href="selection.html">
                  selection.js
                </a>
              
                
                <a class="source" href="attachments.html">
                  attachments.js
                </a>
              
                
                <a class="source" href="browser.html">
                  browser.js
                </a>
              
                
                <a class="source" href="selection.html">
                  selection.js
                </a>
              
                
                <a class="source" href="audio-details.html">
                  audio-details.js
                </a>
              
                
                <a class="source" href="button-group.html">
                  button-group.js
                </a>
              
                
                <a class="source" href="button.html">
                  button.js
                </a>
              
                
                <a class="source" href="delete-selected-permanently.html">
                  delete-selected-permanently.js
                </a>
              
                
                <a class="source" href="delete-selected.html">
                  delete-selected.js
                </a>
              
                
                <a class="source" href="select-mode-toggle.html">
                  select-mode-toggle.js
                </a>
              
                
                <a class="source" href="cropper.html">
                  cropper.js
                </a>
              
                
                <a class="source" href="edit-image-details.html">
                  edit-image-details.js
                </a>
              
                
                <a class="source" href="edit-image.html">
                  edit-image.js
                </a>
              
                
                <a class="source" href="embed.html">
                  embed.js
                </a>
              
                
                <a class="source" href="image.html">
                  image.js
                </a>
              
                
                <a class="source" href="link.html">
                  link.js
                </a>
              
                
                <a class="source" href="url.html">
                  url.js
                </a>
              
                
                <a class="source" href="focus-manager.html">
                  focus-manager.js
                </a>
              
                
                <a class="source" href="frame.html">
                  frame.js
                </a>
              
                
                <a class="source" href="audio-details.html">
                  audio-details.js
                </a>
              
                
                <a class="source" href="edit-attachments.html">
                  edit-attachments.js
                </a>
              
                
                <a class="source" href="image-details.html">
                  image-details.js
                </a>
              
                
                <a class="source" href="manage.html">
                  manage.js
                </a>
              
                
                <a class="source" href="media-details.html">
                  media-details.js
                </a>
              
                
                <a class="source" href="post.html">
                  post.js
                </a>
              
                
                <a class="source" href="select.html">
                  select.js
                </a>
              
                
                <a class="source" href="video-details.html">
                  video-details.js
                </a>
              
                
                <a class="source" href="iframe.html">
                  iframe.js
                </a>
              
                
                <a class="source" href="image-details.html">
                  image-details.js
                </a>
              
                
                <a class="source" href="label.html">
                  label.js
                </a>
              
                
                <a class="source" href="media-details.html">
                  media-details.js
                </a>
              
                
                <a class="source" href="media-frame.html">
                  media-frame.js
                </a>
              
                
                <a class="source" href="menu-item.html">
                  menu-item.js
                </a>
              
                
                <a class="source" href="menu.html">
                  menu.js
                </a>
              
                
                <a class="source" href="modal.html">
                  modal.js
                </a>
              
                
                <a class="source" href="priority-list.html">
                  priority-list.js
                </a>
              
                
                <a class="source" href="router-item.html">
                  router-item.js
                </a>
              
                
                <a class="source" href="router.html">
                  router.js
                </a>
              
                
                <a class="source" href="search.html">
                  search.js
                </a>
              
                
                <a class="source" href="selection.html">
                  selection.js
                </a>
              
                
                <a class="source" href="settings.html">
                  settings.js
                </a>
              
                
                <a class="source" href="attachment-display.html">
                  attachment-display.js
                </a>
              
                
                <a class="source" href="gallery.html">
                  gallery.js
                </a>
              
                
                <a class="source" href="playlist.html">
                  playlist.js
                </a>
              
                
                <a class="source" href="sidebar.html">
                  sidebar.js
                </a>
              
                
                <a class="source" href="site-icon-cropper.html">
                  site-icon-cropper.js
                </a>
              
                
                <a class="source" href="site-icon-preview.html">
                  site-icon-preview.js
                </a>
              
                
                <a class="source" href="spinner.html">
                  spinner.js
                </a>
              
                
                <a class="source" href="toolbar.html">
                  toolbar.js
                </a>
              
                
                <a class="source" href="embed.html">
                  embed.js
                </a>
              
                
                <a class="source" href="select.html">
                  select.js
                </a>
              
                
                <a class="source" href="editor.html">
                  editor.js
                </a>
              
                
                <a class="source" href="inline.html">
                  inline.js
                </a>
              
                
                <a class="source" href="status-error.html">
                  status-error.js
                </a>
              
                
                <a class="source" href="status.html">
                  status.js
                </a>
              
                
                <a class="source" href="window.html">
                  window.js
                </a>
              
                
                <a class="source" href="video-details.html">
                  video-details.js
                </a>
              
                
                <a class="source" href="view.html">
                  view.js
                </a>
              
                
                <a class="source" href="froogaloop.min.html">
                  froogaloop.min.js
                </a>
              
                
                <a class="source" href="mediaelement-and-player.min.html">
                  mediaelement-and-player.min.js
                </a>
              
                
                <a class="source" href="wp-mediaelement.html">
                  wp-mediaelement.js
                </a>
              
                
                <a class="source" href="wp-playlist.html">
                  wp-playlist.js
                </a>
              
                
                <a class="source" href="handlers.html">
                  handlers.js
                </a>
              
                
                <a class="source" href="plupload.full.min.html">
                  plupload.full.min.js
                </a>
              
                
                <a class="source" href="wp-plupload.html">
                  wp-plupload.js
                </a>
              
                
                <a class="source" href="quicktags.html">
                  quicktags.js
                </a>
              
                
                <a class="source" href="shortcode.html">
                  shortcode.js
                </a>
              
                
                <a class="source" href="swfobject.html">
                  swfobject.js
                </a>
              
                
                <a class="source" href="handlers.html">
                  handlers.js
                </a>
              
                
                <a class="source" href="handlers.min.html">
                  handlers.min.js
                </a>
              
                
                <a class="source" href="swfupload.cookies.html">
                  swfupload.cookies.js
                </a>
              
                
                <a class="source" href="swfupload.queue.html">
                  swfupload.queue.js
                </a>
              
                
                <a class="source" href="swfupload.speed.html">
                  swfupload.speed.js
                </a>
              
                
                <a class="source" href="swfupload.swfobject.html">
                  swfupload.swfobject.js
                </a>
              
                
                <a class="source" href="swfupload.html">
                  swfupload.js
                </a>
              
                
                <a class="source" href="thickbox.html">
                  thickbox.js
                </a>
              
                
                <a class="source" href="wp-langs-en.html">
                  wp-langs-en.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.min.html">
                  plugin.min.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="plugin.html">
                  plugin.js
                </a>
              
                
                <a class="source" href="theme.html">
                  theme.js
                </a>
              
                
                <a class="source" href="theme.min.html">
                  theme.min.js
                </a>
              
                
                <a class="source" href="theme.html">
                  theme.js
                </a>
              
                
                <a class="source" href="theme.min.html">
                  theme.min.js
                </a>
              
                
                <a class="source" href="tiny_mce_popup.html">
                  tiny_mce_popup.js
                </a>
              
                
                <a class="source" href="tinymce.html">
                  tinymce.js
                </a>
              
                
                <a class="source" href="tinymce.min.html">
                  tinymce.min.js
                </a>
              
                
                <a class="source" href="editable_selects.html">
                  editable_selects.js
                </a>
              
                
                <a class="source" href="form_utils.html">
                  form_utils.js
                </a>
              
                
                <a class="source" href="mctabs.html">
                  mctabs.js
                </a>
              
                
                <a class="source" href="validate.html">
                  validate.js
                </a>
              
                
                <a class="source" href="tw-sack.html">
                  tw-sack.js
                </a>
              
                
                <a class="source" href="twemoji.html">
                  twemoji.js
                </a>
              
                
                <a class="source" href="underscore.html">
                  underscore.js
                </a>
              
                
                <a class="source" href="underscore.min.html">
                  underscore.min.js
                </a>
              
                
                <a class="source" href="utils.html">
                  utils.js
                </a>
              
                
                <a class="source" href="wp-a11y.html">
                  wp-a11y.js
                </a>
              
                
                <a class="source" href="wp-ajax-response.html">
                  wp-ajax-response.js
                </a>
              
                
                <a class="source" href="wp-api.html">
                  wp-api.js
                </a>
              
                
                <a class="source" href="wp-auth-check.html">
                  wp-auth-check.js
                </a>
              
                
                <a class="source" href="wp-backbone.html">
                  wp-backbone.js
                </a>
              
                
                <a class="source" href="wp-custom-header.html">
                  wp-custom-header.js
                </a>
              
                
                <a class="source" href="wp-embed-template.html">
                  wp-embed-template.js
                </a>
              
                
                <a class="source" href="wp-embed.html">
                  wp-embed.js
                </a>
              
                
                <a class="source" href="wp-emoji-loader.html">
                  wp-emoji-loader.js
                </a>
              
                
                <a class="source" href="wp-emoji.html">
                  wp-emoji.js
                </a>
              
                
                <a class="source" href="wp-list-revisions.html">
                  wp-list-revisions.js
                </a>
              
                
                <a class="source" href="wp-lists.html">
                  wp-lists.js
                </a>
              
                
                <a class="source" href="wp-pointer.html">
                  wp-pointer.js
                </a>
              
                
                <a class="source" href="wp-util.html">
                  wp-util.js
                </a>
              
                
                <a class="source" href="wpdialog.html">
                  wpdialog.js
                </a>
              
                
                <a class="source" href="wplink.html">
                  wplink.js
                </a>
              
                
                <a class="source" href="zxcvbn-async.html">
                  zxcvbn-async.js
                </a>
              
                
                <a class="source" href="zxcvbn.min.html">
                  zxcvbn.min.js
                </a>
              
            </div>
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>customize-preview.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-comment">/*
 * Script run inside a Customizer preview frame.
 */</span>
(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> exports, $ </span>)</span>{
	<span class="hljs-keyword">var</span> api = wp.customize,
		debounce,
		currentHistoryState = {};

	<span class="hljs-comment">/*
	 * Capture the state that is passed into history.replaceState() and history.pushState()
	 * and also which is returned in the popstate event so that when the changeset_uuid
	 * gets updated when transitioning to a new changeset there the current state will
	 * be supplied in the call to history.replaceState().
	 */</span>
	( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> history </span>) </span>{
		<span class="hljs-keyword">var</span> injectUrlWithState;

		<span class="hljs-keyword">if</span> ( ! history.replaceState ) {
			<span class="hljs-keyword">return</span>;
		}

		<span class="hljs-comment">/**
		 * Amend the supplied URL with the customized state.
		 *
		 * @since 4.7.0
		 * @access private
		 *
		 * @param {string} url URL.
		 * @returns {string} URL with customized state.
		 */</span>
		injectUrlWithState = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> url </span>) </span>{
			<span class="hljs-keyword">var</span> urlParser, oldQueryParams, newQueryParams;
			urlParser = <span class="hljs-built_in">document</span>.createElement( <span class="hljs-string">'a'</span> );
			urlParser.href = url;
			oldQueryParams = api.utils.parseQueryString( location.search.substr( <span class="hljs-number">1</span> ) );
			newQueryParams = api.utils.parseQueryString( urlParser.search.substr( <span class="hljs-number">1</span> ) );

			newQueryParams.customize_changeset_uuid = oldQueryParams.customize_changeset_uuid;
			<span class="hljs-keyword">if</span> ( oldQueryParams.customize_theme ) {
				newQueryParams.customize_theme = oldQueryParams.customize_theme;
			}
			<span class="hljs-keyword">if</span> ( oldQueryParams.customize_messenger_channel ) {
				newQueryParams.customize_messenger_channel = oldQueryParams.customize_messenger_channel;
			}
			urlParser.search = $.param( newQueryParams );
			<span class="hljs-keyword">return</span> urlParser.href;
		};

		history.replaceState = ( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> nativeReplaceState </span>) </span>{
			<span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">historyReplaceState</span>(<span class="hljs-params"> data, title, url </span>) </span>{
				currentHistoryState = data;
				<span class="hljs-keyword">return</span> nativeReplaceState.call( history, data, title, <span class="hljs-string">'string'</span> === <span class="hljs-keyword">typeof</span> url &amp;&amp; url.length &gt; <span class="hljs-number">0</span> ? injectUrlWithState( url ) : url );
			};
		} )( history.replaceState );

		history.pushState = ( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> nativePushState </span>) </span>{
			<span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">historyPushState</span>(<span class="hljs-params"> data, title, url </span>) </span>{
				currentHistoryState = data;
				<span class="hljs-keyword">return</span> nativePushState.call( history, data, title, <span class="hljs-string">'string'</span> === <span class="hljs-keyword">typeof</span> url &amp;&amp; url.length &gt; <span class="hljs-number">0</span> ? injectUrlWithState( url ) : url );
			};
		} )( history.pushState );

		<span class="hljs-built_in">window</span>.addEventListener( <span class="hljs-string">'popstate'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> event </span>) </span>{
			currentHistoryState = event.state;
		} );

	}( history ) );

	<span class="hljs-comment">/**
	 * Returns a debounced version of the function.
	 *
	 * @todo Require Underscore.js for this file and retire this.
	 */</span>
	debounce = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> fn, delay, context </span>) </span>{
		<span class="hljs-keyword">var</span> timeout;
		<span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">var</span> args = <span class="hljs-built_in">arguments</span>;

			context = context || <span class="hljs-keyword">this</span>;

			clearTimeout( timeout );
			timeout = setTimeout( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
				timeout = <span class="hljs-literal">null</span>;
				fn.apply( context, args );
			}, delay );
		};
	};

	<span class="hljs-comment">/**
	 * @constructor
	 * @augments wp.customize.Messenger
	 * @augments wp.customize.Class
	 * @mixes wp.customize.Events
	 */</span>
	api.Preview = api.Messenger.extend({
		<span class="hljs-comment">/**
		 * @param {object} params  - Parameters to configure the messenger.
		 * @param {object} options - Extend any instance parameter or method with this object.
		 */</span>
		initialize: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> params, options </span>) </span>{
			<span class="hljs-keyword">var</span> preview = <span class="hljs-keyword">this</span>, urlParser = <span class="hljs-built_in">document</span>.createElement( <span class="hljs-string">'a'</span> );

			api.Messenger.prototype.initialize.call( preview, params, options );

			urlParser.href = preview.origin();
			preview.add( <span class="hljs-string">'scheme'</span>, urlParser.protocol.replace( <span class="hljs-regexp">/:$/</span>, <span class="hljs-string">''</span> ) );

			preview.body = $( <span class="hljs-built_in">document</span>.body );
			preview.window = $( <span class="hljs-built_in">window</span> );

			<span class="hljs-keyword">if</span> ( api.settings.channel ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>If in an iframe, then intercept the link clicks and form submissions.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				preview.body.on( <span class="hljs-string">'click.preview'</span>, <span class="hljs-string">'a'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> event </span>) </span>{
					preview.handleLinkClick( event );
				} );
				preview.body.on( <span class="hljs-string">'submit.preview'</span>, <span class="hljs-string">'form'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> event </span>) </span>{
					preview.handleFormSubmit( event );
				} );

				preview.window.on( <span class="hljs-string">'scroll.preview'</span>, debounce( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
					preview.send( <span class="hljs-string">'scroll'</span>, preview.window.scrollTop() );
				}, <span class="hljs-number">200</span> ) );

				preview.bind( <span class="hljs-string">'scroll'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> distance </span>) </span>{
					preview.window.scrollTop( distance );
				});
			}
		},

		<span class="hljs-comment">/**
		 * Handle link clicks in preview.
		 *
		 * @since 4.7.0
		 * @access public
		 *
		 * @param {jQuery.Event} event Event.
		 */</span>
		handleLinkClick: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> event </span>) </span>{
			<span class="hljs-keyword">var</span> preview = <span class="hljs-keyword">this</span>, link, isInternalJumpLink;
			link = $( event.target ).closest( <span class="hljs-string">'a'</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>No-op if the anchor is not a link.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( _.isUndefined( link.attr( <span class="hljs-string">'href'</span> ) ) ) {
				<span class="hljs-keyword">return</span>;
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>Allow internal jump links and JS links to behave normally without preventing default.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			isInternalJumpLink = ( <span class="hljs-string">'#'</span> === link.attr( <span class="hljs-string">'href'</span> ).substr( <span class="hljs-number">0</span>, <span class="hljs-number">1</span> ) );
			<span class="hljs-keyword">if</span> ( isInternalJumpLink || ! <span class="hljs-regexp">/^https?:$/</span>.test( link.prop( <span class="hljs-string">'protocol'</span> ) ) ) {
				<span class="hljs-keyword">return</span>;
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>If the link is not previewable, prevent the browser from navigating to it.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( ! api.isLinkPreviewable( link[<span class="hljs-number">0</span>] ) ) {
				wp.a11y.speak( api.settings.l10n.linkUnpreviewable );
				event.preventDefault();
				<span class="hljs-keyword">return</span>;
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>Prevent initiating navigating from click and instead rely on sending url message to pane.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			event.preventDefault();

			<span class="hljs-comment">/*
			 * Note the shift key is checked so shift+click on widgets or
			 * nav menu items can just result on focusing on the corresponding
			 * control instead of also navigating to the URL linked to.
			 */</span>
			<span class="hljs-keyword">if</span> ( event.shiftKey ) {
				<span class="hljs-keyword">return</span>;
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>Note: Its not relevant to send scroll because sending url message will have the same effect.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			preview.send( <span class="hljs-string">'url'</span>, link.prop( <span class="hljs-string">'href'</span> ) );
		},

		<span class="hljs-comment">/**
		 * Handle form submit.
		 *
		 * @since 4.7.0
		 * @access public
		 *
		 * @param {jQuery.Event} event Event.
		 */</span>
		handleFormSubmit: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> event </span>) </span>{
			<span class="hljs-keyword">var</span> preview = <span class="hljs-keyword">this</span>, urlParser, form;
			urlParser = <span class="hljs-built_in">document</span>.createElement( <span class="hljs-string">'a'</span> );
			form = $( event.target );
			urlParser.href = form.prop( <span class="hljs-string">'action'</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>If the link is not previewable, prevent the browser from navigating to it.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( <span class="hljs-string">'GET'</span> !== form.prop( <span class="hljs-string">'method'</span> ).toUpperCase() || ! api.isLinkPreviewable( urlParser ) ) {
				wp.a11y.speak( api.settings.l10n.formUnpreviewable );
				event.preventDefault();
				<span class="hljs-keyword">return</span>;
			}

			<span class="hljs-comment">/*
			 * If the default wasn't prevented already (in which case the form
			 * submission is already being handled by JS), and if it has a GET
			 * request method, then take the serialized form data and add it as
			 * a query string to the action URL and send this in a url message
			 * to the customizer pane so that it will be loaded. If the form's
			 * action points to a non-previewable URL, the customizer pane's
			 * previewUrl setter will reject it so that the form submission is
			 * a no-op, which is the same behavior as when clicking a link to an
			 * external site in the preview.
			 */</span>
			<span class="hljs-keyword">if</span> ( ! event.isDefaultPrevented() ) {
				<span class="hljs-keyword">if</span> ( urlParser.search.length &gt; <span class="hljs-number">1</span> ) {
					urlParser.search += <span class="hljs-string">'&amp;'</span>;
				}
				urlParser.search += form.serialize();
				preview.send( <span class="hljs-string">'url'</span>, urlParser.href );
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>Prevent default since navigation should be done via sending url message or via JS submit handler.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			event.preventDefault();
		}
	});

	<span class="hljs-comment">/**
	 * Inject the changeset UUID into links in the document.
	 *
	 * @since 4.7.0
	 * @access protected
	 *
	 * @access private
	 * @returns {void}
	 */</span>
	api.addLinkPreviewing = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addLinkPreviewing</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> linkSelectors = <span class="hljs-string">'a[href], area'</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>Inject links into initial document.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		$( <span class="hljs-built_in">document</span>.body ).find( linkSelectors ).each( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
			api.prepareLinkPreview( <span class="hljs-keyword">this</span> );
		} );</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>Inject links for new elements added to the page.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-string">'undefined'</span> !== <span class="hljs-keyword">typeof</span> MutationObserver ) {
			api.mutationObserver = <span class="hljs-keyword">new</span> MutationObserver( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> mutations </span>) </span>{
				_.each( mutations, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> mutation </span>) </span>{
					$( mutation.target ).find( linkSelectors ).each( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
						api.prepareLinkPreview( <span class="hljs-keyword">this</span> );
					} );
				} );
			} );
			api.mutationObserver.observe( <span class="hljs-built_in">document</span>.documentElement, {
				<span class="hljs-attr">childList</span>: <span class="hljs-literal">true</span>,
				<span class="hljs-attr">subtree</span>: <span class="hljs-literal">true</span>
			} );
		} <span class="hljs-keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>If mutation observers arent available, fallback to just-in-time injection.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			$( <span class="hljs-built_in">document</span>.documentElement ).on( <span class="hljs-string">'click focus mouseover'</span>, linkSelectors, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
				api.prepareLinkPreview( <span class="hljs-keyword">this</span> );
			} );
		}
	};

	<span class="hljs-comment">/**
	 * Should the supplied link is previewable.
	 *
	 * @since 4.7.0
	 * @access public
	 *
	 * @param {HTMLAnchorElement|HTMLAreaElement} element Link element.
	 * @param {string} element.search Query string.
	 * @param {string} element.pathname Path.
	 * @param {string} element.host Host.
	 * @param {object} [options]
	 * @param {object} [options.allowAdminAjax=false] Allow admin-ajax.php requests.
	 * @returns {boolean} Is appropriate for changeset link.
	 */</span>
	api.isLinkPreviewable = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isLinkPreviewable</span>(<span class="hljs-params"> element, options </span>) </span>{
		<span class="hljs-keyword">var</span> matchesAllowedUrl, parsedAllowedUrl, args, elementHost;

		args = _.extend( {}, { <span class="hljs-attr">allowAdminAjax</span>: <span class="hljs-literal">false</span> }, options || {} );

		<span class="hljs-keyword">if</span> ( <span class="hljs-string">'javascript:'</span> === element.protocol ) { <span class="hljs-comment">// jshint ignore:line</span>
			<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p>Only web URLs can be previewed.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-string">'https:'</span> !== element.protocol &amp;&amp; <span class="hljs-string">'http:'</span> !== element.protocol ) {
			<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
		}

		elementHost = element.host.replace( <span class="hljs-regexp">/:(80|443)$/</span>, <span class="hljs-string">''</span> );
		parsedAllowedUrl = <span class="hljs-built_in">document</span>.createElement( <span class="hljs-string">'a'</span> );
		matchesAllowedUrl = ! _.isUndefined( _.find( api.settings.url.allowed, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> allowedUrl </span>) </span>{
			parsedAllowedUrl.href = allowedUrl;
			<span class="hljs-keyword">return</span> parsedAllowedUrl.protocol === element.protocol &amp;&amp; parsedAllowedUrl.host.replace( <span class="hljs-regexp">/:(80|443)$/</span>, <span class="hljs-string">''</span> ) === elementHost &amp;&amp; <span class="hljs-number">0</span> === element.pathname.indexOf( parsedAllowedUrl.pathname.replace( <span class="hljs-regexp">/\/$/</span>, <span class="hljs-string">''</span> ) );
		} ) );
		<span class="hljs-keyword">if</span> ( ! matchesAllowedUrl ) {
			<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p>Skip wp login and signup pages.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-regexp">/\/wp-(login|signup)\.php$/</span>.test( element.pathname ) ) {
			<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <p>Allow links to admin ajax as faux frontend URLs.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-regexp">/\/wp-admin\/admin-ajax\.php$/</span>.test( element.pathname ) ) {
			<span class="hljs-keyword">return</span> args.allowAdminAjax;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <p>Disallow links to admin, includes, and content.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-regexp">/\/wp-(admin|includes|content)(\/|$)/</span>.test( element.pathname ) ) {
			<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
		}

		<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
	};

	<span class="hljs-comment">/**
	 * Inject the customize_changeset_uuid query param into links on the frontend.
	 *
	 * @since 4.7.0
	 * @access protected
	 *
	 * @param {HTMLAnchorElement|HTMLAreaElement} element Link element.
	 * @param {string} element.search Query string.
	 * @param {string} element.host Host.
	 * @param {string} element.protocol Protocol.
	 * @returns {void}
	 */</span>
	api.prepareLinkPreview = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">prepareLinkPreview</span>(<span class="hljs-params"> element </span>) </span>{
		<span class="hljs-keyword">var</span> queryParams;</pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <p>Skip links in admin bar.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( $( element ).closest( <span class="hljs-string">'#wpadminbar'</span> ).length ) {
			<span class="hljs-keyword">return</span>;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <p>Ignore links with href=#, href=#id, or non-HTTP protocols (e.g. javascript: and mailto:).</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-string">'#'</span> === $( element ).attr( <span class="hljs-string">'href'</span> ).substr( <span class="hljs-number">0</span>, <span class="hljs-number">1</span> ) || ! <span class="hljs-regexp">/^https?:$/</span>.test( element.protocol ) ) {
			<span class="hljs-keyword">return</span>;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p>Make sure links in preview use HTTPS if parent frame uses HTTPS.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( api.settings.channel &amp;&amp; <span class="hljs-string">'https'</span> === api.preview.scheme.get() &amp;&amp; <span class="hljs-string">'http:'</span> === element.protocol &amp;&amp; <span class="hljs-number">-1</span> !== api.settings.url.allowedHosts.indexOf( element.host ) ) {
			element.protocol = <span class="hljs-string">'https:'</span>;
		}

		<span class="hljs-keyword">if</span> ( ! api.isLinkPreviewable( element ) ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <p>Style link as unpreviewable only if previewing in iframe; if previewing on frontend, links will be allowed to work normally.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( api.settings.channel ) {
				$( element ).addClass( <span class="hljs-string">'customize-unpreviewable'</span> );
			}
			<span class="hljs-keyword">return</span>;
		}
		$( element ).removeClass( <span class="hljs-string">'customize-unpreviewable'</span> );

		queryParams = api.utils.parseQueryString( element.search.substring( <span class="hljs-number">1</span> ) );
		queryParams.customize_changeset_uuid = api.settings.changeset.uuid;
		<span class="hljs-keyword">if</span> ( ! api.settings.theme.active ) {
			queryParams.customize_theme = api.settings.theme.stylesheet;
		}
		<span class="hljs-keyword">if</span> ( api.settings.channel ) {
			queryParams.customize_messenger_channel = api.settings.channel;
		}
		element.search = $.param( queryParams );</pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <p>Prevent links from breaking out of preview iframe.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( api.settings.channel ) {
			element.target = <span class="hljs-string">'_self'</span>;
		}
	};

	<span class="hljs-comment">/**
	 * Inject the changeset UUID into Ajax requests.
	 *
	 * @since 4.7.0
	 * @access protected
	 *
	 * @return {void}
	 */</span>
	api.addRequestPreviewing = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addRequestPreviewing</span>(<span class="hljs-params"></span>) </span>{

		<span class="hljs-comment">/**
		 * Rewrite Ajax requests to inject customizer state.
		 *
		 * @param {object} options Options.
		 * @param {string} options.type Type.
		 * @param {string} options.url URL.
		 * @param {object} originalOptions Original options.
		 * @param {XMLHttpRequest} xhr XHR.
		 * @returns {void}
		 */</span>
		<span class="hljs-keyword">var</span> prefilterAjax = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> options, originalOptions, xhr </span>) </span>{
			<span class="hljs-keyword">var</span> urlParser, queryParams, requestMethod, dirtyValues = {};
			urlParser = <span class="hljs-built_in">document</span>.createElement( <span class="hljs-string">'a'</span> );
			urlParser.href = options.url;</pre></div></div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <p>Abort if the request is not for this site.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( ! api.isLinkPreviewable( urlParser, { <span class="hljs-attr">allowAdminAjax</span>: <span class="hljs-literal">true</span> } ) ) {
				<span class="hljs-keyword">return</span>;
			}
			queryParams = api.utils.parseQueryString( urlParser.search.substring( <span class="hljs-number">1</span> ) );</pre></div></div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <p>Note that _dirty flag will be cleared with changeset updates.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			api.each( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> setting </span>) </span>{
				<span class="hljs-keyword">if</span> ( setting._dirty ) {
					dirtyValues[ setting.id ] = setting.get();
				}
			} );

			<span class="hljs-keyword">if</span> ( ! _.isEmpty( dirtyValues ) ) {
				requestMethod = options.type.toUpperCase();</pre></div></div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <p>Override underlying request method to ensure unsaved changes to changeset can be included (force Backbone.emulateHTTP).</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( <span class="hljs-string">'POST'</span> !== requestMethod ) {
					xhr.setRequestHeader( <span class="hljs-string">'X-HTTP-Method-Override'</span>, requestMethod );
					queryParams._method = requestMethod;
					options.type = <span class="hljs-string">'POST'</span>;
				}</pre></div></div>
            
        </li>
        
        
        <li id="section-25">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-25">&#182;</a>
              </div>
              <p>Amend the post data with the customized values.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( options.data ) {
					options.data += <span class="hljs-string">'&amp;'</span>;
				} <span class="hljs-keyword">else</span> {
					options.data = <span class="hljs-string">''</span>;
				}
				options.data += $.param( {
					<span class="hljs-attr">customized</span>: <span class="hljs-built_in">JSON</span>.stringify( dirtyValues )
				} );
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-26">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-26">&#182;</a>
              </div>
              <p>Include customized state query params in URL.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			queryParams.customize_changeset_uuid = api.settings.changeset.uuid;
			<span class="hljs-keyword">if</span> ( ! api.settings.theme.active ) {
				queryParams.customize_theme = api.settings.theme.stylesheet;
			}
			urlParser.search = $.param( queryParams );
			options.url = urlParser.href;
		};

		$.ajaxPrefilter( prefilterAjax );
	};

	<span class="hljs-comment">/**
	 * Inject changeset UUID into forms, allowing preview to persist through submissions.
	 *
	 * @since 4.7.0
	 * @access protected
	 *
	 * @returns {void}
	 */</span>
	api.addFormPreviewing = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addFormPreviewing</span>(<span class="hljs-params"></span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-27">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-27">&#182;</a>
              </div>
              <p>Inject inputs for forms in initial document.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		$( <span class="hljs-built_in">document</span>.body ).find( <span class="hljs-string">'form'</span> ).each( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
			api.prepareFormPreview( <span class="hljs-keyword">this</span> );
		} );</pre></div></div>
            
        </li>
        
        
        <li id="section-28">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-28">&#182;</a>
              </div>
              <p>Inject inputs for new forms added to the page.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-string">'undefined'</span> !== <span class="hljs-keyword">typeof</span> MutationObserver ) {
			api.mutationObserver = <span class="hljs-keyword">new</span> MutationObserver( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> mutations </span>) </span>{
				_.each( mutations, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> mutation </span>) </span>{
					$( mutation.target ).find( <span class="hljs-string">'form'</span> ).each( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
						api.prepareFormPreview( <span class="hljs-keyword">this</span> );
					} );
				} );
			} );
			api.mutationObserver.observe( <span class="hljs-built_in">document</span>.documentElement, {
				<span class="hljs-attr">childList</span>: <span class="hljs-literal">true</span>,
				<span class="hljs-attr">subtree</span>: <span class="hljs-literal">true</span>
			} );
		}
	};

	<span class="hljs-comment">/**
	 * Inject changeset into form inputs.
	 *
	 * @since 4.7.0
	 * @access protected
	 *
	 * @param {HTMLFormElement} form Form.
	 * @returns {void}
	 */</span>
	api.prepareFormPreview = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">prepareFormPreview</span>(<span class="hljs-params"> form </span>) </span>{
		<span class="hljs-keyword">var</span> urlParser, stateParams = {};

		<span class="hljs-keyword">if</span> ( ! form.action ) {
			form.action = location.href;
		}

		urlParser = <span class="hljs-built_in">document</span>.createElement( <span class="hljs-string">'a'</span> );
		urlParser.href = form.action;</pre></div></div>
            
        </li>
        
        
        <li id="section-29">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-29">&#182;</a>
              </div>
              <p>Make sure forms in preview use HTTPS if parent frame uses HTTPS.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( api.settings.channel &amp;&amp; <span class="hljs-string">'https'</span> === api.preview.scheme.get() &amp;&amp; <span class="hljs-string">'http:'</span> === urlParser.protocol &amp;&amp; <span class="hljs-number">-1</span> !== api.settings.url.allowedHosts.indexOf( urlParser.host ) ) {
			urlParser.protocol = <span class="hljs-string">'https:'</span>;
			form.action = urlParser.href;
		}

		<span class="hljs-keyword">if</span> ( <span class="hljs-string">'GET'</span> !== form.method.toUpperCase() || ! api.isLinkPreviewable( urlParser ) ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-30">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-30">&#182;</a>
              </div>
              <p>Style form as unpreviewable only if previewing in iframe; if previewing on frontend, all forms will be allowed to work normally.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( api.settings.channel ) {
				$( form ).addClass( <span class="hljs-string">'customize-unpreviewable'</span> );
			}
			<span class="hljs-keyword">return</span>;
		}
		$( form ).removeClass( <span class="hljs-string">'customize-unpreviewable'</span> );

		stateParams.customize_changeset_uuid = api.settings.changeset.uuid;
		<span class="hljs-keyword">if</span> ( ! api.settings.theme.active ) {
			stateParams.customize_theme = api.settings.theme.stylesheet;
		}
		<span class="hljs-keyword">if</span> ( api.settings.channel ) {
			stateParams.customize_messenger_channel = api.settings.channel;
		}

		_.each( stateParams, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> value, name </span>) </span>{
			<span class="hljs-keyword">var</span> input = $( form ).find( <span class="hljs-string">'input[name="'</span> + name + <span class="hljs-string">'"]'</span> );
			<span class="hljs-keyword">if</span> ( input.length ) {
				input.val( value );
			} <span class="hljs-keyword">else</span> {
				$( form ).prepend( $( <span class="hljs-string">'&lt;input&gt;'</span>, {
					<span class="hljs-attr">type</span>: <span class="hljs-string">'hidden'</span>,
					<span class="hljs-attr">name</span>: name,
					<span class="hljs-attr">value</span>: value
				} ) );
			}
		} );</pre></div></div>
            
        </li>
        
        
        <li id="section-31">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-31">&#182;</a>
              </div>
              <p>Prevent links from breaking out of preview iframe.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( api.settings.channel ) {
			form.target = <span class="hljs-string">'_self'</span>;
		}
	};

	<span class="hljs-comment">/**
	 * Watch current URL and send keep-alive (heartbeat) messages to the parent.
	 *
	 * Keep the customizer pane notified that the preview is still alive
	 * and that the user hasn't navigated to a non-customized URL.
	 *
	 * @since 4.7.0
	 * @access protected
	 */</span>
	api.keepAliveCurrentUrl = ( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> previousPathName = location.pathname,
			previousQueryString = location.search.substr( <span class="hljs-number">1</span> ),
			previousQueryParams = <span class="hljs-literal">null</span>,
			stateQueryParams = [ <span class="hljs-string">'customize_theme'</span>, <span class="hljs-string">'customize_changeset_uuid'</span>, <span class="hljs-string">'customize_messenger_channel'</span> ];

		<span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">keepAliveCurrentUrl</span>(<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">var</span> urlParser, currentQueryParams;</pre></div></div>
            
        </li>
        
        
        <li id="section-32">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-32">&#182;</a>
              </div>
              <p>Short-circuit with keep-alive if previous URL is identical (as is normal case).</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( previousQueryString === location.search.substr( <span class="hljs-number">1</span> ) &amp;&amp; previousPathName === location.pathname ) {
				api.preview.send( <span class="hljs-string">'keep-alive'</span> );
				<span class="hljs-keyword">return</span>;
			}

			urlParser = <span class="hljs-built_in">document</span>.createElement( <span class="hljs-string">'a'</span> );
			<span class="hljs-keyword">if</span> ( <span class="hljs-literal">null</span> === previousQueryParams ) {
				urlParser.search = previousQueryString;
				previousQueryParams = api.utils.parseQueryString( previousQueryString );
				_.each( stateQueryParams, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> name </span>) </span>{
					<span class="hljs-keyword">delete</span> previousQueryParams[ name ];
				} );
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-33">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-33">&#182;</a>
              </div>
              <p>Determine if current URL minus customized state params and URL hash.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			urlParser.href = location.href;
			currentQueryParams = api.utils.parseQueryString( urlParser.search.substr( <span class="hljs-number">1</span> ) );
			_.each( stateQueryParams, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> name </span>) </span>{
				<span class="hljs-keyword">delete</span> currentQueryParams[ name ];
			} );

			<span class="hljs-keyword">if</span> ( previousPathName !== location.pathname || ! _.isEqual( previousQueryParams, currentQueryParams ) ) {
				urlParser.search = $.param( currentQueryParams );
				urlParser.hash = <span class="hljs-string">''</span>;
				api.settings.url.self = urlParser.href;
				api.preview.send( <span class="hljs-string">'ready'</span>, {
					<span class="hljs-attr">currentUrl</span>: api.settings.url.self,
					<span class="hljs-attr">activePanels</span>: api.settings.activePanels,
					<span class="hljs-attr">activeSections</span>: api.settings.activeSections,
					<span class="hljs-attr">activeControls</span>: api.settings.activeControls,
					<span class="hljs-attr">settingValidities</span>: api.settings.settingValidities
				} );
			} <span class="hljs-keyword">else</span> {
				api.preview.send( <span class="hljs-string">'keep-alive'</span> );
			}
			previousQueryParams = currentQueryParams;
			previousQueryString = location.search.substr( <span class="hljs-number">1</span> );
			previousPathName = location.pathname;
		};
	} )();

	api.settingPreviewHandlers = {

		<span class="hljs-comment">/**
		 * Preview changes to custom logo.
		 *
		 * @param {number} attachmentId Attachment ID for custom logo.
		 * @returns {void}
		 */</span>
		custom_logo: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> attachmentId </span>) </span>{
			$( <span class="hljs-string">'body'</span> ).toggleClass( <span class="hljs-string">'wp-custom-logo'</span>, !! attachmentId );
		},

		<span class="hljs-comment">/**
		 * Preview changes to custom css.
		 *
		 * @param {string} value Custom CSS..
		 * @returns {void}
		 */</span>
		custom_css: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> value </span>) </span>{
			$( <span class="hljs-string">'#wp-custom-css'</span> ).text( value );
		},

		<span class="hljs-comment">/**
		 * Preview changes to any of the background settings.
		 *
		 * @returns {void}
		 */</span>
		background: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">var</span> css = <span class="hljs-string">''</span>, settings = {};

			_.each( [<span class="hljs-string">'color'</span>, <span class="hljs-string">'image'</span>, <span class="hljs-string">'preset'</span>, <span class="hljs-string">'position_x'</span>, <span class="hljs-string">'position_y'</span>, <span class="hljs-string">'size'</span>, <span class="hljs-string">'repeat'</span>, <span class="hljs-string">'attachment'</span>], <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> prop </span>) </span>{
				settings[ prop ] = api( <span class="hljs-string">'background_'</span> + prop );
			} );

			<span class="hljs-comment">/*
			 * The body will support custom backgrounds if either the color or image are set.
			 *
			 * See get_body_class() in /wp-includes/post-template.php
			 */</span>
			$( <span class="hljs-built_in">document</span>.body ).toggleClass( <span class="hljs-string">'custom-background'</span>, !! ( settings.color() || settings.image() ) );

			<span class="hljs-keyword">if</span> ( settings.color() ) {
				css += <span class="hljs-string">'background-color: '</span> + settings.color() + <span class="hljs-string">';'</span>;
			}

			<span class="hljs-keyword">if</span> ( settings.image() ) {
				css += <span class="hljs-string">'background-image: url("'</span> + settings.image() + <span class="hljs-string">'");'</span>;
				css += <span class="hljs-string">'background-size: '</span> + settings.size() + <span class="hljs-string">';'</span>;
				css += <span class="hljs-string">'background-position: '</span> + settings.position_x() + <span class="hljs-string">' '</span> + settings.position_y() + <span class="hljs-string">';'</span>;
				css += <span class="hljs-string">'background-repeat: '</span> + settings.repeat() + <span class="hljs-string">';'</span>;
				css += <span class="hljs-string">'background-attachment: '</span> + settings.attachment() + <span class="hljs-string">';'</span>;
			}

			$( <span class="hljs-string">'#custom-background-css'</span> ).text( <span class="hljs-string">'body.custom-background { '</span> + css + <span class="hljs-string">' }'</span> );
		}
	};

	$( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> bg, setValue;

		api.settings = <span class="hljs-built_in">window</span>._wpCustomizeSettings;
		<span class="hljs-keyword">if</span> ( ! api.settings ) {
			<span class="hljs-keyword">return</span>;
		}

		api.preview = <span class="hljs-keyword">new</span> api.Preview({
			<span class="hljs-attr">url</span>: <span class="hljs-built_in">window</span>.location.href,
			<span class="hljs-attr">channel</span>: api.settings.channel
		});

		api.addLinkPreviewing();
		api.addRequestPreviewing();
		api.addFormPreviewing();

		<span class="hljs-comment">/**
		 * Create/update a setting value.
		 *
		 * @param {string}  id            - Setting ID.
		 * @param {*}       value         - Setting value.
		 * @param {boolean} [createDirty] - Whether to create a setting as dirty. Defaults to false.
		 */</span>
		setValue = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> id, value, createDirty </span>) </span>{
			<span class="hljs-keyword">var</span> setting = api( id );
			<span class="hljs-keyword">if</span> ( setting ) {
				setting.set( value );
			} <span class="hljs-keyword">else</span> {
				createDirty = createDirty || <span class="hljs-literal">false</span>;
				setting = api.create( id, value, {
					<span class="hljs-attr">id</span>: id
				} );</pre></div></div>
            
        </li>
        
        
        <li id="section-34">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-34">&#182;</a>
              </div>
              <p>Mark dynamically-created settings as dirty so they will get posted.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( createDirty ) {
					setting._dirty = <span class="hljs-literal">true</span>;
				}
			}
		};

		api.preview.bind( <span class="hljs-string">'settings'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> values </span>) </span>{
			$.each( values, setValue );
		});

		api.preview.trigger( <span class="hljs-string">'settings'</span>, api.settings.values );

		$.each( api.settings._dirty, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> i, id </span>) </span>{
			<span class="hljs-keyword">var</span> setting = api( id );
			<span class="hljs-keyword">if</span> ( setting ) {
				setting._dirty = <span class="hljs-literal">true</span>;
			}
		} );

		api.preview.bind( <span class="hljs-string">'setting'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> args </span>) </span>{
			<span class="hljs-keyword">var</span> createDirty = <span class="hljs-literal">true</span>;
			setValue.apply( <span class="hljs-literal">null</span>, args.concat( createDirty ) );
		});

		api.preview.bind( <span class="hljs-string">'sync'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> events </span>) </span>{

			<span class="hljs-comment">/*
			 * Delete any settings that already exist locally which haven't been
			 * modified in the controls while the preview was loading. This prevents
			 * situations where the JS value being synced from the pane may differ
			 * from the PHP-sanitized JS value in the preview which causes the
			 * non-sanitized JS value to clobber the PHP-sanitized value. This
			 * is particularly important for selective refresh partials that
			 * have a fallback refresh behavior since infinite refreshing would
			 * result.
			 */</span>
			<span class="hljs-keyword">if</span> ( events.settings &amp;&amp; events[<span class="hljs-string">'settings-modified-while-loading'</span>] ) {
				_.each( _.keys( events.settings ), <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> syncedSettingId </span>) </span>{
					<span class="hljs-keyword">if</span> ( api.has( syncedSettingId ) &amp;&amp; ! events[<span class="hljs-string">'settings-modified-while-loading'</span>][ syncedSettingId ] ) {
						<span class="hljs-keyword">delete</span> events.settings[ syncedSettingId ];
					}
				} );
			}

			$.each( events, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> event, args </span>) </span>{
				api.preview.trigger( event, args );
			});
			api.preview.send( <span class="hljs-string">'synced'</span> );
		});

		api.preview.bind( <span class="hljs-string">'active'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
			api.preview.send( <span class="hljs-string">'nonce'</span>, api.settings.nonce );

			api.preview.send( <span class="hljs-string">'documentTitle'</span>, <span class="hljs-built_in">document</span>.title );</pre></div></div>
            
        </li>
        
        
        <li id="section-35">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-35">&#182;</a>
              </div>
              <p>Send scroll in case of loading via non-refresh.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			api.preview.send( <span class="hljs-string">'scroll'</span>, $( <span class="hljs-built_in">window</span> ).scrollTop() );
		});

		api.preview.bind( <span class="hljs-string">'saved'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> response </span>) </span>{

			<span class="hljs-keyword">if</span> ( response.next_changeset_uuid ) {
				api.settings.changeset.uuid = response.next_changeset_uuid;</pre></div></div>
            
        </li>
        
        
        <li id="section-36">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-36">&#182;</a>
              </div>
              <p>Update UUIDs in links and forms.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				$( <span class="hljs-built_in">document</span>.body ).find( <span class="hljs-string">'a[href], area'</span> ).each( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
					api.prepareLinkPreview( <span class="hljs-keyword">this</span> );
				} );
				$( <span class="hljs-built_in">document</span>.body ).find( <span class="hljs-string">'form'</span> ).each( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
					api.prepareFormPreview( <span class="hljs-keyword">this</span> );
				} );

				<span class="hljs-comment">/*
				 * Replace the UUID in the URL. Note that the wrapped history.replaceState()
				 * will handle injecting the current api.settings.changeset.uuid into the URL,
				 * so this is merely to trigger that logic.
				 */</span>
				<span class="hljs-keyword">if</span> ( history.replaceState ) {
					history.replaceState( currentHistoryState, <span class="hljs-string">''</span>, location.href );
				}
			}

			api.trigger( <span class="hljs-string">'saved'</span>, response );
		} );

		<span class="hljs-comment">/*
		 * Clear dirty flag for settings when saved to changeset so that they
		 * won't be needlessly included in selective refresh or ajax requests.
		 */</span>
		api.preview.bind( <span class="hljs-string">'changeset-saved'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> data </span>) </span>{
			_.each( data.saved_changeset_values, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> value, settingId </span>) </span>{
				<span class="hljs-keyword">var</span> setting = api( settingId );
				<span class="hljs-keyword">if</span> ( setting &amp;&amp; _.isEqual( setting.get(), value ) ) {
					setting._dirty = <span class="hljs-literal">false</span>;
				}
			} );
		} );

		api.preview.bind( <span class="hljs-string">'nonce-refresh'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> nonce </span>) </span>{
			$.extend( api.settings.nonce, nonce );
		} );

		<span class="hljs-comment">/*
		 * Send a message to the parent customize frame with a list of which
		 * containers and controls are active.
		 */</span>
		api.preview.send( <span class="hljs-string">'ready'</span>, {
			<span class="hljs-attr">currentUrl</span>: api.settings.url.self,
			<span class="hljs-attr">activePanels</span>: api.settings.activePanels,
			<span class="hljs-attr">activeSections</span>: api.settings.activeSections,
			<span class="hljs-attr">activeControls</span>: api.settings.activeControls,
			<span class="hljs-attr">settingValidities</span>: api.settings.settingValidities
		} );</pre></div></div>
            
        </li>
        
        
        <li id="section-37">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-37">&#182;</a>
              </div>
              <p>Send ready when URL changes via JS.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		setInterval( api.keepAliveCurrentUrl, api.settings.timeouts.keepAliveSend );</pre></div></div>
            
        </li>
        
        
        <li id="section-38">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-38">&#182;</a>
              </div>
              <p>Display a loading indicator when preview is reloading, and remove on failure.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		api.preview.bind( <span class="hljs-string">'loading-initiated'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
			$( <span class="hljs-string">'body'</span> ).addClass( <span class="hljs-string">'wp-customizer-unloading'</span> );
		});
		api.preview.bind( <span class="hljs-string">'loading-failed'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
			$( <span class="hljs-string">'body'</span> ).removeClass( <span class="hljs-string">'wp-customizer-unloading'</span> );
		});

		<span class="hljs-comment">/* Custom Backgrounds */</span>
		bg = $.map( [<span class="hljs-string">'color'</span>, <span class="hljs-string">'image'</span>, <span class="hljs-string">'preset'</span>, <span class="hljs-string">'position_x'</span>, <span class="hljs-string">'position_y'</span>, <span class="hljs-string">'size'</span>, <span class="hljs-string">'repeat'</span>, <span class="hljs-string">'attachment'</span>], <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> prop </span>) </span>{
			<span class="hljs-keyword">return</span> <span class="hljs-string">'background_'</span> + prop;
		} );

		api.when.apply( api, bg ).done( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
			$.each( <span class="hljs-built_in">arguments</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
				<span class="hljs-keyword">this</span>.bind( api.settingPreviewHandlers.background );
			});
		});

		<span class="hljs-comment">/**
		 * Custom Logo
		 *
		 * Toggle the wp-custom-logo body class when a logo is added or removed.
		 *
		 * @since 4.5.0
		 */</span>
		api( <span class="hljs-string">'custom_logo'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"> setting </span>) </span>{
			api.settingPreviewHandlers.custom_logo.call( setting, setting.get() );
			setting.bind( api.settingPreviewHandlers.custom_logo );
		} );

		api( <span class="hljs-string">'custom_css['</span> + api.settings.theme.stylesheet + <span class="hljs-string">']'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> setting </span>) </span>{
			setting.bind( api.settingPreviewHandlers.custom_css );
		} );

		api.trigger( <span class="hljs-string">'preview-ready'</span> );
	});

})( wp, jQuery );</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
